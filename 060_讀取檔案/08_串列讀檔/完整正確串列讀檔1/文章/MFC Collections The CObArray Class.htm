<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0057)http://www.functionx.com/visualc/collections/cobarray.htm -->
<HTML><HEAD><TITLE>MFC Collections: The CObArray Class</TITLE>
<META http-equiv=Content-Language content=en-us>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<META content="MSHTML 6.00.2800.1491" name=GENERATOR>
<META content=FrontPage.Editor.Document name=ProgId>
<META 
content="Excel, Spreadsheet, Workbook, Worksheet, Cell, Microsoft, MOUS, Microsoft Office User Specialist, HTML, PowerPoint, FrontPage." 
name=Keywords>
<META content="This site offers tutorials and links on Microsoft Excel." 
name=Description><LINK 
href="MFC Collections The CObArray Class.files/Lessons.css" type=text/css 
rel=stylesheet></HEAD>
<BODY leftMargin=0 topMargin=0>
<TABLE width="86%" border=0>
  <TBODY>
  <TR>
    <TD align=middle width="100%"><!-- Casale Media 2004 (C) --><!-- Ad Format: Leaderboard --><!-- Domain(s): functionx.com -->
      <SCRIPT language=Javascript><!--
var d=new Date();var r=(d.getTime()%8673806982)+Math.random();var uu=escape(window.location.href);
var wh='" width="728" height="90" ';var host='.casalemedia.com/';var dc=document;
var fr='marginwidth="0" hspace="0" vspace="0" frameborder="0" scrolling="no">';
dc.write('<ifr'+'ame src="http://as'+host+'s?s=56757&u='+uu+'&f=2&id='+r+wh+fr);
dc.write('<a hr'+'ef="http://c'+host+'c?s=56757&f=2&id='+r+'" target="_blank">');
dc.write('<i'+'mg src="http://as'+host+'s?s=56757&u='+uu+'&f=2&id='+r+'&if=0'+wh+'border="0"></a></ifr'+'ame>');
//--></SCRIPT>
      <NOSCRIPT><IFRAME marginWidth=0 
      src="MFC Collections The CObArray Class.files/index.htm" frameBorder=0 
      width=728 scrolling=no 
      height=90>
      <a href="http://c.casalemedia.com/c?s=56757&amp;f=2&amp;id=0" target="_blank"><img src="http://as.casalemedia.com/s?s=56757&u=http%3A%2F%2Ffunctionx.com&f=2&id=0&if=0" width="728" height="90" border="0"></a></iframe></IFRAME></NOSCRIPT><!-- Casale Media 2004 (C) --></TD></TR></TBODY></TABLE>&nbsp; 

<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD vAlign=center align=middle width="10%"><A 
      href="http://www.functionx.com/visualc/index.htm"><IMG height=60 alt=Home 
      src="MFC Collections The CObArray Class.files/ftxlogo2.gif" width=51 
      border=0></A></TD>
    <TD width="90%">
      <P class=maintitle>MFC Collections: The CObArray Class</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#cc3300 colSpan=2 
height=2></TD></TR></TBODY></TABLE>&nbsp; 
<TABLE width=840 border=0>
  <TBODY>
  <TR>
    <TD width=660>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD width="100%">
            <P class=paratitle>An Array ob Objects</P></TD></TR>
        <TR>
          <TD width="100%" bgColor=#ff0000 height=1></TD></TR></TBODY></TABLE>&nbsp; 

      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD width="100%">
            <P class=subtitle>Introduction</P></TD></TR>
        <TR>
          <TD width="100%" bgColor=#0000ff height=1></TD></TR></TBODY></TABLE>
      <P class=parajust>The MFC is a library rich of collection classes that 
      allow you to create and manage any type of list. In this tradition, it is 
      equipped with the <B>CObArray</B> class. the particularity of this class 
      is that it can be used to create a list of <B>CObject</B> values. This 
      doesn't mean that the objects have to fit in any particular MFC scenario. 
      Of course, there are a few rules you must follow but the main theory is 
      that the class that would constitute the object must be derived from 
      <B>CObject</B>. Normally, this is an advantage because such a class would 
      be ready for serialization and MFC's exception handling. </P>
      <P class=parajust>The <B>CObArray</B> class is part of MFC's collection 
      classes and defined in the <B>afxcoll.h</B> library. Therefore, if you 
      plan to use it to create and manage your list, make sure you include this 
      header file where necessary. </P>
      <TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
        <TBODY>
        <TR>
          <TD width="100%">
            <P class=exotitle><IMG height=20 alt="Practical Learning" 
            src="MFC Collections The CObArray Class.files/practical1.gif" 
            width=22 border=0> Practical Learning: Introducing the List of 
            Objects</P></TD></TR>
        <TR>
          <TD width="100%" bgColor=#ff00ff height=1></TD></TR></TBODY></TABLE>
      <OL>
        <LI>If you want to follow this exercise, start Microsoft Visual C++ .NET 
        or Visual Studio .NET 
        <LI>Create a MFC Application 
        <LI>Set the Name to <B>CarRental1</B> 
        <LI>Create it as Dialog Based 
        <LI>Set the Title to <B>Bethesda Car Rental - Cars 
        Inventory</B><BR>&nbsp;<BR><IMG height=437 
        src="MFC Collections The CObArray Class.files/mfcappwiz1.gif" width=615 
        border=0> 
        <LI>Click Finish and design the dialog box box as follows:<BR>&nbsp; 
        <TABLE width=468 border=0>
          <TBODY>
          <TR>
            <TD align=middle width=460><IMG height=228 
              src="MFC Collections The CObArray Class.files/carrental1.gif" 
              width=336 border=0></TD></TR>
          <TR>
            <TD align=middle width=460>
              <TABLE borderColor=#c0c0c0 height=307 width="100%" border=1>
                <TBODY>
                <TR>
                  <TD width="27%" height=16>Control</TD>
                  <TD width="26%" height=16>ID</TD>
                  <TD width="23%" height=16>Caption</TD>
                  <TD width="27%" height=16>Other Properties</TD></TR>
                <TR>
                  <TD width="27%" height=16>Static Text</TD>
                  <TD width="26%" height=16>&nbsp;</TD>
                  <TD width="23%" height=16>Tag Number:</TD>
                  <TD width="27%" height=16>&nbsp;</TD></TR>
                <TR>
                  <TD width="27%" height=16>Edit Control</TD>
                  <TD width="26%" height=16>IDC_TAG_NUMBER</TD>
                  <TD width="23%" height=16>&nbsp;</TD>
                  <TD width="27%" height=16>&nbsp;</TD></TR>
                <TR>
                  <TD width="27%" height=16>Button</TD>
                  <TD width="26%" height=16>IDC_NEW_CAR</TD>
                  <TD width="23%" height=16>New Car</TD>
                  <TD width="27%" height=16></TD></TR>
                <TR>
                  <TD width="27%" height=16>Static Text</TD>
                  <TD width="26%" height=16>&nbsp;</TD>
                  <TD width="23%" height=16>Make:</TD>
                  <TD width="27%" height=16>&nbsp;</TD></TR>
                <TR>
                  <TD width="27%" height=16>Edit Control</TD>
                  <TD width="26%" height=16>IDC_MAKE</TD>
                  <TD width="23%" height=16>&nbsp;</TD>
                  <TD width="27%" height=16>&nbsp;</TD></TR>
                <TR>
                  <TD width="27%" height=16>Button</TD>
                  <TD width="26%" height=16>IDC_DELETE_CAR</TD>
                  <TD width="23%" height=16>Delete Car</TD>
                  <TD width="27%" height=16></TD></TR>
                <TR>
                  <TD width="27%" height=16>Static Text</TD>
                  <TD width="26%" height=16>&nbsp;</TD>
                  <TD width="23%" height=16>Model</TD>
                  <TD width="27%" height=16>&nbsp;</TD></TR>
                <TR>
                  <TD width="27%" height=16>Edit Control</TD>
                  <TD width="26%" height=16>IDC_MODEL</TD>
                  <TD width="23%" height=16>&nbsp;</TD>
                  <TD width="27%" height=16>&nbsp;</TD></TR>
                <TR>
                  <TD width="27%" height=16>Static Control</TD>
                  <TD width="26%" height=16>&nbsp;</TD>
                  <TD width="23%" height=16>Year</TD>
                  <TD width="27%" height=16>&nbsp;</TD></TR>
                <TR>
                  <TD width="27%" height=16>Edit Control</TD>
                  <TD width="26%" height=16>IDC_YEAR</TD>
                  <TD width="23%" height=16>&nbsp;</TD>
                  <TD width="27%" height=16>Align Text: Right</TD></TR>
                <TR>
                  <TD width="27%" height=16>Button</TD>
                  <TD width="26%" height=16>IDCANCEL</TD>
                  <TD width="23%" height=16>Close</TD>
                  <TD width="27%" height=16></TD></TR>
                <TR>
                  <TD width="27%" height=16>Button</TD>
                  <TD width="26%" height=16>IDC_FIRST</TD>
                  <TD width="23%" height=16>First</TD>
                  <TD width="27%" height=16>&nbsp;</TD></TR>
                <TR>
                  <TD width="27%" height=15>Button</TD>
                  <TD width="26%" height=15>IDC_PREVIOUS</TD>
                  <TD width="23%" height=15>Previous</TD>
                  <TD width="27%" height=15>&nbsp;</TD></TR>
                <TR>
                  <TD width="27%" height=16>Button</TD>
                  <TD width="26%" height=16>IDC_NEXT</TD>
                  <TD width="23%" height=16>Next</TD>
                  <TD width="27%" height=16></TD></TR>
                <TR>
                  <TD width="27%" height=16>Button</TD>
                  <TD width="26%" height=16>IDC_LAST</TD>
                  <TD width="23%" height=16>Last</TD>
                  <TD width="27%" 
          height=16>&nbsp;</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
        <LI>If using MSVC 6, press Ctrl + W to display the ClassWizard. Display 
        the Member Variables property page<BR>If using MSVC .NET, right-click 
        each edit control and click Add Variable 
        <LI>Create the Value variables as follows:<BR>&nbsp; 
        <TABLE borderColor=#c0c0c0 width=415 border=1>
          <TBODY>
          <TR>
            <TD align=middle width=136 rowSpan=2>ID</TD>
            <TD align=middle colSpan=2>Value Variable</TD>
            <TD align=middle rowSpan=2>Control Variable</TD></TR>
          <TR>
            <TD align=middle>Type</TD>
            <TD align=middle>Name</TD></TR>
          <TR>
            <TD width=136>IDC_TAG_NUMBER</TD>
            <TD width=57>CString</TD>
            <TD width=58>m_TagNumber</TD>
            <TD width=142>m_edtTagNumber</TD></TR>
          <TR>
            <TD width=136>IDC_NEW_CAR</TD>
            <TD width=57>&nbsp;</TD>
            <TD width=58>&nbsp;</TD>
            <TD width=142>m_BtnNewCar</TD></TR>
          <TR>
            <TD width=136>IDC_MAKE</TD>
            <TD width=57>CString</TD>
            <TD width=58>m_Make</TD>
            <TD width=142>&nbsp;</TD></TR>
          <TR>
            <TD width=136>IDC_MODEL</TD>
            <TD width=57>CString</TD>
            <TD width=58>m_Model</TD>
            <TD width=142>&nbsp;</TD></TR>
          <TR>
            <TD width=136>IDC_YEAR</TD>
            <TD width=57>int</TD>
            <TD width=58>m_Year</TD>
            <TD width=142>&nbsp;</TD></TR></TBODY></TABLE>
        <LI>Save all </LI></OL></TD>
    <TD vAlign=top>
      <SCRIPT type=text/javascript><!--
google_ad_client = "pub-3968514660870014";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_channel ="";
google_ad_type = "text_image";
//--></SCRIPT>

      <SCRIPT src="MFC Collections The CObArray Class.files/show_ads.js" 
      type=text/javascript>
</SCRIPT>
    </TD></TR></TBODY></TABLE>&nbsp; 
<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=subtitle>Setting Up an Array of Objects</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#0000ff height=1></TD></TR></TBODY></TABLE>
<TABLE width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=parajust>To create an object that you want to handle using a 
      <B>CObArray</B> list, the first rule you must follow is that your class 
      must be based on <B>CObject</B>. If you only plan to create an object and 
      use it temporarily, this is all you need to do. If you want to be able to 
      save the list, there are a few more steps you must follow. For example, 
      you must include the <B>DECLARE_SERIAL</B> macro in the header file of 
      your class and you must include the <B>IMPLEMENT_SERIAL</B> macro in the 
      source file of your class. Also, if you plan to save your class, you must 
      override the derived <B>Serialize()</B> method. This is necessary because 
      you must specify what member variables would need to be persisted. 
  </P></TD></TR></TBODY></TABLE>&nbsp; 
<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=exotitle><IMG height=20 alt="Practical Learning" 
      src="MFC Collections The CObArray Class.files/practical1.gif" width=22 
      border=0> Practical Learning: Setting Up a List</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#ff00ff height=1></TD></TR></TBODY></TABLE>
<OL>
  <LI>On the main menu, click Project -&gt; Add Class 
  <LI>In the Template section, select MFC Class and click Open<BR>&nbsp;<BR><IMG 
  height=425 src="MFC Collections The CObArray Class.files/addclass2.gif" 
  width=531 border=0> 
  <LI>Set the Class Name to <B>CCar</B> and, in the Base Class, select 
  <B>CObject</B><BR>&nbsp;<BR><IMG height=437 
  src="MFC Collections The CObArray Class.files/mfcclasswiz2.gif" width=615 
  border=0> 
  <LI>Click Finish and change the files as follows:<BR>&nbsp; 
  <TABLE width=589 border=0>
    <TBODY>
    <TR>
      <TD width=581>
        <P><B>Header File: Car.h</B></P></TD></TR>
    <TR>
      <TD width=581><PRE>#pragma once

// CCar command target

class CCar : public CObject
{
	DECLARE_SERIAL(CCar)

public:
	CCar();
	CCar(CString tagnbr, CString mk, CString mdl, int yr);
	virtual ~CCar();
private:
	CString TagNumber;
	CString Make;
	CString Model;
	int Year;
public:
	CString getTagNumber(void);
	void setTagNumber(CString tag);
	CString getMake(void);
	void setMake(CString mk);
	CString getModel(void);
	void setModel(CString mdl);
	int getYear(void);
	void setYear(int yr);
	virtual void Serialize(CArchive&amp; ar);
};</PRE></TD></TR>
    <TR>
      <TD width=581><B>Source File: Car.cpp</B></TD></TR>
    <TR>
      <TD width=581><PRE>// Car.cpp : implementation file
//

#include "stdafx.h"
#include "BCRSerial1.h"
#include "Car.h"
#include ".\car.h"

IMPLEMENT_SERIAL(CCar, CObject, 1)

// CCar

CCar::CCar()
	: TagNumber(_T("")), Make(_T("")), Model(_T("")), Year(0)
{
}

CCar::CCar(CString tagnbr, CString mk, CString mdl, int yr)
{
	TagNumber = tagnbr;
	Make      = mk;
	Model     = mdl;
	Year      = yr;
}

CCar::~CCar()
{
}


// CCar member functions


CString CCar::getTagNumber(void)
{
	return TagNumber;
}

void CCar::setTagNumber(CString tag)
{
	TagNumber = tag;
}

CString CCar::getMake(void)
{
	return Make;
}

void CCar::setMake(CString mk)
{
	Make = mk;
}

CString CCar::getModel(void)
{
	return Model;
}

void CCar::setModel(CString mdl)
{
	Model = mdl;
}

int CCar::getYear(void)
{
	return Year;
}

void CCar::setYear(int yr)
{
	Year = yr;
}

void CCar::Serialize(CArchive&amp; ar)
{
	CObject::Serialize(ar);
	
	if (ar.IsStoring())
	{
		ar &lt;&lt; TagNumber &lt;&lt; Make &lt;&lt; Model &lt;&lt; Year;
	}
	else
	{
		ar &gt;&gt; TagNumber &gt;&gt; Make &gt;&gt; Model &gt;&gt; Year;
	}
}</PRE></TD></TR></TBODY></TABLE>
  <LI>Save all </LI></OL>
<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=subtitle>List Setup</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#0000ff height=1></TD></TR></TBODY></TABLE>
<TABLE width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=parajust>When you are ready to start the list, like any other 
      class, you must first declare a variable of type <B>CObArray</B>. To 
      support this, the <B>CObArray</B> class is equipped with a simple default 
      constructor. If you are planning to create and manage the list from one 
      method or event, you can declare the variable locally. On the other hand, 
      if you are planning to access the list from various sections of your code, 
      you should declare the variable globally, for example, in the header 
      file.</P></TD></TR></TBODY></TABLE>&nbsp; 
<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=exotitle><IMG height=20 alt="Practical Learning" 
      src="MFC Collections The CObArray Class.files/practical1.gif" width=22 
      border=0> Practical Learning: Setting Up a List</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#ff00ff height=1></TD></TR></TBODY></TABLE>
<OL>
  <LI>Access the CarRental1Dlg.h header file. Include the <B>afxtempl.h</B> file 
  and declare a <B>CObArray</B> variable named <B>ListOfCars</B>:<BR>&nbsp; 
  <TABLE width=560 border=0>
    <TBODY>
    <TR>
      <TD width="100%"><PRE>// CarRental1Dlg.h : header file
//

#pragma once

<FONT color=#ff0000>#include "afxcoll.h"</FONT>

// CCarRental1Dlg dialog
class CCarRental1Dlg : public CDialog
{
// Construction
public:
	CCarRental1Dlg(CWnd* pParent = NULL);	// standard constructor

// Dialog Data
	enum { IDD = IDD_CARRENTAL1_DIALOG };

	protected:
	virtual void DoDataExchange(CDataExchange* pDX);	// DDX/DDV support


// Implementation
protected:
	HICON m_hIcon;
	<FONT color=#ff0000>CObArray ListOfCars;</FONT>

	// Generated message map functions
	virtual BOOL OnInitDialog();
	afx_msg void OnPaint();
	afx_msg HCURSOR OnQueryDragIcon();
	DECLARE_MESSAGE_MAP()
public:
	CString m_TagNumber;
	CString m_Make;
	CString m_Model;
	int m_Year;
};</PRE></TD></TR></TBODY></TABLE>
  <LI>Save all<BR></LI></OL>
<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=paratitle>List Serialization</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#ff0000 height=1></TD></TR></TBODY></TABLE>&nbsp; 
<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=subtitle>Introduction</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#0000ff height=1></TD></TR></TBODY></TABLE>
<TABLE width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=parajust>One of the advantages of using the <B>CObArray</B> class 
      to create and manage a list is that it has a built-in mechanism for 
      serialization. This allows you to easily save a list to a medium and be 
      able to open it when necessary. As mentioned earlier, to prepare a class 
      for serialization, you must make sure you override its <B>Serialize()</B> 
      method. When such a class is used as a <B>CObArray</B> item, it can 
      directly benefit from <B>CObArray</B>'s own serialization.</P>
      <P class=parajust>To serialize a <B>CObArray</B> list in your project, all 
      of you have to do is to call the <B>CObArray::Serialize()</B> method. 
      Everything else would be handle behind the scenes for 
  you.</P></TD></TR></TBODY></TABLE>&nbsp; 
<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=exotitle><IMG height=20 alt="Practical Learning" 
      src="MFC Collections The CObArray Class.files/practical1.gif" width=22 
      border=0> Practical Learning: Serializing a List</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#ff00ff height=1></TD></TR></TBODY></TABLE>
<OL>
  <LI>Generate the Serialize() method of the CCarRental1Dlg class (in Class 
  View, click CCarRental1Dlg, then, in the Properties window, click the 
  Overrides button, click Serialize and, in its combo box, select &lt;Add&gt; 
  Serialize) 
  <LI>Implement the method as follows:<BR>&nbsp; 
  <TABLE width=560 border=0>
    <TBODY>
    <TR>
      <TD width="100%"><PRE>void CCarRental1Dlg::Serialize(CArchive&amp; ar)
{
	<FONT color=#ff0000>ListOfCars.Serialize(ar);</FONT>
}</PRE></TD></TR></TBODY></TABLE>
  <LI>Save all </LI></OL>&nbsp; 
<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=subtitle>Saving the List</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#0000ff height=1></TD></TR></TBODY></TABLE>
<TABLE width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=parajust>The actions we have taken so far with regards to 
      serialization allow our class to know how to save the list and what to 
      save. The next action is to tell the project when to save the list. This 
      is traditionally done by using the common Windows <A 
      href="http://www.functionx.com/visualc/controls/filedialog.htm">Save 
      dialog box</A>. To make our exercise simple, we will let the user create 
      and manage the list while the application is opened. After using the 
      application, when the user decides to close it, then we will automatically 
      save the list.</P></TD></TR></TBODY></TABLE>&nbsp; 
<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=exotitle><IMG height=20 alt="Practical Learning" 
      src="MFC Collections The CObArray Class.files/practical1.gif" width=22 
      border=0> Practical Learning: Saving a List</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#ff00ff height=1></TD></TR></TBODY></TABLE>
<OL>
  <LI>Display the dialog box and double-click the Close button 
  <LI>Implement its event as follows:<BR>&nbsp; 
  <TABLE width=560 border=0>
    <TBODY>
    <TR>
      <TD width="100%"><PRE>void CCarRental1Dlg::OnBnClickedCancel()
{
	// TODO: Add your control notification handler code here
	char strFilename[] = "Cars.bcr";
	CFile fleCars;

	fleCars.Open(strFilename, CFile::modeCreate | CFile::modeWrite);
	CArchive arc(&amp;fleCars, CArchive::store);
	Serialize(arc);

	arc.Close();
	fleCars.Close();
	OnCancel();
}</PRE></TD></TR></TBODY></TABLE>
  <LI>Save all </LI></OL>
<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=subtitle>Opening the List</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#0000ff height=1></TD></TR></TBODY></TABLE>
<TABLE width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=parajust>Opening a list consists of retrieving it from an archive 
      and making it available to an application. As done when saving, it is up 
      to you to decide when this action must occur. For our example, when the 
      user opens the application, we will automatically open the file that holds 
      the list, retrieve the list and get ready to use it. We will take care of 
      this in the <B>OnCreate()</B> event of the dialog box of our 
      application.</P></TD></TR></TBODY></TABLE>&nbsp; 
<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=exotitle><IMG height=20 alt="Practical Learning" 
      src="MFC Collections The CObArray Class.files/practical1.gif" width=22 
      border=0> Practical Learning: Opening a List</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#ff00ff height=1></TD></TR></TBODY></TABLE>
<OL>
  <LI>Generate the <B>WM_CREATE</B> message of the CCarRental1Dlg class (in the 
  Class View, click CCarRental1Dlg, then, in the Properties window, click the 
  Messages button; click <B>WM_CREATE</B>, click the arrow of its combo box and 
  select &lt;Add&gt; <B>OnCreate</B> 
  <LI>Implement the event as follows:<BR>&nbsp; 
  <TABLE width=560 border=0>
    <TBODY>
    <TR>
      <TD width="100%"><PRE>int CCarRental1Dlg::OnCreate(LPCREATESTRUCT lpCreateStruct)
{
	if (CDialog::OnCreate(lpCreateStruct) == -1)
		return -1;

	// TODO:  Add your specialized creation code here
	char strFilename[] = "Cars.bcr";
	CFile fleCars;
	CFileFind fndFile;

	// Look for the Cars.bcr file
	BOOL exists = fndFile.FindFile(strFilename);

	if( exists == TRUE )
	{
		// If the file exists, open it and fill the controls with it
		fleCars.Open(strFilename, CFile::modeRead);
		CArchive arc(&amp;fleCars, CArchive::load);
		Serialize(arc);

		arc.Close();
		fleCars.Close();
	}

	return 0;
}</PRE></TD></TR></TBODY></TABLE>
  <LI>Save all </LI></OL>
<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=paratitle>Introduction to List Management</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#ff0000 height=1></TD></TR></TBODY></TABLE>&nbsp; 
<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=subtitle>List Emptiness</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#0000ff height=1></TD></TR></TBODY></TABLE>
<TABLE width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=parajust>When you start a list, before adding any item in it, you 
      would know that it is empty. If someone else had created it, you would not 
      have this information. In some cases, before performing ann operation on a 
      list, you will need to know whether it contains any item at all. This 
      information can be given to you by calling the <B>CObArray::IsEmpty()</B> 
      method. Its syntax is:</P><PRE>BOOL IsEmpty() const;</PRE>
      <P class=parajust>This method allows you to find out if the list already 
      contains at least one member.</P></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=exotitle><IMG height=20 alt="Practical Learning" 
      src="MFC Collections The CObArray Class.files/practical1.gif" width=22 
      border=0> Practical Learning: Checking List Emptiness</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#ff00ff height=1></TD></TR></TBODY></TABLE>
<OL>
  <LI>Display the dialog box. Double-click the First button and implement its 
  event as follows:<BR>&nbsp; 
  <TABLE width=560 border=0>
    <TBODY>
    <TR>
      <TD width="100%"><PRE>void CCarRental1Dlg::OnBnClickedFirst()
{
	// TODO: Add your control notification handler code here
	<FONT color=#ff0000>if( this-&gt;ListOfCars.IsEmpty() == TRUE )
		return;</FONT>
}</PRE></TD></TR></TBODY></TABLE>
  <LI>Return to the dialog box. Double-click the Previous button and implement 
  its event as follows:<BR>&nbsp; 
  <TABLE width=560 border=0>
    <TBODY>
    <TR>
      <TD width="100%"><PRE>void CCarRental1Dlg::OnBnClickedPrevious()
{
	// TODO: Add your control notification handler code here
	<FONT color=#ff0000>if( this-&gt;ListOfCars.IsEmpty() == TRUE )
		return;</FONT>
}</PRE></TD></TR></TBODY></TABLE>
  <LI>Return to the dialog box. Double-click the Next button and implement its 
  event as follows:<BR>&nbsp; 
  <TABLE width=560 border=0>
    <TBODY>
    <TR>
      <TD width="100%"><PRE>void CCarRental1Dlg::OnBnClickedNext()
{
	// TODO: Add your control notification handler code here
	<FONT color=#ff0000>if( this-&gt;ListOfCars.IsEmpty() == TRUE )
		return;</FONT>
}</PRE></TD></TR></TBODY></TABLE>
  <LI>Return to the dialog box. Double-click the Last button and implement the 
  events as follows:<BR>&nbsp; 
  <TABLE width=700 border=0>
    <TBODY>
    <TR>
      <TD width=954><PRE>void CCarRental1Dlg::OnBnClickedLast()
{
	// TODO: Add your control notification handler code here
	<FONT color=#ff0000>if( this-&gt;ListOfCars.IsEmpty() == TRUE )
		return;</FONT>
}</PRE></TD></TR></TBODY></TABLE>
  <LI>Save all </LI></OL>&nbsp; 
<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=subtitle>The Index of an Item in the List</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#0000ff height=1></TD></TR></TBODY></TABLE>
<TABLE width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=parajust>As we will see in the next sections of this exercise, 
      there are various operations you can perform on a list, such as adding or 
      inserting a new item. When an item is part of the list, that item occupies 
      a specific position so you can locate it easily. The members of the 
      <B>CObArray</B> list are stored at positions represented by the 
      <B>INT_PTR</B> data type.</P></TD></TR></TBODY></TABLE>&nbsp; 
<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=paratitle>List Creation</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#ff0000 height=1></TD></TR></TBODY></TABLE>&nbsp; 
<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=subtitle>Item Addition to the List</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#0000ff height=1></TD></TR></TBODY></TABLE>
<TABLE width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=parajust>Probably the first action to take with regards to a list 
      consists of populating it, since an empty list may not be very useful. 
      After creating an item, to add it to a <B>CObArray</B> list, you can call 
      the <B>Add()</B> method. Its syntax is:</P><PRE>INT_PTR Add(CObject* newElement);
</PRE>
      <P class=parajust>When calling this method, pass the item as argument. If 
      this methods succeeds, which it usually does, it adds the new item to the 
      list. If the list was empty, it would be started with this item. If the 
      list already contained at least one item, the new item would be added to 
      the end of the list.</P></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=exotitle><IMG height=20 alt="Practical Learning" 
      src="MFC Collections The CObArray Class.files/practical1.gif" width=22 
      border=0> Practical Learning: Starting a List-Based Application</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#ff00ff height=1></TD></TR></TBODY></TABLE>
<OL>
  <LI>Display the dialog box and double-click the New Car button 
  <LI>Implement its event as follows:<BR>&nbsp; 
  <TABLE cellSpacing=1 cellPadding=0 width=621 border=0>
    <TBODY>
    <TR>
      <TD width=615><PRE>void CCarRental1Dlg::OnBnClickedNewCar()
{
	// TODO: Add your control notification handler code here
	UpdateData();
	CString strCaption;
	this-&gt;m_BtnNewCar.GetWindowText(strCaption);

	if( strCaption == "New Car" )
	{
		this-&gt;m_TagNumber = "";
		this-&gt;m_Make  = "";
		this-&gt;m_Model = "";
		this-&gt;m_Year  = 2000;
		this-&gt;m_BtnNewCar.SetWindowText("Add");
		this-&gt;m_edtTagNumber.SetFocus();
	}
	else
	{
		CCar *car = new CCar(this-&gt;m_TagNumber, m_Make, m_Model, m_Year);
		this-&gt;ListOfCars.Add(car);

		this-&gt;m_BtnNewCar.SetWindowText("New Car");
		this-&gt;OnBnClickedLastBtn();
	}
	
	UpdateData(FALSE);
}</PRE></TD></TR></TBODY></TABLE>
  <LI>Execute the application and create the following list of cars:<BR>&nbsp; 
  <TABLE borderColor=#c0c0c0 width=336 border=1>
    <TBODY>
    <TR>
      <TD align=middle width=86>Tax Number</TD>
      <TD width=65>Make</TD>
      <TD width=106>Model</TD>
      <TD align=middle width=51>Year</TD></TR>
    <TR>
      <TD align=middle width=86>525708</TD>
      <TD width=65>Dodge</TD>
      <TD width=106>Neon SE</TD>
      <TD align=middle width=51>2004</TD></TR>
    <TR>
      <TD align=middle width=86>DKO-739</TD>
      <TD width=65>Ford</TD>
      <TD width=106>Focus SVT</TD>
      <TD align=middle width=51>2002</TD></TR>
    <TR>
      <TD align=middle width=86>M682468</TD>
      <TD width=65>Ford</TD>
      <TD width=106>Expedition</TD>
      <TD align=middle width=51>2004</TD></TR>
    <TR>
      <TD align=middle width=86>DJK822</TD>
      <TD width=65>Daewoo</TD>
      <TD width=106>Lanos</TD>
      <TD align=middle width=51>2000</TD></TR>
    <TR>
      <TD align=middle width=86>415-048</TD>
      <TD width=65>Chevrolet</TD>
      <TD width=106>Monte Carlo LS</TD>
      <TD align=middle width=51>2005</TD></TR></TBODY></TABLE>
  <LI>Close the dialog box and return to MSVC </LI></OL>&nbsp; 
<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=subtitle>Item Inserting Within the List</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#0000ff height=1></TD></TR></TBODY></TABLE>
<TABLE width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=parajust>If a list already contains at least one item, when you 
      call the <B>CObArray::Add()</B> method, the new item would added to the 
      end of the list. In some cases, you can want to insert the new item 
      somewhere within the list. To support this operation, the <B>CObArray</B> 
      class provides the <B>InsertAt()</B> method which is overloaded with two 
      versions. Their syntaxes are:</P><PRE>void InsertAt(INT_PTR <I>nIndex</I>, CObject* <I>newElement</I>, INT_PTR <I>nCount</I> = 1);
void InsertAt(INT_PTR <I>nStartIndex</I>, CObArray* <I>pNewArray</I>);</PRE>
      <P class=parajust>The first version allows you to add a new item, 
      <I>newElement</I>, at position <I>nIndex</I>. If you want o insert more 
      than one sample of the same item, specify the number as the <I>nCount</I> 
      argument.</P>
      <P class=parajust>The second argument allows you to insert another 
      <B>CObArray</B> list to this one, at position 
  <I>nStartIndex</I>.</P></TD></TR></TBODY></TABLE>&nbsp; 
<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=paratitle>Item Location</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#ff0000 height=1></TD></TR></TBODY></TABLE>&nbsp; 
<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=subtitle>Introduction</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#0000ff height=1></TD></TR></TBODY></TABLE>
<TABLE width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=parajust>After creating the list, you can start managing the 
      items. Before taking an action on a member of the list, you may first need 
      to locate it or event to find out if it exists. We previously mentioned 
      that the index of each member is represented by an <B>INT_PTR</B> value. 
      To allow you to scan the list and locate each item by its index using the 
      same concept of the C++' arrays, the [] operator was overloaded in two 
      versions that use the following syntaxes:<PRE>CObject*&amp; operator [](INT_PTR nIndex);
CObject* operator [](INT_PTR nIndex) const;</PRE>
      <P class=parajust>This operator allows you to locate an item by specifying 
      its index between the square brackets of the <B>CObArray</B> variable. 
      <P class=parajust>When a list is not empty, the index of the last item can 
      be gotten by calling the <B>CObArray::GetUpperBound()</B> method. Its 
      syntax is: <PRE>INT_PTR GetUpperBound() const;</PRE>
      <P class=parajust>This method returns the index of the last member of the 
      array.</P></TD></TR></TBODY></TABLE>&nbsp; 
<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=exotitle><IMG height=20 alt="Practical Learning" 
      src="MFC Collections The CObArray Class.files/practical1.gif" width=22 
      border=0> Practical Learning: Locating an Item by its Index</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#ff00ff height=1></TD></TR></TBODY></TABLE>
<OL>
  <LI>Access the OnCreate event of the CCarRental1Dlg class and change it as 
  follows:<BR>&nbsp; 
  <TABLE width=560 border=0>
    <TBODY>
    <TR>
      <TD width="100%"><PRE>int CCarRental1Dlg::OnCreate(LPCREATESTRUCT lpCreateStruct)
{
	if (CDialog::OnCreate(lpCreateStruct) == -1)
		return -1;

	// TODO:  Add your specialized creation code here
	char strFilename[] = "Cars.bcr";
	CFile fleCars;
	CFileFind fndFile;

	// Look for the Cars.bcr file
	BOOL exists = fndFile.FindFile(strFilename);

	if( exists == TRUE )
	{
		// If the file exists, open it and fill the controls with it
		fleCars.Open(strFilename, CFile::modeRead);
		CArchive arc(&amp;fleCars, CArchive::load);
		Serialize(arc);

		arc.Close();
		fleCars.Close();

		<FONT color=#ff0000>CCar *car = reinterpret_cast&lt;CCar *&gt;(this-&gt;ListOfCars[0]);

		this-&gt;m_TagNumber = car-&gt;getTagNumber();
		this-&gt;m_Make = car-&gt;getMake();
		this-&gt;m_Model = car-&gt;getModel();
		this-&gt;m_Year  = car-&gt;getYear();</FONT>
	}

	return 0;
}</PRE></TD></TR></TBODY></TABLE>
  <LI>Save all 
  <LI>Display the CCarRental1Dlg.h header file and declare an <B>INT_PTR</B> 
  variable named <B>CurrentPosition</B><BR>&nbsp; 
  <TABLE width=560 border=0>
    <TBODY>
    <TR>
      <TD width="100%"><PRE>// Implementation
protected:
	HICON m_hIcon;
	CObArray ListOfCars;
	<FONT color=#ff0000>INT_PTR CurrentPosition;</FONT></PRE></TD></TR></TBODY></TABLE>
  <LI>Initialize the variable in the OnInitDialog event at 0<BR>&nbsp; 
  <TABLE width=560 border=0>
    <TBODY>
    <TR>
      <TD width="100%"><PRE>BOOL CCarRental1Dlg::OnInitDialog()
{
	CDialog::OnInitDialog();

	// Set the icon for this dialog.  The framework does this automatically
	//  when the application's main window is not a dialog
	SetIcon(m_hIcon, TRUE);			// Set big icon
	SetIcon(m_hIcon, FALSE);		// Set small icon

	// TODO: Add extra initialization here
	<FONT color=#ff0000>this-&gt;CurrentPosition = 0;</FONT>

	return TRUE;  // return TRUE  unless you set the focus to a control
}</PRE></TD></TR></TBODY></TABLE>
  <LI>Save all </LI></OL>
<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=subtitle>Accessing the Members of an Array</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#0000ff height=1></TD></TR></TBODY></TABLE>
<TABLE width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=parajust>To store all the members of the list in one pointer, you 
      can call the <B>CObArray::GetData()</B> method that is overloaded with two 
      versions whose syntaxes are:</P><PRE>const CObject** GetData( ) const; 
CObject** GetData( );</PRE>
      <P class=parajust>This method can help you access all members of the list 
      as one.</P></TD></TR></TBODY></TABLE>&nbsp; 
<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=paratitle>The Size and Capacity of a List</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#ff0000 height=1></TD></TR></TBODY></TABLE>&nbsp; 
<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=subtitle>The Number of Items in the List</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#0000ff height=1></TD></TR></TBODY></TABLE>
<TABLE width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=parajust>To know the number of items in the list, you can call 
      the <B>CObArray::GetCount()</B> method:</P><PRE>INT_PTR GetCount() const;</PRE>
      <P class=parajust>Since the list is zero-based, the actual number of items 
      is the total - 1. Besides <B>GetCount()</B>, you can call the 
      <B>CArray::GetSize()</B> method to know the size of the list. The syntax 
      of the <B>GetSize()</B> method is:</P><PRE>INT_PTR GetSize() const;</PRE>
      <P class=parajust>This method returns the size of the list. Like 
      <B>GetCount()</B>, the <B>GetSize()</B> method returns the total number of 
      items - 1.&nbsp;</P></TD></TR></TBODY></TABLE>&nbsp; 
<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=exotitle><IMG height=20 alt="Practical Learning" 
      src="MFC Collections The CObArray Class.files/practical1.gif" width=22 
      border=0> Practical Learning: Accessing the Members of an Array</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#ff00ff height=1></TD></TR></TBODY></TABLE>
<OL>
  <LI>In the Code Editor, make sure the left combo box displays CCarRental1Dlg. 
  In the Members combo box, select OnBnClickedFirstBtn and change its events as 
  follows:<BR>&nbsp; 
  <TABLE width=560 border=0>
    <TBODY>
    <TR>
      <TD width="100%"><PRE>void CCarRental1Dlg::OnBnClickedFirst()
{
	// TODO: Add your control notification handler code here
	if( this-&gt;ListOfCars.IsEmpty() == TRUE )
		return;

	CurrentPosition = 0;
	CCar *car = reinterpret_cast&lt;CCar *&gt;(this-&gt;ListOfCars[CurrentPosition]);

	this-&gt;m_TagNumber = car-&gt;getTagNumber();
	this-&gt;m_Make = car-&gt;getMake();
	this-&gt;m_Model = car-&gt;getModel();
	this-&gt;m_Year  = car-&gt;getYear();

	UpdateData(FALSE);
}</PRE></TD></TR></TBODY></TABLE>
  <LI>In the Members combo box, select OnBnClickedPreviousBtn and change its 
  events as follows:<BR>&nbsp; 
  <TABLE width=560 border=0>
    <TBODY>
    <TR>
      <TD width="100%"><PRE>void CCarRental1Dlg::OnBnClickedPrevious()
{
	// TODO: Add your control notification handler code here
	if( this-&gt;ListOfCars.IsEmpty() == TRUE )
		return;

	if( CurrentPosition != 0 )
		CurrentPosition--;
	CCar *car = reinterpret_cast&lt;CCar *&gt;(this-&gt;ListOfCars[CurrentPosition]);

	this-&gt;m_TagNumber = car-&gt;getTagNumber();
	this-&gt;m_Make = car-&gt;getMake();
	this-&gt;m_Model = car-&gt;getModel();
	this-&gt;m_Year  = car-&gt;getYear();

	UpdateData(FALSE);
}</PRE></TD></TR></TBODY></TABLE>
  <LI>In the Code Editor, make sure the left combo box displays CCarRental1Dlg. 
  In the Members combo box, select OnBnClickedNextBtn and change its events as 
  follows:<BR>&nbsp; 
  <TABLE width=560 border=0>
    <TBODY>
    <TR>
      <TD width="100%"><PRE>void CCarRental1Dlg::OnBnClickedNext()
{
	// TODO: Add your control notification handler code here
	if( this-&gt;ListOfCars.IsEmpty() == TRUE )
		return;

	if( CurrentPosition != (this-&gt;ListOfCars.GetSize() - 1) )
		CurrentPosition++;
	CCar *car = reinterpret_cast&lt;CCar *&gt;(this-&gt;ListOfCars[CurrentPosition]);

	this-&gt;m_TagNumber = car-&gt;getTagNumber();
	this-&gt;m_Make = car-&gt;getMake();
	this-&gt;m_Model = car-&gt;getModel();
	this-&gt;m_Year  = car-&gt;getYear();

	UpdateData(FALSE);
}</PRE></TD></TR></TBODY></TABLE>
  <LI>In the Code Editor, make sure the left combo box displays CCarRental1Dlg. 
  In the Members combo box, select OnBnClickedLastBtn and change its events as 
  follows:<BR>&nbsp; 
  <TABLE width=560 border=0>
    <TBODY>
    <TR>
      <TD width="100%"><PRE>void CCarRental1Dlg::OnBnClickedLast()
{
	// TODO: Add your control notification handler code here
	if( this-&gt;ListOfCars.IsEmpty() == TRUE )
		return;
	
	CurrentPosition = this-&gt;ListOfCars.GetSize() - 1;
	CCar *car = reinterpret_cast&lt;CCar *&gt;(this-&gt;ListOfCars[CurrentPosition]);

	this-&gt;m_TagNumber = car-&gt;getTagNumber();
	this-&gt;m_Make = car-&gt;getMake();
	this-&gt;m_Model = car-&gt;getModel();
	this-&gt;m_Year  = car-&gt;getYear();

	UpdateData(FALSE);
}</PRE></TD></TR></TBODY></TABLE>
  <LI>Close the form </LI></OL>
<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=subtitle>The Extra Memory Unused by Items</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#0000ff height=1></TD></TR></TBODY></TABLE>
<TABLE width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=parajust>When a new item is being added to the list, the compiler 
      increases the amount of memory allocated to the list. Some times, the 
      amount increased may be more than was necessary. If you want to intervene 
      in releasing any extra memory that is not used, you can call the 
      <B>CObArray::FreeExtra()</B> method. Its syntax is:</P><PRE>void FreeExtra();</PRE>
      <P class=parajust>This method can be used to release unused memory that 
      was allocated when the list of items was 
increased.</P></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=paratitle>Deleting Items From a List</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#ff0000 height=1></TD></TR></TBODY></TABLE>&nbsp; 
<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=subtitle>Deleting Items</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#0000ff height=1></TD></TR></TBODY></TABLE>
<TABLE width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=parajust>If your <B>CObArray</B> list contains an item you don't 
      need anymore, you can delete it. To delete an item from the list, you can 
      call the <B>CObArray</B>:</P><PRE>void RemoveAt(INT_PTR nIndex, INT_PTR nCount = 1);</PRE>
      <P class=parajust>The first to this method is the index of the item you 
      want to delete from the list. The value of this argument must be between 
      the bounds of the list. If you pass only one argument, only the item at 
      that position would be deleted. If you want to delete more than one 
      argument, pass the desired number as the second argument.</P>
      <P class=parajust>To delete all items from a <B>CObArray</B> list, call 
      its <B>RemoveAll()</B> method. Its syntax is:</P><PRE>void RemoveAll( );</PRE>
      <P class=parajust>When called, this method will clear the list of all 
      members.</P></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=exotitle><IMG height=20 alt="Practical Learning" 
      src="MFC Collections The CObArray Class.files/practical1.gif" width=22 
      border=0> Practical Learning: Deleting a Member of an Array</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#ff00ff height=1></TD></TR></TBODY></TABLE>
<OL>
  <LI>Display the dialog box and double-click the Delete Car button 
  <LI>Implement its event as follows:<BR>&nbsp; 
  <TABLE cellSpacing=1 width=487 border=0>
    <TBODY>
    <TR>
      <TD width=479><PRE>void CDepartmentStore1Dlg::OnBnClickedDeleteBtn()
{
	// TODO: Add your control notification handler code here
	if( CurrentPosition &gt;= 0 )
	{
		this-&gt;StoreItems.RemoveAt(CurrentPosition);
		this-&gt;OnBnClickedLastBtn();
	}
}</PRE></TD></TR></TBODY></TABLE>
  <LI>Save all </LI></OL>&nbsp; 
<TABLE cellSpacing=0 cellPadding=0 width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=subtitle>Item Replacement</P></TD></TR>
  <TR>
    <TD width="100%" bgColor=#0000ff height=1></TD></TR></TBODY></TABLE>
<TABLE width=660 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <P class=parajust>Instead of simply deleting an item, you may want to 
      replace it with another. This operation is supported by the 
      <B>CObArray::SetAt()</B> method. Its syntax is:</P><PRE>void SetAt(INT_PTR nIndex, CObject* newElement);</PRE>
      <P class=parajust>The first argument of this method is the index that the 
      new item will occupy in the list.</P></TD></TR></TBODY></TABLE>&nbsp; 
<TABLE width=660 border=0>
  <TBODY>
  <TR>
    <TD colSpan=3>
      <HR color=#ff0000>
    </TD></TR>
  <TR>
    <TD align=middle><A 
      href="http://www.functionx.com/visualc/index.htm">Home</A></TD>
    <TD align=middle><A 
      href="http://www.functionx.com/visualc/index.htm">Copyright © 2005 
      FunctionX, Inc.</A></TD>
    <TD align=middle></TD></TR>
  <TR>
    <TD colSpan=3>
      <HR color=#ff0000>
    </TD></TR></TBODY></TABLE></BODY></HTML>
