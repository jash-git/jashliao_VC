<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0045)http://www.yesky.com/20020627/1618051_2.shtml -->
<HTML xmlns="http://www.w3.org/TR/xhtml1/strict"><HEAD><TITLE>VB中利用OpenGL绘制三维地质构造图</TITLE>
<META http-equiv=Content-Type content="text/html; charset=GB2312"></META><LINK 
href="VB中利用OpenGL绘制三维地质构造图3.files/cpcw.css" rel=stylesheet></LINK>
<STYLE>.nava {
	FONT-SIZE: 9pt
}
</STYLE>

<META content="MSHTML 6.00.2900.2722" name=GENERATOR></META>
<SCRIPT language=JavaScript>function sendemail(){	
OpenWindow = window.open('http://other.chinabyte.com/chinabyte/qin/sendemail.shtm?url=http%3A%2F%2Fwww.yesky.com/20020627/1618051.shtml&title=VB中利用OpenGL绘制三维地质构造图&channel=9','emailwin','toolbar=no,location=no,scrollbars=no,menubar=no,width=462,height=450')
}</SCRIPT>
</HEAD>
<BODY text=#000000 bgColor=#ffffff leftMargin=0 topMargin=2 marginheight="0" 
marginwidth="0">
<DIV align=center>
<TABLE height=90 cellSpacing=0 cellPadding=0 width=760 border=0>
  <TBODY>
  <TR>
    <TD width=149>&nbsp;</TD>
    <TD colSpan=2><A href="http://www.yesky.com/">首页</A> ・<A 
      href="http://www.yesky.com/ServerIndex/77124143618719744/index.shtml"><FONT 
      class=zzz>硬件</FONT> </A>・ <A 
      href="http://www.chinabyte.com/Enterprise/218706056904179712/index.shtml">E企业 
      </A>・<A href="http://price.yesky.com/"> 商情 </A>・<A 
      href="http://www.yesky.com/Fashion/73746443898191872/index.shtml"> 数字电子 
      </A>・<A 
      href="http://www.yesky.com/SoftChannel/72339069014638592/index.shtml"> 软件 
      </A>・ <A 
      href="http://www.yesky.com/Gameall/73183493944770560/index.shtml">游戏 
      </A>・<A href="http://download.yesky.com/"> 下载 </A>・ <A 
      href="http://www.yesky.com/Etimes/74872343805034496/index.shtml">E时代</A>・ 
      <A href="http://bbs.yesky.com/">论坛</A></TD></TR>
  <TR>
    <TD vAlign=top align=middle width=149 height=70><IMG height=60 
      src="VB中利用OpenGL绘制三维地质构造图3.files/bz2.gif" width=110></TD>
    <TD vAlign=top width=474><IFRAME 
      src="VB中利用OpenGL绘制三维地质构造图3.files/y-soft-column-s.htm" frameBorder=0 
      width=500 scrolling=no height=90></IFRAME></TD>
    <TD vAlign=top width=137><IFRAME 
      src="VB中利用OpenGL绘制三维地质构造图3.files/content.htm" frameBorder=0 width=130 
      scrolling=no height=60></IFRAME></TD></TR></TBODY></TABLE><IFRAME 
src="VB中利用OpenGL绘制三维地质构造图3.files/y-soft-column-1.htm" frameBorder=0 width=766 
scrolling=no height=96>
		</IFRAME>
<TABLE cellSpacing=0 cellPadding=0 width=760 bgColor=#979797 border=0>
  <TBODY>
  <TR>
    <TD width=10></TD>
    <TD width=536><SPAN class=nava><FONT color=#ffffff>您现在的位置是： </FONT><A 
      href="http://www.yesky.com/72339069014638592/index.shtml"><FONT 
      color=#ffffff>软件</FONT></A><FONT color=#ffffff> &gt; </FONT><A 
      href="http://www.yesky.com/72342367549521920/index.shtml"><FONT 
      color=#ffffff>开发者网络</FONT></A><FONT color=#ffffff> &gt; </FONT><A 
      href="http://www.yesky.com/72342371844489216/index.shtml"><FONT 
      color=#ffffff>程序方舟</FONT></A><FONT color=#ffffff> &gt; </FONT><A 
      href="http://www.yesky.com/72342371928375296/index.shtml"><FONT 
      color=#ffffff>开发专栏</FONT></A><FONT color=#ffffff> &gt; </FONT><A 
      href="http://www.yesky.com/72342371928637440/index.shtml"><FONT 
      color=#ffffff>VB开发 </FONT></A><FONT color=#ffffff>&gt; </FONT><FONT 
      color=#ffffff>正文</FONT></SPAN></TD>
    <TD width=214 bgColor=#f7f7f7><IMG height=22 
      src="VB中利用OpenGL绘制三维地质构造图3.files/content-1.gif" 
  width=214></IMG></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width=760 bgColor=#f7f7f7 border=0>
  <TBODY>
  <TR>
    <TD width=149 height=10></TD>
    <TD width=1 background=VB中利用OpenGL绘制三维地质构造图3.files/content-3.gif 
    height=10></TD>
    <TD width=610 height=10></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width=760 bgColor=#f7f7f7 border=0>
  <TBODY>
  <TR>
    <TD vAlign=top align=middle width=149>・<A 
      href="http://www.chinabyte.com/20020731/1623017.shtml">速成电脑精英（包分配）白领高薪一族从这里开始</A></TD></TR>
  <TR>
    <TD vAlign=top align=middle width=149><IFRAME 
      src="VB中利用OpenGL绘制三维地质构造图3.files/softwaresv.htm" frameBorder=0 width=120 
      scrolling=no height=500></IFRAME><BR><BR>
      <SCRIPT src="VB中利用OpenGL绘制三维地质构造图3.files/140_250.js"></SCRIPT>
      <BR>
      <TABLE cellSpacing=0 cellPadding=0 width=135 border=0>
        <TBODY>
        <TR>
          <TD width=30 bgColor=#3d7b7b><IMG height=17 
            src="VB中利用OpenGL绘制三维地质构造图3.files/content-2.gif" width=24 
            align=absMiddle></IMG></TD>
          <TD class=nava align=middle width=105 bgColor=#a0d0d0><A class=A1 
            href="http://www.yesky.com/72348964619288576/index.shtml"><FONT 
            color=#000000>T O P 排 行</FONT></A></TD></TR>
        <TR>
          <TD vAlign=top align=middle width="6%" bgColor=#ebebeb>-</TD>
          <TD width="94%" bgColor=#ebebeb><A 
            href="http://www.yesky.com/20030110/1647918.shtml">Java套接字编程（下）</A><BR></TD></TR>
        <TR>
          <TD vAlign=top align=middle width="6%" bgColor=#ebebeb>-</TD>
          <TD width="94%" bgColor=#ebebeb><A 
            href="http://www.yesky.com/20030108/1647533.shtml">MediaStudio Pro 
            6.5教程</A><BR></TD></TR>
        <TR>
          <TD vAlign=top align=middle width="6%" bgColor=#ebebeb>-</TD>
          <TD width="94%" bgColor=#ebebeb><A 
            href="http://www.yesky.com/20030103/1646964.shtml">三款卸载软件最新试用</A><BR></TD></TR>
        <TR>
          <TD vAlign=top align=middle width="6%" bgColor=#ebebeb>-</TD>
          <TD width="94%" bgColor=#ebebeb><A 
            href="http://www.yesky.com/20030102/1646785.shtml">基于Visual 
            C++的Winsock API研究</A><BR></TD></TR></TBODY></TABLE><BR>
      <TABLE cellSpacing=0 cellPadding=0 width=135 border=0>
        <TBODY>
        <TR>
          <TD width=30 bgColor=#3d7b7b><IMG height=17 
            src="VB中利用OpenGL绘制三维地质构造图3.files/content-2.gif" width=24 
            align=absMiddle></IMG></TD>
          <TD class=nava align=middle width=105 bgColor=#a0d0d0><A class=A1 
            href="http://training.yesky.com/"><FONT color=#000000>网 校 热 
            门</FONT></A></TD></TR></TBODY></TABLE>
      <SCRIPT src="VB中利用OpenGL绘制三维地质构造图3.files/softyesky.js"></SCRIPT>
    </TD>
    <TD width=1 background=VB中利用OpenGL绘制三维地质构造图3.files/content-3.gif></TD>
    <TD vAlign=top align=middle>
      <TABLE cellSpacing=2 cellPadding=0 width=550 border=0>
        <TBODY>
        <TR>
          <TD align=middle><B><FONT class=BHEAD 
            color=#333399>VB中利用OpenGL绘制三维地质构造图</FONT></B></TD></TR>
        <TR>
          <TD bgColor=#bbbbbb height=1></TD></TR>
        <TR>
          <TD align=middle><FONT face="Arial, Helvetica, sans-serif"><SPAN 
            class=nava>2002-06-27・ ・谢青、姜h・・yesky<BR><BR></SPAN></FONT></TD></TR>
        <TR>
          <TD>
            <P align=right><FONT color=red><A 
            href="http://www.yesky.com/20020627/1618051_1.shtml">上一页</A>&nbsp;&nbsp;<A 
            href="http://www.yesky.com/20020627/1618051.shtml">1</A> <A 
            href="http://www.yesky.com/20020627/1618051_1.shtml">2</A> 3 
            &nbsp;</FONT></P><SPAN class=txt>　　<B>6) 
            初始化颜色表</B><BR><BR>　　预先构造好颜色表。当读入高程数据时，可以根据Z值来访问颜色表，从而计算出该顶点的颜色（不同的高度层用不同的颜色显示）。<BR>
            <P></P>
            <TABLE width="100%" bgColor=#ffffff>
              <TBODY>
              <TR>
                <TD>Private Sub InitColorTable()<BR>'初始化颜色表<BR>For i = 0 To 
                  255<BR>With ColorTable(i)<BR>.R = 255 - i: .G = i: .B = 
                  0<BR>End With<BR>Next i<BR>For i = 256 To 510<BR>With 
                  ColorTable(i)<BR>.R = 0: .G = 255 - (i - 255): .B = i - 
                  255<BR>End With<BR>Next i<BR>End Sub<BR></TD></TR></TBODY></TABLE>
            <P>　　<B>7) 
            从数据文件中获取数据</B><BR><BR>　　从data.txt文件中获取顶点数据。data.txt数据文件中第一行是构造图横向采样点的个数，第二行是构造图纵向采样点的个数，第三行为采样点的间距，第四行起为采样点的高度值。GetDataFromFile()过程从data.txt文件中读取数据，由于是等间距采样数据，所以顶点的X和Y坐标值可以直接计算出来，只有Z坐标值从数据文件中读入。获得顶点数据之后，计算出顶点的颜色，及填充三角形的法线矢量（用三角形序列填充）。<BR>　　 
            <BR>　　<B>8) 
            设置窗口识见区和裁剪区</B><BR><BR>　　设置窗口识见区和修剪空间,保持坐标系到屏幕坐标的映射不变<BR></P>
            <TABLE width="100%" bgColor=#ffffff>
              <TBODY>
              <TR>
                <TD>glViewport 0, 0, w, h '定义视见区<BR>glMatrixMode GL_PROJECTION 
                  '定义矩阵为投影矩阵<BR>glLoadIdentity '用于在进行矩阵处理之前"复位"坐标系<BR>If w &lt;= 
                  h Then '定义修剪空间<BR>glOrtho -2000, 2000, -1000* h / w, 2000* h / 
                  w, -10000, 10000<BR>Else<BR>glOrtho -1000 * w / h , 2000* w / 
                  h, -1000, 2000, -10000, 10000<BR>End 
                  If<BR>'告诉OpenGL将来的所有变换都会影响模型<BR>glMatrixMode GL_MODELVIEW 
                  '定义矩阵为模型变换矩阵<BR>glLoadIdentity</TD></TR></TBODY></TABLE>
            <P>　　<B>9) 
            绘制三维地质构造图</B><BR><BR>　　先进行旋转、比例和平移变换，再根据顶点数据进行绘图，运行结果如图2所示。绘制出来的三维地质构造图可以绕X、Y、Z轴进行360度自由旋转，也可以进行自动旋转；并可以对三维图分别沿X、Y、Z轴进行比例缩放，也可以使三维图沿X、Y、Z轴三个方向同时进行相同比例缩放。<BR></P>
            <TABLE width=600 align=center>
              <TBODY>
              <TR>
                <TD><IMG height=404 
                  src="VB中利用OpenGL绘制三维地质构造图3.files/jt-2002-6-27-image2.gif" 
                  width=530><BR>　　　　　　　　　　　图2 运行结果</TD></TR></TBODY></TABLE>
            <P>　　<B>10) 把绘图描述表从线程上脱离并删除</B><BR></P>
            <TABLE width="100%" bgColor=#ffffff>
              <TBODY>
              <TR>
                <TD>Public Sub ReleaseGLRC(hGLRC As 
                  Long)<BR>'把绘图描述表从线程上脱离并删除<BR>If hGLRC &lt;&gt; 0 
                  Then<BR>wglMakeCurrent 0, 0<BR>wglDeleteContext hGLRC<BR>End 
                  If<BR>End Sub<BR></TD></TR></TBODY></TABLE>
            <P>　　<B><FONT color=#ac000>3. 
            结束语</FONT></B><BR><BR>　　目前，计算机图形学已进入三维时代，三维图形在人们周围无所不在，三维图形在军事、航空、航天、医学、地质勘探、艺术造型和文化娱乐等方面都有着十分广泛的应用，而OpenGL是一种三维图形开发标准，是从事三维图形开发工作的必要工具，其稳定性、可靠性、可扩展性等特点，赋予了其强大的生命力和应用前景，OpenGL已经广泛应用于在CAD/CAM/CAE、医学图像处理、虚拟现实、娱乐、广告等领域，因而对于OpenGL的研究和应用有着重大意义。<BR></P>
            <P></P>
            <P>&nbsp;</P></SPAN>
            <P align=right><FONT color=red><A 
            href="http://www.yesky.com/20020627/1618051_1.shtml">上一页</A>&nbsp;&nbsp;<A 
            href="http://www.yesky.com/20020627/1618051.shtml">1</A> <A 
            href="http://www.yesky.com/20020627/1618051_1.shtml">2</A> 3 
            &nbsp;</FONT></P></TD></TR>
        <TR>
          <TD>
            <DIV align=right>【责任编辑：方舟】 <BR>
            <SCRIPT src="VB中利用OpenGL绘制三维地质构造图3.files/dell.js"></SCRIPT>
            <IMG height=10 src="VB中利用OpenGL绘制三维地质构造图3.files/kong.gif" 
            width=100></IMG><A href="javascript:sendemail()"><IMG height=13 
            src="" width=73 border=0></IMG></A><A 
            href="http://bbs.yesky.com/servlet/IBBS2.ListTopic?forumID=123">【发表评论】</A><A 
            href="javascript:window.close()"><FONT 
            color=#000000>【关闭窗口】</FONT></A></DIV></TD></TR>
        <TR>
          <TD><IFRAME src="VB中利用OpenGL绘制三维地质构造图3.files/software.htm" 
            frameBorder=0 width=550 scrolling=no height=80></IFRAME>
            <TABLE cellSpacing=0 cellPadding=0 width=550 border=0>
              <TBODY>
              <TR>
                <TD width=1 bgColor=#000000 rowSpan=5></TD>
                <TD bgColor=#000000 height=1></TD>
                <TD width=1 bgColor=#000000 rowSpan=5></TD></TR>
              <TR>
                <TD bgColor=#a0d0d0>■ 相关内容</TD></TR>
              <TR>
                <TD bgColor=#000000 height=1></TD></TR>
              <TR>
                <TD>　<A 
                  href="http://www.yesky.com/20021115/1640124.shtml"><FONT 
                  color=#000000>VB多类图片数据库存取技巧</FONT></A><BR>　<A 
                  href="http://www.yesky.com/20020918/1631010.shtml"><FONT 
                  color=#000000>用VB6设计有趣的动画场景</FONT></A><BR>　<A 
                  href="http://www.yesky.com/20020917/1630892.shtml"><FONT 
                  color=#000000>用VB设计有安全认证服务的Email </FONT></A><BR>　<A 
                  href="http://www.yesky.com/20020529/1613482.shtml"><FONT 
                  color=#000000>如何在VB例程中接收自定义消息</FONT></A><BR>　<A 
                  href="http://www.yesky.com/20020413/1606841.shtml"><FONT 
                  color=#000000>如何用VB.Net创建一个三层的数据库应用程序</FONT></A><BR>　<A 
                  href="http://www.yesky.com/20020304/1600076.shtml"><FONT 
                  color=#000000>在VB下实现无线通信的方法</FONT></A><BR>　<A 
                  href="http://www.yesky.com/20020209/217874.shtml"><FONT 
                  color=#000000>将VB程序创建为系统服务</FONT></A><BR>　<A 
                  href="http://www.yesky.com/20020108/213121.shtml"><FONT 
                  color=#000000>VB6中用DataReport做报表</FONT></A><BR>　<A 
                  href="http://www.yesky.com/20020106/212830.shtml"><FONT 
                  color=#000000>VB6.0实现系统托盘 </FONT></A><BR>　<A 
                  href="http://www.yesky.com/20011222/211163.shtml"><FONT 
                  color=#000000>用VB编写"投注"程序</FONT></A><BR>　<A 
                  href="http://www.yesky.com/20011222/211164.shtml"><FONT 
                  color=#000000>用VB制作文件下载程序</FONT></A><BR>　<A 
                  href="http://www.yesky.com/20011222/211165.shtml"><FONT 
                  color=#000000>用VB编写“红绿灯”程序</FONT></A><BR></TD></TR>
              <TR>
                <TD bgColor=#000000 height=1></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD align=middle><A href="http://www.yesky.com/hdong/zz.htm" 
            target=_blank><FONT 
            color=#000000>感谢访问天极网，如果您觉得该文章涉及版权问题，请看这里！</FONT></A><BR><BR></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width=760 bgColor=#4e4e4e border=0>
  <TBODY>
  <TR>
    <TD height=3></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width=770 align=center border=0>
  <TBODY>
  <TR>
    <TD><IFRAME src="VB中利用OpenGL绘制三维地质构造图3.files/floor-tougao.htm" 
      frameBorder=0 width=770 scrolling=no 
height=20></IFRAME></TD></TR></TBODY></TABLE>
<TABLE height=40 cellSpacing=0 cellPadding=0 width=770 align=center border=0>
  <TBODY>
  <TR>
    <TD>
      <DIV align=center><SPAN class=nava><FONT 
      face="Arial, Helvetica, sans-serif" color=#000000>Copyright (C) 2001 
      Yesky.com, All Rights Reserved </FONT><FONT color=#000000><BR>版权所有　 <FONT 
      face="Arial, Helvetica, sans-serif">Yesky </FONT><A 
      href="mailto:webmaster@yesky.com"></A></FONT></SPAN></DIV></TD></TR></TBODY></TABLE>
<SCRIPT language=Javascript>document.write("<img src='http://counter.yesky.com/counter.shtml?CID=72342371928637440&AID=1618051&refer="+escape(document.referrer)+"&cur="+escape(document.URL)+"' border='0' alt='' width='0' height='0'>");</SCRIPT>
<BR></DIV></BODY></HTML>
