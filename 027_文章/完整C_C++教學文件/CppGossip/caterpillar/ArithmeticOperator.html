<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>




  
  
  
  <link rel="stylesheet" href="print.css" tppabs="http://caterpillar.onlyfun.net/Gossip/CppGossip/css/print.css" type="text/css">




  
  
  
  <link rel="stylesheet" href="stdlayout.css" tppabs="http://caterpillar.onlyfun.net/Gossip/CppGossip/css/stdlayout.css" type="text/css">




  
  
  
  <meta content="text/html; charset=Big5" http-equiv="content-type">



  
  
  
  <title>算術運算、型態轉換</title>
</head>


<body>




<h3><a href="javascript:if(confirm('http://caterpillar.onlyfun.net/Gossip/index.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://caterpillar.onlyfun.net/Gossip/index.html'" tppabs="http://caterpillar.onlyfun.net/Gossip/index.html">From
Gossip@caterpillar</a></h3>




<h1><a href="CppGossip.html" tppabs="http://caterpillar.onlyfun.net/Gossip/CppGossip/CppGossip.html">C++ Gossip: 算術運算、型態轉換</a></h1>




<table style="text-align: left; width: 946px; height: 32px;" border="0" cellpadding="0" cellspacing="0">




  <tbody>




    <tr>




      <td style="width: 676px; vertical-align: top;"><small>在C++中提供與算術相關的
加（+）、減（-）、乘（*）、除（/）的運算子，另外還有一個也很常用的餘除運算子（%）或稱模數（Modulus）運算子，這類以數學運算為主的
運算子，稱之為「算術運算子」（Arithmetic operator）。 <br>


      <br>




這類運算子的使用基本上由左而右進行運算，遇到加減乘除的順序問題時，也是先乘除後加減，必要時加上括號表示運算的先後順序，例如這個程式碼會在主控台顯
示7： <br>


      </small>



      
      
      <div style="margin-left: 40px;"><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">cout
&lt;&lt; (1 + 2 *
3);</span><br>




      </small></div>




      <small><br>




編譯器在讀取程式碼時，是由左往右讀取的，而初學者往往會犯一個錯誤，例如(1+2+3) /
4，由於我們習慣將分子寫在上面，而分母寫在下面的方式，使得初學者往往將之寫成了： <br>


      </small>

      
      
      <div style="margin-left: 40px;"><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">cout
&lt;&lt; 1+2+3 / 4;</span><br>




      </small></div>




      <small><br>




這個程式事實上會是這樣運算的：1+2+(3/4)；為了避免這樣的錯誤，在必要的時候為運算式加上括號才是最保險的，例如： <br>


      </small>

      
      
      <div style="margin-left: 40px;"><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">cout
&lt;&lt; (1+2+3) /
4;</span><br>




      </small></div>




      <small><br>




%運算子是餘除運算子
它計算除法後的餘數，一個例子是若您要產生指定位數的亂數，就可以使用%運算子，假設亂數產生函式為rand()，它可以產生正整數亂數，但您並不知道它
的最大範圍是多少，您可以這樣產生0到99的亂數： <br>


      </small>

      
      
      <div style="margin-left: 40px;"><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">cout
&lt;&lt; rand() %
100;</span><br>




      </small></div>




      <small><br>




您也可以利用%來作循環計數之用，例如由0計數至9不斷循環： <br>


      </small>

      
      
      <div style="margin-left: 40px;"><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">couter
= (counter + 1)
% 10;</span><br>




      </small></div>




      <small><br>




算術運算子使用不難，但要注意型態轉換的問題，請您先看看這段程式會印出什麼結果？ <br>


      </small>

      
      
      <div style="margin-left: 40px;"><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">int
number = 10; </span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">




      <span style="font-weight: bold; font-family: Courier New,Courier,monospace;">cout
&lt;&lt;
number / 3;</span><br>




      </small></div>




      <small><br>




答案不是3.3333，而是3，小數點之後的部份被自動消去了，這是因為您的number是整數，而除數3也是整數，運算出來的程式被自動轉換為整數了，
那下面這個程式呢？<br>


      </small>

      
      
      <div style="margin-left: 40px;"><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">double
number = 10.0;</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">




      <span style="font-weight: bold; font-family: Courier New,Courier,monospace;">cout
&lt;&lt;
number / 3;</span><br>




      </small></div>




      <small><br>




這個程式的結果會顯示3.3333，這是C++的隱式型態轉換（Implicit type
conversion），在一個型態混雜的算式中，長度較長的資料型態會成為目標型態，較小的型態會自動提升為目標型態，因而在上例中3會被提升為3.0
再進行運算，結果就可以顯示無誤，這樣的轉換又稱算術轉換（Arithmetic conversion）。<br>


      <br>




在一個指定的動作中，左邊的數值會成為目標型態，當右邊的數值型態比左邊的數值型態長度小時，右邊的數值會自動提升為目標型態，例如：<br>


      </small>



      
      
      <div style="margin-left: 40px;"><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">int
num = 10;</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">




      <span style="font-weight: bold; font-family: Courier New,Courier,monospace;">double
number =
num;</span><br>




      </small></div>




      <small><br>




在上例中，number的值最後會是10.0，在指定的動作時，如果右邊的數值型態比左邊的數值型態型態長度大時，超出可儲存範圍的部份會被自動消去，例
如將浮點數指定給整數變數，則小數的部份會被自動消去，例子如下，程式會顯示3而不是3.14：<br>


      </small>

      
      
      <div style="margin-left: 40px;"><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">int&nbsp;num
= 0; </span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">




      <span style="font-weight: bold; font-family: Courier New,Courier,monospace;">double
number =
3.14; </span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">




      <span style="font-weight: bold; font-family: Courier New,Courier,monospace;">num
= number; </span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">




      <span style="font-weight: bold; font-family: Courier New,Courier,monospace;">cout
&lt;&lt;&nbsp;num;</span><br>




      </small></div>




      <small><br>




由於失去的精度，在編譯時編譯器會提出警訊：<br>


      </small>

      
      
      <div style="margin-left: 40px;"><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace; color: rgb(255, 0, 0);">[Warning]
converting to
`int' from `double' </span><br>




      </small></div>




      <small><br>




如果確定這個動作是您想要的，那麼您可以使用顯式型態轉換（Explicit type conversion）或稱之為強制轉型（Cast），例如：<br>


      </small>

      
      
      <div style="margin-left: 40px; font-family: Courier New,Courier,monospace;"><small><span style="font-weight: bold;">int&nbsp;num = 0; </span><br style="font-weight: bold;">




      <span style="font-weight: bold;">double number =
3.14; </span><br>




      </small></div>




      
      
      <div style="margin-left: 40px;"><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">num
=
static_cast&lt;int&gt;(number);</span><br>




      </small></div>




      <small><br>




在兩個整數型態相除時，您也可以進行型態轉換，將其中一個型態轉換至double型態再進行運算，例如：<br>


      </small>

      
      
      <div style="margin-left: 40px;"><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">int
number = 10;</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">




      <span style="font-weight: bold; font-family: Courier New,Courier,monospace;">cout
&lt;&lt;
static_cast&lt;double&gt;(number) / 3;</span><br>




      </small></div>




      <small><br>




上例中結果會顯示3.3333。<br>


      <br>




static_cast是Standard C++新增加的轉型語法，在這之前顯式型態轉換可以使用以下的舊語法：<br>


      </small>



      
      
      <div style="margin-left: 40px;"><small><span style="font-weight: bold; font-family: Courier New,Courier,monospace;">int
number = 10;</span><br style="font-weight: bold; font-family: Courier New,Courier,monospace;">




      <span style="font-weight: bold; font-family: Courier New,Courier,monospace;">cout
&lt;&lt;
(double) number/ 3;</span><br>




      </small></div>




      <small><br>




基於向後相容，Standard
C++仍支援這種舊語法，但鼓勵您使用新風格的語法，在新風格語法中還增加有const_cast、reinterpret_cast
與dynamic_cast，適用於不同的轉型場合，這在之後還會再介紹。</small><br>



      </td>




      <td style="width: 250px; text-align: center; vertical-align: top;"><comment title=" adsense for content" xmlns="http://disruptive-innovations.com/zoo/nvu"></comment>&nbsp;
      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br>

      <comment title=" adsense for content end" xmlns="http://disruptive-innovations.com/zoo/nvu"></comment><br>

      <comment title=" adsense for content" xmlns="http://disruptive-innovations.com/zoo/nvu"></comment>
      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->&#160;</script>&nbsp;
      <script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script><comment title=" adsense for content end" xmlns="http://disruptive-innovations.com/zoo/nvu"></comment><br>

      <br>
      <center>
      <script language="javascript" src="showads.aspx-blogid=20070509000002&charset=big5" tppabs="http://ad2.bloggerads.net/showads.aspx?blogid=20070509000002&charset=big5"></script><br>

      </center>

 </td>




    </tr>




  
  
  
  </tbody>
</table>




<br>





<br>




<script src="urchin.js" tppabs="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-143766-1";
urchinTracker();
</script>
</body>
</html>
