<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
<title>3.1 编写第一个窗口程序</title>
</head>

<body link="#3973DE" alink="#3973DE">
<font SIZE="5"><b><div align="center"><center>

<table border="0" width="615" cellspacing="0" cellpadding="0">
  <tr>
    </b><td><div align="center"><center><table border="0" width="615" cellpadding="0" cellspacing="0" height="20">
      <tr>
        <td width="377" bgcolor="#15397D" height="20"></td>
        <td width="238" bgcolor="#000000" height="20"><p align="right"></font><span style="text-decoration: none"><a href="javascript:if(confirm('http://www.lzu.edu.cn/netteach/jiaochen/vc++5.0/index.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.lzu.edu.cn/netteach/jiaochen/vc++5.0/index.htm'" tppabs="http://www.lzu.edu.cn/netteach/jiaochen/vc++5.0/index.htm"><font color="#FFFFFF">电脑报Visual 
        C++网络教程</font></a></span></td>
      </tr>
    </table>
    </center></div><font FACE="Times New Roman" SIZE="4"><b><p ALIGN="CENTER"></b></font><font color="#3973DE" FACE="Times New Roman" SIZE="4">3.1 </font><font SIZE="4" color="#3973DE">编写第一个窗口程序</font><font FACE="Times New Roman" SIZE="3"></p>
    <p></font><font SIZE="3">现在我们开始编写全书的第一个程序。跟我们以前学习程序设计的方法不同（以前我们是输入完整程序，然后运行），我们首先利用</font><font FACE="Times New Roman" SIZE="3">Visual Studio</font><font SIZE="3">的可视化编程工具</font><font FACE="Times New Roman" SIZE="3">AppWizard</font><font SIZE="3">生成框架程序，再往里边填写代码。这是一种“填空式”的编程方法：首先生成框架，然后根据目标程序的要求，看哪些地方需要修改，再往里填写代码。类似其他语言，我们把第一个程序命名为</font><font FACE="Times New Roman" SIZE="3">Hello</font><font SIZE="3">。</font><font FACE="Times New Roman" SIZE="3"></p>
    <p></font><font SIZE="3">首先启动</font><font FACE="Times New Roman" SIZE="3">AppWizard</font><font SIZE="3">：在</font><font FACE="Times New Roman" SIZE="3">File</font><font SIZE="3">菜单下选择</font><font FACE="Times New Roman" SIZE="3">New</font><font SIZE="3">，弹出</font><font FACE="Times New Roman" SIZE="3">New</font><font SIZE="3">对话框，如图</font><font FACE="Times New Roman" SIZE="3">3.1</font><font SIZE="3">所示。</font><font FACE="Times New Roman" SIZE="3"></p>
    <p align="center"></font><img src="T3_1.gif" tppabs="http://www.lzu.edu.cn/netteach/jiaochen/vc++5.0/vc++5.0/chap3/T3_1.gif" alt="T3_1.tif (367480 bytes)" WIDTH="537" HEIGHT="349"><font FACE="Times New Roman" SIZE="3"></p>
    <p align="center"></font><font SIZE="3"><font SIZE="3">图</font></font><font FACE="Times New Roman" SIZE="3">3.1 New</font><font SIZE="3"><font SIZE="3">对话框</font></font><font FACE="Times New Roman" SIZE="3"></p>
    <p></font><font SIZE="3">在对话框顶部有一排标签，用于选择要创建的文档的类型。选择</font><font FACE="Times New Roman" SIZE="3">Projects</font><font SIZE="3">标签，然后在列表中选择</font><font FACE="Times New Roman" SIZE="3">MFC AppWizard</font><font SIZE="3">（</font><font FACE="Times New Roman" SIZE="3">exe</font><font SIZE="3">），告诉</font><font FACE="Times New Roman" SIZE="3">Visual C++</font><font SIZE="3">要使用</font><font FACE="Times New Roman" SIZE="3">AppWizard</font><font SIZE="3">创建一个</font><font FACE="Times New Roman" SIZE="3">EXE</font><font SIZE="3">程序；在</font><font FACE="Times New Roman" SIZE="3">Project Name</font><font SIZE="3">编辑框中输入工程文件名</font><font FACE="Times New Roman" SIZE="3">Hello</font><font SIZE="3">，在</font><font FACE="Times New Roman" SIZE="3">Location</font><font SIZE="3">中指定应用程序创建的位置，缺省情况下</font><font FACE="Times New Roman" SIZE="3">AppWizard</font><font SIZE="3">会自动在当前目录下以工程文件名为名字创建一个新目录，在该目录下存放所有该工程的文件。这里将目录设置为“</font><font FACE="Times New Roman" SIZE="3">C:\Hello</font><font SIZE="3">”，然后选择</font><font FACE="Times New Roman" SIZE="3">OK</font><font SIZE="3">按钮，此时弹出</font><font FACE="Times New Roman" SIZE="3">MFC-AppWizard-Step1</font><font SIZE="3">对话框，如图</font><font FACE="Times New Roman" SIZE="3">3.2</font><font SIZE="3">所示。</font><font FACE="Times New Roman" SIZE="3"></p>
    <p align="center"></font><img src="T3_2.gif" tppabs="http://www.lzu.edu.cn/netteach/jiaochen/vc++5.0/vc++5.0/chap3/T3_2.gif" alt="T3_2.tif (300972 bytes)" WIDTH="523" HEIGHT="399"><font FACE="Times New Roman" SIZE="3"></p>
    <p align="center"></font><font SIZE="3"><font SIZE="3">图</font></font><font FACE="Times New Roman" SIZE="3">3.2 MFC AppWizard-Step 1</font><font SIZE="3"><font SIZE="3">对话框</font></font><font FACE="Times New Roman" SIZE="3"></p>
    <p>AppWizard</font><font SIZE="3">是一个自动化程序生成工具，它通过提示用户一系列对话框，来指定将要生成的应用程序的特性，然后自动生成相应的代码。下面，我们一步一步演示如何用</font><font FACE="Times New Roman" SIZE="3">AppWizard</font><font SIZE="3">生成</font><font FACE="Times New Roman" SIZE="3">Hello</font><font SIZE="3">程序。</font><font FACE="Times New Roman" SIZE="3"></p>
    <p>1.MFC AppWizard</font><font SIZE="3">当前显示</font><font FACE="Times New Roman" SIZE="3">MFC AppWizard-Step1</font><font SIZE="3">对话框。在这个对话框中，可以指定生成框架的类型，包括</font><font FACE="Times New Roman" SIZE="3">Single Document</font><font SIZE="3">（单文档），</font><font FACE="Times New Roman" SIZE="3">Multiple Document</font><font SIZE="3">（多文档），</font><font FACE="Times New Roman" SIZE="3">Dialog Based</font><font SIZE="3">（基于对话框）三种。还可以从下拉列表框中选择语言，指定程序资源文件使用的语言类型。选择</font><font FACE="Times New Roman" SIZE="3">Single Document</font><font SIZE="3">，此时</font><font FACE="Times New Roman" SIZE="3">AppWizard</font><font SIZE="3">将生成一个单文档的应用程序框架，也就是说，应用程序运行时是一个单窗口的界面。点击</font><font FACE="Times New Roman" SIZE="3">Next</font><font SIZE="3">按钮。</font><font FACE="Times New Roman" SIZE="3"></p>
    <p align="center"></font><img src="T3_3.gif" tppabs="http://www.lzu.edu.cn/netteach/jiaochen/vc++5.0/vc++5.0/chap3/T3_3.gif" alt="T3_3.tif (296952 bytes)" WIDTH="488" HEIGHT="371"><font FACE="Times New Roman" SIZE="3"></p>
    <p align="center"></font><font SIZE="3"><font SIZE="3">图</font></font><font FACE="Times New Roman" SIZE="3">3.3 MFC AppWizard-Step 2 of 6</font><font SIZE="3"><font SIZE="3">对话框</font></font><font FACE="Times New Roman" SIZE="3"></p>
    <p ALIGN="JUSTIFY">2.</font><font SIZE="3">此时</font><font FACE="Times New Roman" SIZE="3">MFC AppWizard</font><font SIZE="3">显示图</font><font FACE="Times New Roman" SIZE="3">3.3</font><font SIZE="3">所示</font><font FACE="Times New Roman" SIZE="3">MFC 
    AppWizard-Step 2 of 6</font><font SIZE="3">对话框。该对话框用于指定数据库选项。</font><font FACE="Times New Roman" SIZE="3">MFC AppWizard</font><font SIZE="3">支持数据库并可以生成数据库应用程序所必需的代码。选择缺省值</font><font FACE="Times New Roman" SIZE="3">None</font><font SIZE="3">，不使用数据库特性。点击</font><font FACE="Times New Roman" SIZE="3">Next</font><font SIZE="3">按钮，弹出</font><font FACE="Times New Roman" SIZE="3">MFC AppWizard-Step3</font><font SIZE="3">对话框，如图</font><font FACE="Times New Roman" SIZE="3">3.4</font><font SIZE="3">所示。</font><font FACE="Times New Roman" SIZE="3"></p>
    <p align="center"></font><img src="T3_4.gif" tppabs="http://www.lzu.edu.cn/netteach/jiaochen/vc++5.0/vc++5.0/chap3/T3_4.gif" alt="T3_4.tif (298033 bytes)" WIDTH="485" HEIGHT="368"><font FACE="Times New Roman" SIZE="3"></p>
    <p align="center"></font><font SIZE="3"><font SIZE="3">图</font></font><font FACE="Times New Roman" SIZE="3">3.4 MFC AppWizard-Step 3 of 6</font><font SIZE="3"><font SIZE="3">对话框</font></font><font FACE="Times New Roman" SIZE="3"></p>
    <p>3.</font><font SIZE="3">在</font><font FACE="Times New Roman" SIZE="3">MFC 
    AppWizard-Step 3 of 6</font><font SIZE="3">对话框中，可以指定</font><font FACE="Times New Roman" SIZE="3">OLE</font><font SIZE="3">选项的复合文档类型。因为我们不用</font><font FACE="Times New Roman" SIZE="3">OLE</font><font SIZE="3">特性，所以使用缺省值</font><font FACE="Times New Roman" SIZE="3">None</font><font SIZE="3">。点击</font><font FACE="Times New Roman" SIZE="3">Next</font><font SIZE="3">按钮，进入下一个对话框。此时，屏幕显示</font><font FACE="Times New Roman" SIZE="3">MFC-AppWizard-Step 4 of 6</font><font SIZE="3">对话框，如图</font><font FACE="Times New Roman" SIZE="3">3.5</font><font SIZE="3">。</font><font FACE="Times New Roman" SIZE="3"></p>
    <p align="center"></font><img src="T3_5.gif" tppabs="http://www.lzu.edu.cn/netteach/jiaochen/vc++5.0/vc++5.0/chap3/T3_5.gif" alt="T3_5.tif (299042 bytes)" WIDTH="495" HEIGHT="379"><font FACE="Times New Roman" SIZE="3"></p>
    <p align="center"></font><font SIZE="3"><font SIZE="3">图</font></font><font FACE="Times New Roman" SIZE="3">3.5 MFC AppWizard-Step 4 of 6</font><font SIZE="3"><font SIZE="3">对话框</font></font><font FACE="Times New Roman" SIZE="3"></p>
    <p ALIGN="JUSTIFY">4.</font><font SIZE="3">第四个对话框用于指定应用程序的外观，包括是否使用工具条、状态栏，是否让文档支持打印和打印预览功能，是否使用</font><font FACE="Times New Roman" SIZE="3">3D</font><font SIZE="3">控制外观，以及是否支持在线帮助等。</font><font FACE="Times New Roman" SIZE="3">MFC AppWizard</font><font SIZE="3">还支持</font><font FACE="Times New Roman" SIZE="3">WOSA</font><font SIZE="3">（</font><font FACE="Times New Roman" SIZE="3">Windows</font><font SIZE="3">开放系统体系结构），可以直接在基于文档的程序中加入</font><font FACE="Times New Roman" SIZE="3">MAPI</font><font SIZE="3">电子邮件发送功能和</font><font FACE="Times New Roman" SIZE="3">WinSocket</font><font SIZE="3">网络编程接口支持。另外，还可以指定文档的一些特性，包括后缀名等。有关文档</font><font FACE="Times New Roman" SIZE="3">/</font><font SIZE="3">视结构的内容在后面章节中再作详细介绍。按照图</font><font FACE="Times New Roman" SIZE="3">3.5</font><font SIZE="3">所示，设置各个选项，它支持工具条、状态栏，使用</font><font FACE="Times New Roman" SIZE="3">3D</font><font SIZE="3">外观的控制。点击</font><font FACE="Times New Roman" SIZE="3">Next</font><font SIZE="3">按钮，弹出</font><font FACE="Times New Roman" SIZE="3">MFC AppWizard 5 of 6</font><font SIZE="3">对话框，如图</font><font FACE="Times New Roman" SIZE="3">3.6</font><font SIZE="3">所示。</font><font FACE="Times New Roman" SIZE="3"></p>
    <p ALIGN="center"><img src="T3_6.gif" tppabs="http://www.lzu.edu.cn/netteach/jiaochen/vc++5.0/vc++5.0/chap3/T3_6.gif" alt="T3_6.tif (296952 bytes)" WIDTH="490" HEIGHT="372"></p>
    <p align="center"></font><font SIZE="3">图</font><font FACE="Times New Roman" SIZE="3">3.6 
    MFC AppWizard-Step 5 of 6</font><font SIZE="3">对话框</font><font FACE="Times New Roman" SIZE="3"></p>
    <p>5.MFC AppWizard 5of 6</font><font SIZE="3">有两个选项，让用户设置生成源代码的选项及编译选项。</font><font FACE="Times New Roman" SIZE="3"></p>
    <p></font><font SIZE="3">第一个选项是：</font><font FACE="Times New Roman" SIZE="3">Would 
    you like to generate source file comments</font><font SIZE="3">？询问</font><font FACE="Times New Roman" SIZE="3">MFC AppWizard</font><font SIZE="3">是否为生成的源代码添加必要的注释说明。注释说明有助于对应用程序源代码的学习和理解，因此一般选择“</font><font FACE="Times New Roman" SIZE="3">Yes</font><font SIZE="3">，</font><font FACE="Times New Roman" SIZE="3">Please</font><font SIZE="3">”。</font><font FACE="Times New Roman" SIZE="3"></p>
    <p></font><font SIZE="3">第二个选项是：</font><font FACE="Times New Roman" SIZE="3">How 
    would you like to use the MFC library</font><font SIZE="3">？</font><font FACE="Times New Roman" SIZE="3"></p>
    <p ALIGN="JUSTIFY"></font><font SIZE="3">用户可以选择</font><font FACE="Times New Roman" SIZE="3">As a shared DLL(</font><font SIZE="3">使用共享动态连接库</font><font FACE="Times New Roman" SIZE="3">)</font><font SIZE="3">或</font><font FACE="Times New Roman" SIZE="3">As a static linked library</font><font SIZE="3">（静态连接库）。使用</font><font FACE="Times New Roman" SIZE="3">DLL</font><font SIZE="3">时，所有</font><font FACE="Times New Roman" SIZE="3">MFC</font><font SIZE="3">的类存放在动态连接库中，因此可以使应用程序小一些，但是发布该应用程序可执行文件时必需随同提供必要的动态连接库。使用静态库时，应用程序所用到的</font><font FACE="Times New Roman" SIZE="3">MFC</font><font SIZE="3">类都编译进了可执行文件之中，因此可执行文件比使用</font><font FACE="Times New Roman" SIZE="3">DLL</font><font SIZE="3">方式的要大，但可以单独发行。一般的，对于小的应用程序可以采用静态库方式，对于大的应用程序一般采用动态连接库方式。本书中的例子全部采用动态连接库选项（</font><font FACE="Times New Roman" SIZE="3">As a shared DLL</font><font SIZE="3">）。</font><font FACE="Times New Roman" SIZE="3"></p>
    <p>6.</font><font SIZE="3">点击</font><font FACE="Times New Roman" SIZE="3">Next</font><font SIZE="3">按钮以进入</font><font FACE="Times New Roman" SIZE="3">MFC AppWizard</font><font SIZE="3">的最后一个对话框。此时，将出现如图</font><font FACE="Times New Roman" SIZE="3">3.7</font><font SIZE="3">所示的对话框。</font><font FACE="Times New Roman" SIZE="3"></p>
    <p align="center"><img src="T3_7.gif" tppabs="http://www.lzu.edu.cn/netteach/jiaochen/vc++5.0/vc++5.0/chap3/T3_7.gif" alt="T3_7.tif (298180 bytes)" WIDTH="478" HEIGHT="364"></p>
    <p align="center"></font><font SIZE="3">图</font><font FACE="Times New Roman" SIZE="3">3.7 
    MFC AppWizard-Step 6 of 6</font><font SIZE="3">对话框</font><font FACE="Times New Roman" SIZE="3"></p>
    <p></font><font SIZE="3">该对话框让用户选择</font><font FACE="Times New Roman" SIZE="3">MFC AppWizard</font><font SIZE="3">将要创建的类的属性，包括指定存放类的文件名以及这些类的基类。在这一步，用户可以修改所创建的类的名字、对应的文件以及赖以派生的父类。对于</font><font FACE="Times New Roman" SIZE="3">Hello</font><font SIZE="3">程序，直接对话框中的使用缺省设置。</font><font FACE="Times New Roman" SIZE="3"></p>
    <p>7.</font><font SIZE="3">点</font><font FACE="Times New Roman" SIZE="3">Finish</font><font SIZE="3">按钮，弹出</font><font FACE="Times New Roman" SIZE="3">New Project 
    Information</font><font SIZE="3">对话框。它给出一个关于即将生成的应用程序的总体描述，包括应用程序类型（单文档）、要创建的类及所在文件、应用程序的一些特性（是否支持工具条、状态栏等）。按</font><font FACE="Times New Roman" SIZE="3">Enter</font><font SIZE="3">键或点</font><font FACE="Times New Roman" SIZE="3">OK</font><font SIZE="3">按钮，此时</font><font FACE="Times New Roman" SIZE="3">AppWizard</font><font SIZE="3">将在</font><font FACE="Times New Roman" SIZE="3">c:\hello</font><font SIZE="3">目录下生成</font><font FACE="Times New Roman" SIZE="3">Hello</font><font SIZE="3">程序所有的框架文件。生成程序后，在项目工作区中自动打开</font><font FACE="Times New Roman" SIZE="3">Hello.dsw</font><font SIZE="3">项目工作区文件。窗口标题将显示打开的项目名</font><font FACE="Times New Roman" SIZE="3">Hello</font><font SIZE="3">。</font><font FACE="Times New Roman" SIZE="4"><b></p>
    </b></font><div align="center"><center><table border="0" cellpadding="0" cellspacing="0" width="615">
      <tr>
        <td><a href="chap3.htm" tppabs="http://www.lzu.edu.cn/netteach/jiaochen/vc++5.0/vc++5.0/chap3/chap3.htm">上一页</a></td>
        <td><p align="right"><a href="chap3_2.htm" tppabs="http://www.lzu.edu.cn/netteach/jiaochen/vc++5.0/vc++5.0/chap3/chap3_2.htm">下一页</a></td>
      </tr>
    </table>
    </center></div><font SIZE="5"><hr noshade color="#3973DE" size="1">
    <p align="center"></font><font size="2" color="#000000">本教程由<a href="javascript:if(confirm('http://vcdynasty.yeah.net/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://vcdynasty.yeah.net/'" tppabs="http://vcdynasty.yeah.net/">Visual C++王朝（Where programmers come together）</a>协助制作<br>
    未经许可，请勿以任何形式复制</font></td>
    <b>
  </tr>
</table>
</center></div>

<p ALIGN="CENTER"></b><font SIZE="5">　</font><font FACE="Times New Roman" SIZE="5"></p>
</font><font FACE="Times New Roman" SIZE="3">

<p></font><b><font SIZE="3">　</font><font FACE="Times New Roman" SIZE="3"></p>
</font></b>

<p><font SIZE="3">　</font><font FACE="Times New Roman" SIZE="3"></p>

<p></font>　</p>
</body>
</html>
