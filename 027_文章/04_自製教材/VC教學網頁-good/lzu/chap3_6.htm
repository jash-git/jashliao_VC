<html>

<head>
<title>3.6 使用菜单</title>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
</head>

<body link="#3973DE" alink="#3973DE">
<font SIZE="5"><b><div align="center"><center>

<table border="0" width="615" cellspacing="0" cellpadding="0">
  <tr>
    </b><td><div align="center"><center><table border="0" width="615" cellpadding="0" cellspacing="0" height="20">
      <tr>
        <td width="377" bgcolor="#15397D" height="20"></td>
        <td width="238" bgcolor="#000000" height="20"><p align="right"></font><span style="text-decoration: none"><a href="javascript:if(confirm('http://www.lzu.edu.cn/netteach/jiaochen/vc++5.0/index.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.lzu.edu.cn/netteach/jiaochen/vc++5.0/index.htm'" tppabs="http://www.lzu.edu.cn/netteach/jiaochen/vc++5.0/index.htm"><font color="#FFFFFF">电脑报Visual 
        C++网络教程</font></a></span></td>
      </tr>
    </table>
    </center></div><p align="center"><font color="#3973DE" FACE="Times New Roman" size="4">3.6 
    </font><font color="#3973DE" size="4">使用菜单</font></p>
    <font SIZE="3"><font FACE="Times New Roman"><p></font>现在我们要在主窗口中加入自己的菜单。菜单编程一般分三步：</font><font FACE="Times New Roman" SIZE="3"></p>
    <p>1.</font><font SIZE="3">编辑菜单资源，设置菜单属性（包括菜单名和</font><font FACE="Times New Roman" SIZE="3">ID</font><font SIZE="3">）；</font><font FACE="Times New Roman" SIZE="3"></p>
    <p>2.</font><font SIZE="3">用</font><font FACE="Times New Roman" SIZE="3">ClassWizard</font><font SIZE="3">自动映射菜单消息和成员函数；</font><font FACE="Times New Roman" SIZE="3"></p>
    <p>3.</font><font SIZE="3">手工编辑成员函数，加入菜单消息处理代码。</font><font FACE="Times New Roman" SIZE="3"><b></p>
    <p></b></font><font color="#3973DE" FACE="Times New Roman" SIZE="3">3.6.1 </font><font SIZE="3" color="#3973DE">编辑菜单资源</font><font FACE="Times New Roman" SIZE="3"></p>
    <p></font><font SIZE="3">仍然使用我们前面生成的</font><font FACE="Times New Roman" SIZE="3">Hello</font><font SIZE="3">程序，编辑由</font><font FACE="Times New Roman" SIZE="3">AppWizard</font><font SIZE="3">自动生成的菜单资源。要编辑菜单资源：</font><font FACE="Times New Roman" SIZE="3"></p>
    <p>(1) </font><font SIZE="3">选择项目工作区的</font><font FACE="Times New Roman" SIZE="3">ResourceView</font><font SIZE="3">标签，切换到资源视图。</font><font FACE="Times New Roman" SIZE="3"></p>
    <p>(2) </font><font SIZE="3">选择菜单资源类型。</font><font FACE="Times New Roman" SIZE="3"></p>
    <p>(3) </font><font SIZE="3">选定菜单资源</font><font FACE="Times New Roman" SIZE="3">IDR_MAINFRAME</font><font SIZE="3">，双击该项或单击鼠标右键然后在弹出菜单中选择</font><font FACE="Times New Roman" SIZE="3">Open</font><font SIZE="3">选项。</font><font FACE="Times New Roman" SIZE="3">Visual Studio</font><font SIZE="3">将弹出菜单编辑窗口，显示菜单资源</font><font FACE="Times New Roman" SIZE="3">IDR_MAINFRAME</font><font SIZE="3">，其中</font><font FACE="Times New Roman" SIZE="3">IDR_MAINFRAME</font><font SIZE="3">是由</font><font FACE="Times New Roman" SIZE="3">AppWizard</font><font SIZE="3">在创建该程序时自动生成的。</font><font FACE="Times New Roman" SIZE="3"></p>
    <p>(4) </font><font SIZE="3">编辑当前菜单</font><font FACE="Times New Roman" SIZE="3"></p>
    <p></font><font SIZE="3">要删除某个菜单项或弹出菜单，可用鼠标单击该菜单或用上下光标键来回选择，然后按</font><font FACE="Times New Roman" SIZE="3">Del</font><font SIZE="3">键删除；要插入新菜单项，可选定窗口中的空白菜单框后按回车（或直接用鼠标双击该空白框），</font><font FACE="Times New Roman" SIZE="3">Visual Studio</font><font SIZE="3">弹出</font><font FACE="Times New Roman" SIZE="3">Properties</font><font SIZE="3">（属性）对话框，如图</font><font FACE="Times New Roman" SIZE="3">3-11</font><font SIZE="3">所示。属性对话框用于输入菜单项的标题、标识符、菜单项在状态栏上显示的提示（</font><font FACE="Times New Roman" SIZE="3">Prompt</font><font SIZE="3">），并为该菜单提供属性调整。也可以在选择一个已有的菜单项时按</font><font FACE="Times New Roman" SIZE="3">Ins</font><font SIZE="3">键，以在该菜单项上方插入一个空白菜单项，然后双击该菜单项进行编辑。要插入一个分隔线，只需将菜单项的</font><font FACE="Times New Roman" SIZE="3">Seperator</font><font SIZE="3">属性打开即可。</font><font FACE="Times New Roman" SIZE="3"></p>
    <p>Visual Studio</font><font SIZE="3">支持鼠标拖曳调整菜单项位置。要调整菜单项位置，只需要选中某菜单项并将其拖至适当位置即可。</font><font FACE="Times New Roman" SIZE="3"></p>
    <p align="center"></font><img src="T3_11.gif" tppabs="http://www.lzu.edu.cn/netteach/jiaochen/vc++5.0/vc++5.0/chap3/T3_11.gif" alt="T3_11.tif (250480 bytes)" WIDTH="548" HEIGHT="308"><font FACE="Times New Roman" SIZE="3"></p>
    <p align="center"></font><font size="2">图</font><small><font FACE="Times New Roman" SIZE="3">3.11 </font></small><font size="2">菜单编辑器和属性对话框</font><font FACE="Times New Roman" SIZE="3"></p>
    <p></font><font SIZE="3">如上图，我们首先在</font><font FACE="Times New Roman" SIZE="3">Edit</font><font SIZE="3">和</font><font FACE="Times New Roman" SIZE="3">View</font><font SIZE="3">之间加入一个弹出菜单：用鼠标单击</font><font FACE="Times New Roman" SIZE="3">View</font><font SIZE="3">菜单，按</font><font FACE="Times New Roman" SIZE="3">Ins</font><font SIZE="3">键插入一个空白菜单项，双击该空白框弹出其属性对话框。在菜单属性栏输入“</font><font FACE="Times New Roman" SIZE="3">&amp;Test</font><font SIZE="3">”字样。然后在</font><font FACE="Times New Roman" SIZE="3">Test</font><font SIZE="3">弹出菜单下加入以下四个菜单项，并在</font><font FACE="Times New Roman" SIZE="3">&amp;Say Hello</font><font SIZE="3">菜单下加入一个分隔符。菜单项属性设置如下表：</font></p>
    <div align="center"><center><table BORDER="1" CELLSPACING="2" BORDERCOLOR="#7F7F7F" CELLPADDING="1" WIDTH="346" height="177">
      <tr>
        <td WIDTH="22%" height="35"><font SIZE="3">菜单名</font></td>
        <td WIDTH="43%" height="35"><font SIZE="3">菜单</font><font FACE="Times New Roman" SIZE="3">ID</font></td>
        <td WIDTH="35%" height="35"><font SIZE="3">菜单提示</font><font FACE="Times New Roman" SIZE="3">(Prompt)</font></td>
      </tr>
      <tr>
        <td WIDTH="22%" height="38"><font FACE="Times New Roman" SIZE="3">Say &amp;Hello</font></td>
        <td WIDTH="43%" height="38"><p align="left"><font FACE="Times New Roman" SIZE="3">ID_SAY_HELLO</font></td>
        <td WIDTH="35%" height="38"><font FACE="Times New Roman" SIZE="3">Say hello to you!</font></td>
      </tr>
      <tr>
        <td WIDTH="22%" height="17"><font FACE="Times New Roman" SIZE="3">&amp;Red</font></td>
        <td WIDTH="43%" height="17"><font FACE="Times New Roman" SIZE="3">ID_SELECT_RED</font></td>
        <td WIDTH="35%" height="17"><font FACE="Times New Roman" SIZE="3">The color is red.</font></td>
      </tr>
      <tr>
        <td WIDTH="22%" height="19"><font FACE="Times New Roman" SIZE="3">&amp;Blue</font></td>
        <td WIDTH="43%" height="19"><font FACE="Times New Roman" SIZE="3">ID_SELECT_BLUE</font></td>
        <td WIDTH="35%" height="19"><font FACE="Times New Roman" SIZE="3">The color is blue.</font></td>
      </tr>
      <tr>
        <td WIDTH="22%" height="38"><font FACE="Times New Roman" SIZE="3">&amp;Yellow</font></td>
        <td WIDTH="43%" height="38"><font FACE="Times New Roman" SIZE="3">ID_SELECT_YELLOW</font></td>
        <td WIDTH="35%" height="38"><font FACE="Times New Roman" SIZE="3">The color is yellow.</font></td>
      </tr>
    </table>
    </center></div><p>　</p>
    <font SIZE="3"><b><div align="center"><center><table border="2" cellpadding="2" cellspacing="0" width="90%" bgcolor="#D0D0D0">
      <tr>
        <td width="100%"></b>提示：如果菜单中要使用中文，则除了在菜单名一项中输入中文外，还要将菜单资源的语言属性设置为中文。方法是：鼠标右键单击资源视图的菜单资源</font><font FACE="Times New Roman" SIZE="3">IDR_MAINFRAME</font><font SIZE="3">，弹出快捷菜单，选择</font><font FACE="Times New Roman" SIZE="3">Properties</font><font SIZE="3">，弹出整个菜单资源的属性对话框，如图</font><font FACE="Times New Roman" SIZE="3">3-12</font><font SIZE="3">所示。在</font><font FACE="Times New Roman" SIZE="3">Languages</font><font SIZE="3">下拉列表框中选择</font><font FACE="Times New Roman" SIZE="3">Chinese (P.R.C.)</font><font SIZE="3">。这样以后菜单就可以正确使用和显示中文了。如果其他资源如对话框或字符串要使用中文，也要将该资源的语言属性改为</font><font FACE="Times New Roman" SIZE="3">Chinese(P.R.C)</font><font SIZE="3">。</font></td>
      </tr>
    </table>
    </center></div><p ALIGN="JUSTIFY"><font SIZE="3">　</font><font FACE="Times New Roman" SIZE="3"></p>
    <p align="center"></font><img src="T3_12.gif" tppabs="http://www.lzu.edu.cn/netteach/jiaochen/vc++5.0/vc++5.0/chap3/T3_12.gif" alt="T3_12.tif (107259 bytes)" WIDTH="526" HEIGHT="186"><font FACE="Times New Roman" SIZE="3"></p>
    <p align="center"></font><font size="2">图</font><small><font FACE="Times New Roman" SIZE="3">3.12 </font></small><font size="2">设置菜单语言属性</font><font FACE="Times New Roman" SIZE="3"></p>
    <p></font><font SIZE="3">现在关闭菜单编辑器窗口。我们要为</font><font FACE="Times New Roman" SIZE="3">Say Hello</font><font SIZE="3">菜单增加一个加速键</font><font FACE="Times New Roman" SIZE="3">CTRL+H</font><font SIZE="3">。要编辑加速键，选择</font><font FACE="Times New Roman" SIZE="3">Accelerator</font><font SIZE="3">资源类型，双击打开</font><font FACE="Times New Roman" SIZE="3">IDR_MAINFRAME</font><font SIZE="3">加速键资源。要删除加速键，可以直接按</font><font FACE="Times New Roman" SIZE="3">Del</font><font SIZE="3">键。要增加加速键，可以按</font><font FACE="Times New Roman" SIZE="3">Ins</font><font SIZE="3">键，弹出加速键属性对话框。在</font><font FACE="Times New Roman" SIZE="3">ID</font><font SIZE="3">下拉列表框中选择</font><font FACE="Times New Roman" SIZE="3">ID_SAY_HELLO</font><font SIZE="3">，在</font><font FACE="Times New Roman" SIZE="3">Key</font><font SIZE="3">一栏中输入</font><font FACE="Times New Roman" SIZE="3">H</font><font SIZE="3">，完成加速键设置。关闭加速键编辑窗口。</font><font FACE="Times New Roman" SIZE="3"><b></p>
    <p></b></font><font color="#3973DE" FACE="Times New Roman" SIZE="3">3.6.2 </font><font color="#3973DE"><font SIZE="3">用</font><font FACE="Times New Roman" SIZE="3">ClassWizard</font><font SIZE="3">自动映射菜单消息和成员函数</font></font><font FACE="Times New Roman" SIZE="3"></p>
    <p></font><font SIZE="3">现在我们用</font><font FACE="Times New Roman" SIZE="3">ClassWizard</font><font SIZE="3">为上面创建的几个菜单生成和映射消息处理成员函数。在此之前我们首先介绍一下</font><font FACE="Times New Roman" SIZE="3">ClassWizard</font><font SIZE="3">的用法。<b></p>
    <p></b></font><font color="#3973DE" SIZE="3">用</font><font color="#3973DE"><font FACE="Times New Roman" SIZE="3">ClassWizard</font><font SIZE="3">管理类和</font><font FACE="Times New Roman" SIZE="3">Windows</font><font SIZE="3">消息</font></font><font FACE="Times New Roman" SIZE="3"></p>
    <p>ClassWizard</font><font SIZE="3">有助于创建</font><font FACE="Times New Roman" SIZE="3">Windows</font><font SIZE="3">消息和命令处理函数、创建和管理类、创建类成员变量、创建</font><font FACE="Times New Roman" SIZE="3">OLE Automation</font><font SIZE="3">的方法和属性、创建数据库类以及其他一些工作。</font><font FACE="Times New Roman" SIZE="3"></p>
    <p>ClassWizard</font><font SIZE="3">也有助于覆盖</font><font FACE="Times New Roman" SIZE="3">MFC</font><font SIZE="3">类中的虚函数。先选类，再选择需要覆盖的虚函数。该过程的其余部分与消息处理是类似的。<b></p>
    <p></b></font><font color="#3973DE" SIZE="3">启动</font><font color="#3973DE"><font FACE="Times New Roman" SIZE="3">ClassWizard</font><font SIZE="3">应用程序</font></font><font FACE="Times New Roman" SIZE="3"></p>
    <p ALIGN="JUSTIFY"></font><font SIZE="3">从</font><font FACE="Times New Roman" SIZE="3">View</font><font SIZE="3">菜单或源程序编辑窗口右键菜单中选择</font><font FACE="Times New Roman" SIZE="3">ClassWizard</font><font SIZE="3">（快捷键：</font><font FACE="Times New Roman" SIZE="3">Ctrl +W</font><font SIZE="3">），</font><font FACE="Times New Roman" SIZE="3">Developer Studio</font><font SIZE="3">将弹出</font><font FACE="Times New Roman" SIZE="3">MFC ClassWizard</font><font SIZE="3">对话框。该对话框包含几个标签页，提供以下选项：</font><font FACE="Times New Roman" SIZE="3"></p>
    <blockquote>
      <p>Message Maps</font><font SIZE="3">：它管理消息和成员函数之间的映射关系。</p>
      </font><font FACE="Times New Roman" SIZE="3"><p>Member Variables</font><font SIZE="3">：它可以让用户加进一些数据成员，以便和各种控制进行数据交换。</p>
      </font><font FACE="Times New Roman" SIZE="3"><p>Automations</font><font SIZE="3">：它提供了各种特性支持</font><font FACE="Times New Roman" SIZE="3">OLE2.0</font><font SIZE="3">，包括为</font><font FACE="Times New Roman" SIZE="3">OLE Automation</font><font SIZE="3">增加属性、方法以及处理事件。</p>
      </font><font FACE="Times New Roman" SIZE="3"><p>ActiveX Events</font><font SIZE="3">：为</font><font FACE="Times New Roman" SIZE="3">ActiveX</font><font SIZE="3">控件增加属性、方法以及为</font><font FACE="Times New Roman" SIZE="3">ActiveX</font><font SIZE="3">控件事件增加处理函数。</p>
      </font><font FACE="Times New Roman" SIZE="3"><p>Class Info</font><font SIZE="3">：它可以让用户创建新类，以便支持对话框和各种可视类（包括控制、窗口等）。还可以从类库文件导入类到当前工程中。</p>
      </font><font FACE="Times New Roman" SIZE="3">
    </blockquote>
    <p></font><font SIZE="3">在这一章里，我们只用到</font><font FACE="Times New Roman" SIZE="3">Message Maps</font><font SIZE="3">这一页，因此我们在这里只介绍</font><font FACE="Times New Roman" SIZE="3">Message Maps</font><font SIZE="3">的使用。</font><font FACE="Times New Roman" SIZE="3"><b></p>
    <p></b></font><font color="#3973DE" FACE="Times New Roman" SIZE="3">Message Maps</font><font color="#3973DE" SIZE="3">选项</font><font FACE="Times New Roman" SIZE="3"></p>
    <p ALIGN="JUSTIFY"></font><font SIZE="3">可以让用户加入成员函数来处理消息，删除成员函数以及对成员函数进行编辑。</font><font FACE="Times New Roman" SIZE="3"></p>
    <p ALIGN="JUSTIFY">Message Maps</font><font SIZE="3">页包括如下控制选项：</font><font FACE="Times New Roman" SIZE="3"></p>
    <p ALIGN="JUSTIFY"></font><font SIZE="3">　</font><font FACE="Times New Roman" SIZE="3"></p>
    <blockquote>
      <b><p>Projects</font><font SIZE="3">组合框</b>：允许用户选择当前工作区中包含的工程。</p>
      </font><b><font FACE="Times New Roman" SIZE="3"><p>Class Name</font><font SIZE="3">组合框</b>：允许用户选择当前工程中的类。</p>
      </font><b><font FACE="Times New Roman" SIZE="3"><p>Objects IDs</font><font SIZE="3">列表框</b>：列出当前选中的类名及相关的</font><font FACE="Times New Roman" SIZE="3">ID</font><font SIZE="3">。对窗口和视来说，这些</font><font FACE="Times New Roman" SIZE="3">ID</font><font SIZE="3">为菜单标识符；对对话框来说，这些</font><font FACE="Times New Roman" SIZE="3">ID</font><font SIZE="3">为控制框的</font><font FACE="Times New Roman" SIZE="3">ID</font><font SIZE="3">。</p>
      </font><b><font FACE="Times New Roman" SIZE="3"><p>Messages</font><font SIZE="3">列表框</b>：列出当前所选类的可重载的虚方法以及可接收到的消息。</p>
      </font><b><font FACE="Times New Roman" SIZE="3"><p>Member Functions</font><font SIZE="3">列表框</b>：列出</font><font FACE="Times New Roman" SIZE="3">ClassName</font><font SIZE="3">组合框中当前所选的项中所包含的所有成员函数。用户可以增加、删除成员函数，也可以对成员函数进行编辑。</p>
      </font><b><font FACE="Times New Roman" SIZE="3"><p>Add Class...</font><font SIZE="3">按钮</b>：它允许用户往工程里添加新类。在按钮右边有一个向下的小箭头，表明按此按钮将弹出一个菜单。菜单包含两项：</font><font FACE="Times New Roman" SIZE="3">New...</font><font SIZE="3">可以新建一个类；</font><font FACE="Times New Roman" SIZE="3">From a type Lib</font><font SIZE="3">用于从一个类库中导入类。</p>
      </font><b><font FACE="Times New Roman" SIZE="3"><p>Add Function</font><font SIZE="3">按钮</b>：它允许用户往</font><font FACE="Times New Roman" SIZE="3">Member Functions</font><font SIZE="3">列表框中加进一个新的消息处理成员函数，该新增成员函数被用来响应</font><font FACE="Times New Roman" SIZE="3">Message Maps</font><font SIZE="3">列表中当前所选中的消息。</p>
      </font><b><font FACE="Times New Roman" SIZE="3"><p>Delete Function</font><font SIZE="3">按钮</b>：用于删除</font><font FACE="Times New Roman" SIZE="3">Member Functions</font><font SIZE="3">列表框中所选中的项。</p>
      </font><b><font FACE="Times New Roman" SIZE="3"><p>Edit Code</font><font SIZE="3">按钮</b>：它允许用户对</font><font FACE="Times New Roman" SIZE="3">Member Functions</font><font SIZE="3">中所选中的项进行编辑，此时</font><font FACE="Times New Roman" SIZE="3">Visual Studio </font><font SIZE="3">将关闭</font><font FACE="Times New Roman" SIZE="3">MFC ClassWizard</font><font SIZE="3">对话框，并打开相应文件，并将光标定位在函数定义的开头处。</p>
      </font><font FACE="Times New Roman" SIZE="3">
    </blockquote>
    <p align="center"></font><img src="T3_13.gif" tppabs="http://www.lzu.edu.cn/netteach/jiaochen/vc++5.0/vc++5.0/chap3/T3_13.gif" alt="T3_13.tif (369325 bytes)" WIDTH="553" HEIGHT="362"><font FACE="Times New Roman" SIZE="3"></p>
    <p align="center"></font><font size="2">图</font><small><font FACE="Times New Roman" SIZE="3">3-13 </font></small><font size="2">用</font><small><font FACE="Times New Roman" SIZE="3">ClassWizard</font></small><font size="2">增加菜单消息成员函数映射</font><font FACE="Times New Roman" SIZE="3"></p>
    <p ALIGN="JUSTIFY"></font><font SIZE="3">现在我们就利用</font><font FACE="Times New Roman" SIZE="3">ClassWizard</font><font SIZE="3">为</font><font FACE="Times New Roman" SIZE="3">Hello</font><font SIZE="3">程序增加菜单消息和成员函数的映射。在</font><font FACE="Times New Roman" SIZE="3">View</font><font SIZE="3">菜单下选择</font><font FACE="Times New Roman" SIZE="3">ClassWizard</font><font SIZE="3">，弹出</font><font FACE="Times New Roman" SIZE="3">MFC ClassWizard</font><font SIZE="3">对话框。选择</font><font FACE="Times New Roman" SIZE="3">Message Maps</font><font SIZE="3">页，在</font><font FACE="Times New Roman" SIZE="3">Class Name</font><font SIZE="3">下拉列表中选择</font><font FACE="Times New Roman" SIZE="3">CMainFrame</font><font SIZE="3">类。在</font><font FACE="Times New Roman" SIZE="3">Object IDs</font><font SIZE="3">中选择</font><font FACE="Times New Roman" SIZE="3">ID_SAY_HELLO</font><font SIZE="3">，在</font><font FACE="Times New Roman" SIZE="3">Messages</font><font SIZE="3">栏中双击</font><font FACE="Times New Roman" SIZE="3">COMMAND</font><font SIZE="3">，弹出</font><font FACE="Times New Roman" SIZE="3">Add Member Function</font><font SIZE="3">对话框。对话框中给出缺省的成员函数</font><font FACE="Times New Roman" SIZE="3">OnSayHello</font><font SIZE="3">，按</font><font FACE="Times New Roman" SIZE="3">OK</font><font SIZE="3">接收缺省的成员函数名。此时</font><font FACE="Times New Roman" SIZE="3">OnSayHello </font><font SIZE="3">成员函数就出现在</font><font FACE="Times New Roman" SIZE="3">Member Functions</font><font SIZE="3">列表框中，后面跟所映射的消息，如图</font><font FACE="Times New Roman" SIZE="3">3-13</font><font SIZE="3">所示。列表框中开头的字母</font><font FACE="Times New Roman" SIZE="3">W</font><font SIZE="3">表示窗口消息，</font><font FACE="Times New Roman" SIZE="3">V</font><font SIZE="3">表示可重载的虚方法</font><font FACE="Times New Roman" SIZE="3">(Virtual Method)</font><font SIZE="3">。如此，依次为</font><font FACE="Times New Roman" SIZE="3">ID_SELECT_BLUE</font><font SIZE="3">、</font><font FACE="Times New Roman" SIZE="3">ID_SELECT_RED</font><font SIZE="3">、</font><font FACE="Times New Roman" SIZE="3">ID_SELECT_YELLOW</font><font SIZE="3">增加消息处理成员函数</font><font FACE="Times New Roman" SIZE="3">OnSelectBlue</font><font SIZE="3">、</font><font FACE="Times New Roman" SIZE="3">OnSelectRed</font><font SIZE="3">、</font><font FACE="Times New Roman" SIZE="3">OnSelectYellow</font><font SIZE="3">。然后双击</font><font FACE="Times New Roman" SIZE="3">Member Functions</font><font SIZE="3">列表中的</font><font FACE="Times New Roman" SIZE="3">OnSayHello</font><font SIZE="3">，编辑</font><font FACE="Times New Roman" SIZE="3">OnSayHello</font><font SIZE="3">成员函数。</font><font FACE="Times New Roman" SIZE="3"><b></p>
    <p></b></font><font color="#3973DE" FACE="Times New Roman" SIZE="3">3.6.3 </font><font SIZE="3" color="#3973DE">手工添加代码</font><font FACE="Times New Roman" SIZE="3"></p>
    <p></font><font SIZE="3">在</font><font FACE="Times New Roman" SIZE="3">OnSayHello</font><font SIZE="3">成员函数体中加入语句。</font><font FACE="Times New Roman" SIZE="3"></p>
    <p>void CMainFrame::OnSayHello()</p>
    <p>{</p>
    <p></font><b><font SIZE="3">　</font><font FACE="Times New Roman" SIZE="3"></p>
    <p>AfxMessageBox(</font><font SIZE="3">“</font><font FACE="Times New Roman" SIZE="3">Hello!</font><font SIZE="3">”</font><font FACE="Times New Roman" SIZE="3">);</b></p>
    <p>}</font><font SIZE="3"><b></p>
    <p>消息框函数</b></font><font FACE="Times New Roman" SIZE="3"></p>
    <p>AfxMessageBox</font><font SIZE="3">用来弹出一个消息框，它的函数原型有两种版本：</font><font FACE="Times New Roman" SIZE="3"></p>
    <blockquote>
      <blockquote>
        <p>int AfxMessageBox( LPCTSTR lpszText, UINT nType = MB_OK, UINT nIDHelp = 0 );</p>
      </blockquote>
    </blockquote>
    <p></font><font SIZE="3">　</font><font FACE="Times New Roman" SIZE="3"></p>
    <blockquote>
      <blockquote>
        <p>int AFXAPI AfxMessageBox( UINT nIDPrompt, UINT nType = MB_OK, UINT nIDHelp = (UINT) </font><font SIZE="3">C</font><font FACE="Times New Roman" SIZE="3">1 );</p>
        </font>
      </blockquote>
    </blockquote>
    <p><font SIZE="3">　</p>
    <p>在第一种形式中，lpszText表示在消息框内部显示的文本，消息框的标题为应用程序的可执行文件名（如Hello）。在第二种形式中，nIDPrompt为要显示的文本字符串在字符串表中的ID。函数调用时会自动从字符串表中载入字符串并显示在消息框中。nType为消息框中显示的按钮风格和图标风格的组合，可以采用|（或）操作符组合各种风格。</p>
    <p>按钮风格</p>
    <blockquote>
      <blockquote>
        </font><font FACE="Arial" SIZE="2"><b><p>MB_ABORTRETRYIGNORE </b></font><font SIZE="3">消息框中显示</font><font FACE="Times New Roman" SIZE="3">Abort</font><font SIZE="3">、</font><font FACE="Times New Roman" SIZE="3">Retry</font><font SIZE="3">、</font><font FACE="Times New Roman" SIZE="3">Ignore</font><font SIZE="3">按钮</p>
        </font><font FACE="Arial" SIZE="2"><b><p>MB_OK </b></font><font SIZE="3">显示OK按钮</p>
        </font><font FACE="Arial" SIZE="2"><b><p>MB_OKCANCEL </b></font><font SIZE="3">显示OK、Cancel按钮</p>
        </font><font FACE="Arial" SIZE="2"><b><p>MB_RETRYCANCEL </b></font><font SIZE="3">显示Retry、Cancel按钮</p>
        </font><font FACE="Arial" SIZE="2"><b><p>MB_YESNO </b></font><font SIZE="3">显示Yes、No按钮</p>
        </font><font FACE="Arial" SIZE="2"><b><p>MB_YESNOCANCEL </b></font><font SIZE="3">显示Yes、No、Cancel按钮</p>
        <p>图标风格</p>
        <b><p>MB_ICONINFORMATION</b> 显示一个i图标，表示提示</p>
        <b><p>MB_ICONEXCLAMATION</b> 显示一个惊叹号，表示警告</p>
        <b><p>MB_ICONSTOP </b>显示手形图标，表示警告或严重错误</p>
        <b><p>MB_ICONQUESTION </b>显示问号图标，表示疑问</p>
      </blockquote>
    </blockquote>
    <p>比如，要在消息框中显示一个问号、一个“Yes”按钮、一个“No”按钮，可以以下面的方式调用AfxMessageBox。</p>
    <p>AfxMessageBox(“Are you sure?”，MB_YESNO|MB_ICONQUESTION）；</p>
    <blockquote>
      <blockquote>
        <p>还有一个与AfxMessageBox类似的函数MessageBox，它是CWnd的类成员函数：</p>
        </font><font FACE="Times New Roman" SIZE="3"><p>int MessageBox( LPCTSTR lpszText,LPCTSTR 
        lpszCaption = NULL,</p>
        <p>UINT nType = MB_OK );</font></p>
      </blockquote>
    </blockquote>
    <p><font SIZE="3"><b>　</p>
    <p></b>与</font><font FACE="Times New Roman" SIZE="3">AfxMessageBox</font><font SIZE="3">不同的是，它多了一个</font><font FACE="Times New Roman" SIZE="3">lpszCaption</font><font SIZE="3">参数，从名字上就可以推断出它表示消息框的标题，这样就可以设置消息框的标题，而不必采用可执行文件名作为标题了。</p>
    <p>两个函数的区别：</font><font FACE="Times New Roman" SIZE="3">AfxMessageBox</font><font SIZE="3">比</font><font FACE="Times New Roman" SIZE="3">MessageBox</font><font SIZE="3">简单一些，因为它是一个全局函数所以不需要对应的一个窗口类，但是不能控制消息框标题，常用于调试程序时的内部数据输出或警告；MessageBox比较正式，常用在要提交的应用程序版本中，可以控制标题内容而不必采用含义不明的可执行文件名为标题。</p>
    <p>现在再来编写</font><font FACE="Times New Roman" SIZE="3">OnSelectRed</font><font SIZE="3">、</font><font FACE="Times New Roman" SIZE="3">OnSelectBlue</font><font SIZE="3">、</font><font FACE="Times New Roman" SIZE="3">OnSelectYellow</font><font SIZE="3">三个函数。首先我们双击CMainFrame类名，在MainFrm.h中加入数据成员，如下所示：</p>
    <p></font><font FACE="Times New Roman" SIZE="3">class CMainFrame:public CFrameWnd{</p>
    <p>...</p>
    <p>// Attributes</p>
    <p>public:</p>
    <p></font><b><font SIZE="3">　</font><font FACE="Times New Roman" SIZE="3"></p>
    <p>int m_nColor;</p>
    <p>enum{RED=0,BLUE=1,YELLOW=2};</b></p>
    <p>...</p>
    <p></font><b><font SIZE="3">　</font><font FACE="Times New Roman" SIZE="3"></p>
    <p></b>}</font><font SIZE="3"></p>
    <p>注意我们这里使用了匈牙利命名法，建议读者也采用这种命名方法，以便提高程序可读性。加入数据成员后，还要对它进行初始化，初始化工作在CMainFrame()构造函数中完成。</p>
    <p>CMainFrame::CMainFrame()</p>
    <p>{</p>
    <p><b>　</p>
    <p>m_nColor=RED;</b></p>
    <p>}</p>
    <p>OnSelectRed、OnSelectBlue、OnSelectYellow三个函数修改后如清单3.4：</p>
    <p><b>　</p>
    <p>清单3.4</b></p>
    <p>void CMainFrame()::OnSelectRed()</p>
    <p>{</p>
    <p><b>　</p>
    <p>m_nColor=RED;</p>
    <p>SayColor();</b></p>
    <p>}</p>
    <p>void CMainFrame()::OnSelectBlue()</p>
    <p>{</p>
    <p><b>　</p>
    <p>m_nColor=BLUE;</p>
    <p>SayColor();</b></p>
    <p>}</p>
    <p>　</p>
    <p>void CMainFrame()::OnSelectYellow()</p>
    <p>{</p>
    <p><b>　</p>
    <p>m_nColor=YELLOW;</p>
    <p>SayColor();</b></p>
    <p>}</p>
    <p>　</p>
    <p>然后在MainFrm.h中加入SayColor()函数的声明：</p>
    <p>//Operations</p>
    <p>public:</p>
    <p><b>　</p>
    <p>void SayColor();</b></p>
    <p>在MainFrm.cpp中，在OnSelectYellow()成员函数后面，手工加入SayColor()函数的定义。</p>
    <p><b>　</p>
    <p>void CMainFrame::SayColor()</p>
    <p>{</p>
    <p>switch(m_nColor)</p>
    <p>{</p>
    <p>case RED:</p>
    <p>AfxMessageBox(“Color is red!”);</p>
    <p>break;</p>
    <p>case BLUE:</p>
    <p>AfxMessageBox(“Color is blue!”);</p>
    <p>break;</p>
    <p>case YELLOW:</p>
    <p>AfxMessageBox(“Color is yellow!”);</p>
    <p>break;</p>
    <p>}</p>
    <p>}</b></p>
    <p>这样，当我们选择颜色时，就会显示不同的消息框显示当前选择的颜色。但是用消息框显示当前选中的颜色似乎太繁琐了一些。我们在使用WORD编写文档时，注意到在选择不同的视图时，在视图菜单名前显示一个点，表明这是当前选择的视图。我们是否也可以这么做？回答是肯定的。要实现这一功能，就要使用MFC框架的更新命令用户接口消息机制。</font><font FACE="Times New Roman" SIZE="3"><b></p>
    </b></font><div align="center"><center><table border="0" cellpadding="0" cellspacing="0" width="615">
      <tr>
        <td><a href="chap3_5.htm" tppabs="http://www.lzu.edu.cn/netteach/jiaochen/vc++5.0/vc++5.0/chap3/chap3_5.htm">上一页</a></td>
        <td><p align="right"><a href="chap3_7.htm" tppabs="http://www.lzu.edu.cn/netteach/jiaochen/vc++5.0/vc++5.0/chap3/chap3_7.htm">下一页</a></td>
      </tr>
    </table>
    </center></div><font SIZE="5"><hr noshade color="#3973DE" size="1">
    <p align="center"></font><font size="2" color="#000000">本教程由<a href="javascript:if(confirm('http://vcdynasty.yeah.net/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://vcdynasty.yeah.net/'" tppabs="http://vcdynasty.yeah.net/">Visual C++王朝（Where programmers come together）</a>协助制作<br>
    未经许可，请勿以任何形式复制</font></td>
    <b>
  </tr>
</table>
</center></div>

<p ALIGN="CENTER"></b><font SIZE="5">　</font><font FACE="Times New Roman" SIZE="5"></p>
</font><font FACE="Times New Roman" SIZE="3">

<p></font><b><font SIZE="3">　</font><font FACE="Times New Roman" SIZE="3"></p>
</font></b>

<p><font SIZE="3">　</font><font FACE="Times New Roman" SIZE="3"></p>

<p></font>　</p>
</body>
</html>
