<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=gb_2312-80">
<META NAME="Generator" CONTENT="Microsoft Word 97">
<TITLE>目    录</TITLE>
</HEAD>
<BODY>

<FONT FACE="黑体" LANG="ZH-CN" SIZE=5><P ALIGN="CENTER">前</FONT><FONT FACE="Arial" SIZE=5>  </FONT><FONT FACE="黑体" LANG="ZH-CN" SIZE=5>言</P>
</FONT><FONT SIZE=3><P ALIGN="JUSTIFY">Visual C++</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>是开发运行于</FONT><FONT SIZE=3>Windows 95</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>和</FONT><FONT SIZE=3>Windows NT</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>环境下的</FONT><FONT SIZE=3>Win32</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>应用程序的可视化编程工具中最重要的成员之一，它为软件开发人员提供了完整的编辑、编译和调试工具和建立于</FONT><FONT SIZE=3>Win32 API</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>（</FONT><FONT SIZE=3>Application Programming Interface</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>）基础上的</FONT><FONT SIZE=3>MFC</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>类库（</FONT><FONT SIZE=3>Microsoft Foundation Class Library</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>），从而有效的缩短了</FONT><FONT SIZE=3>Windows</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>应用程序的开发周期。</FONT><FONT SIZE=3>Windows</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>操作系统本身大部分是使用</FONT><FONT SIZE=3>C/C++</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>语言写成的，而</FONT><FONT SIZE=3>Visual C++</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>正是使用</FONT><FONT SIZE=3>C/C++</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>语言的</FONT><FONT SIZE=3>Win32</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>应用程序集成开发环境，因此，使用</FONT><FONT SIZE=3>Visual C++</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>来进行</FONT><FONT SIZE=3>Windows</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>应用程序的开发便有着得天独厚的优势，学习和掌握</FONT><FONT SIZE=3>Visual C++</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>，也自然地就成为了广大程序设计和开发人员的迫切需要。</P>
<P ALIGN="JUSTIFY">然而，尽管</FONT><FONT SIZE=3>Visual C++</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>使用了</FONT><FONT SIZE=3>C/C++</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>语言，由于</FONT><FONT SIZE=3>Windows</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>应用程序和过去所熟悉的</FONT><FONT SIZE=3>DOS</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>程序在运行机制上的不同，以及可视化编程工具和常规的程序开发语言在使用上的差异，再加上</FONT><FONT SIZE=3>Visual C++</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>本身的博大精深，以至于不少由普通的</FONT><FONT SIZE=3>C</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>或</FONT><FONT SIZE=3>C++</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>语言转移到</FONT><FONT SIZE=3>Visual C++</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>开发环境的程序开发人员感到不适应。本书以具有</FONT><FONT SIZE=3>C/C++</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>语言基础的读者为对象，深入浅出地阐述使用</FONT><FONT SIZE=3>Visual C++</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>进行程序开发所需要的基本知识和技巧。</P>
<P ALIGN="JUSTIFY">全书共分为十三章，涵盖了三个部分的内容：</P>
<P ALIGN="JUSTIFY">第一部分包括第一章到第三章。这一部分介绍了使用</FONT><FONT SIZE=3>Visual C++</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>进行</FONT><FONT SIZE=3>Windows</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>程序开发的必备知识，其中</P>
<P ALIGN="JUSTIFY">第一章：“</FONT><FONT SIZE=3>Visual C++</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>简介”介绍了</FONT><FONT SIZE=3>Visual C++ 5.0</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>的新增特性，</FONT><FONT SIZE=3>Microsoft Developer Studio</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>集成开发环境的使用和定制，以及如何从</FONT><FONT SIZE=3>Visual C++ 5.0</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>的在线文档中获得所需的资料和信息。通过这一章，读者可以对</FONT><FONT SIZE=3>Visual C++</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>及其所使用的集成开发环境有一个大致的了解，以为使用</FONT><FONT SIZE=3>Visual C++</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>开发应用程序打下必要的基础。</P>
<P ALIGN="JUSTIFY">第二章：“面向对象编程与</FONT><FONT SIZE=3>C++</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>语言”试图分析和介绍一些在使用</FONT><FONT SIZE=3>C++</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>语言进行面向对象的程序开发的过程中所常见的问题，而不是对</FONT><FONT SIZE=3>C++</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>语言的完整的讲述。在这一章中，我们旨在通过指出一些可能引起程序出错的语言问题，来避免读者的编程的过程中犯同样的错误。</P>
<P ALIGN="JUSTIFY">第三章：“</FONT><FONT SIZE=3>Win32</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>应用程序设计”讲述了使用</FONT><FONT SIZE=3>SDK</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>和</FONT><FONT SIZE=3>API</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>进行</FONT><FONT SIZE=3>32</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>位</FONT><FONT SIZE=3>Windows</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>应用程序设计的基本知识，这些知识是正确理解</FONT><FONT SIZE=3>MFC</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>的工作方式的重要基础。</P>
<P ALIGN="JUSTIFY">第二部分包括第四章到第八章。这一部分介绍了如何使用</FONT><FONT SIZE=3>Visual C++</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>来设计</FONT><FONT SIZE=3>Windows</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>应用程序的用户界面，其中</P>
<P ALIGN="JUSTIFY">第四章：“基于对话框的应用程序”以基于对话框的应用程序为例讲述</FONT><FONT SIZE=3>MFC</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>应用程序框架、应用程序类以及应用程序的消息映射和对话框类等关于</FONT><FONT SIZE=3>MFC</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>的基本概念。</P>
<P ALIGN="JUSTIFY">第五章：“响应用户命令”讲述一般的菜单命令、工具条按钮命令和快捷键命令的响应和处理。此外，我们在本章了也附带讲述了两种</FONT><FONT SIZE=3>Windows</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>控件</FONT><FONT SIZE=3>――</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>滑块控件和进度条的消息处理。</P>
<P ALIGN="JUSTIFY">第六章：“使用</FONT><FONT SIZE=3>Windows</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>标准控件”讲述了几种标准的</FONT><FONT SIZE=3>Windows</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>控件的使用。我们并没有在这一章中涵盖了所有的</FONT><FONT SIZE=3>Windows</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>标准控件，而只是选取了其中一些具有代表性的来讲述，并希望通过它们来阐述使用</FONT><FONT SIZE=3>Windows</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>标准控件的一般方法。</P>
<P ALIGN="JUSTIFY">第七章：“使用</FONT><FONT SIZE=3>ActiveX</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>控件”讲述如何使用新的</FONT><FONT SIZE=3>ActiveX</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>控件来增强应用程序的功能。作为示例，我们使用了功能强大的多媒体控件</FONT><FONT SIZE=3>ActiveMovie</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>来完成了一个可以打开多种媒体文件的视频播放器。</P>
<P ALIGN="JUSTIFY">第八章：“文档</FONT><FONT SIZE=3>/</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>视结构”讲述了如何在基于文档的应用程序中使用</FONT><FONT SIZE=3>MFC</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>的文档</FONT><FONT SIZE=3>/</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>视结构，这种结构通过将文档中数据的维护和与用户的接口相分离，从而使得程序的结构更加合理，更便于维护，同时也便于实现一些有用的特性，如同一文档的多个视的同步更新等。</P>
<P ALIGN="JUSTIFY">第三部分包括第九章到第十三章，在这一部分中，我们挑选了</FONT><FONT SIZE=3>Windows</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>下的一些编程课题来进行了一些一般性的讨论。其中</P>
<P ALIGN="JUSTIFY">第九章：“图形设备接口”讲述了如何通过</FONT><FONT SIZE=3>Windows</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>的设备上下文来使用画笔、刷子及字体等多种绘图对象来进行图形的绘制和输出。在讲述的过程中，我们还介绍了一些很有用的编程技巧，如使用路径和剪辑区域来绘制特殊效果等。</P>
<P ALIGN="JUSTIFY">第十章：“</FONT><FONT SIZE=3>MFC</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>通用类”介绍了</FONT><FONT SIZE=3>MFC</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>通用数据类型，它们包括集合类、字符串类和日期及时间类等。这些通用类使用</FONT><FONT SIZE=3>MFC</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>应用程序的数据管理和使用更加方便。</P>
<P ALIGN="JUSTIFY">第十一章：“异常处理和诊断”介绍了如何处理程序中出现的异常事件和使用</FONT><FONT SIZE=3>MFC</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>的诊断服务来检查程序中的错误，这些方法对于创建健壮的和无错的应用程序十分必要。</P>
<P ALIGN="JUSTIFY">第十二章：“多线程”介绍了</FONT><FONT SIZE=3>32</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>位编程中线程和进程的概念，以及如何充分使用</FONT><FONT SIZE=3>Win32</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>环境下的多任务功能。</P>
<P ALIGN="JUSTIFY">第十三章：“动态链接库”介绍了动态链接库的创建和使用，以及如何使用动态链接库来扩展</FONT><FONT SIZE=3>MFC</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>等。</P>
<P ALIGN="JUSTIFY">熟悉</FONT><FONT SIZE=3>MFC</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>类库的内容和</FONT><FONT SIZE=3>Win32 API</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>中的有关函数是快速高效地进行</FONT><FONT SIZE=3>Win32</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>程序设计的必要条件，然而一般情况下我们不可以记住数千个函数的功能和用法，由于本书篇幅有限，在每一章中也不可能面面俱到。立足于初中级</FONT><FONT SIZE=3>Visual C++</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>编程人员的实际需要，作者在本书中努力介绍一些实用的编程技巧，指出一些大多数人在编程时可能犯的错误，而不是全面的概括性的讲述</FONT><FONT SIZE=3>MFC</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>和</FONT><FONT SIZE=3>Windows</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>程序设计（当然，本书中出于完整性的考虑，仍有少量的这一类的概括性文字）。这本书不是供查阅各个函数和类方法的使用的参考手册，也不是一本</FONT><FONT SIZE=3>C++</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>的教科书，它完全立足于</FONT><FONT SIZE=3>Visual C++</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>的使用者，力图将他们引入编程的乐趣中来。“大而全”不是本书的目的，“少而精”才是我们所力图追求的。我们希望通过本书的学习，不仅能够让一位对</FONT><FONT SIZE=3>Visual C++</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>少有所知的</FONT><FONT SIZE=3>C++</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>程序开发人员学会熟练的使用</FONT><FONT SIZE=3>Visual C++</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>进行</FONT><FONT SIZE=3>Win32</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>应用程序的开发，而且对于初中级</FONT><FONT SIZE=3>Visual C++</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>程序员，也能够从本书中找到一些值得一看的内容。因此，本书可能会对</FONT><FONT SIZE=3>MFC</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>中的一些内容略去不谈，但有时候可能会因为需要实现一些有趣的特性而深入到</FONT><FONT SIZE=3>MFC</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>的内部或者绕过</FONT><FONT SIZE=3>MFC</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>而直接使用</FONT><FONT SIZE=3>Windows API</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>，这些都体现我们在实际编程中所遇到的真实情况</FONT><FONT SIZE=3>――</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>应用程序的需求有可能多种多样，其实现方式也不可能是千篇一律。完整地介绍</FONT><FONT SIZE=3>Visual C++</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>的方方面面不可能同时也不应该是本书的宗旨，本书的任务在于教会读者如何在</FONT><FONT SIZE=3>Visual C++</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>中使用以“我”为中心的方式来开发</FONT><FONT SIZE=3>Windows</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>应用程序。</P>
<P ALIGN="JUSTIFY">在本书中使用的示例代码都进行了精心的选择，细心的进行了编写和调试，这也导致了本书的完稿时间一拖再拖。这里，我要感谢本书的编辑，是他一次又一次的容忍我使用相同的理由来推迟交稿的时间。此外，还需要感谢和我一同具有我正在使用的这台计算机的几位伙伴，是他们我才得以以“独占”方式使用所有的系统资源来完成本书。</P>
<P ALIGN="JUSTIFY">必须感谢两位朋友的帮忙，否则这本书即使推迟交稿也不可能完成。在最后的紧要关头，刘斌编写了本书的第十章、第十一章和第十二章，赵仕健编写了本书的第五章和第八章，此外，他还替我修改了第四章，并增加了一些很有用的内容，可惜的是，他的一些优秀的工作成果，毁于一次意外事故中，在那次意外中，位于硬盘的数据，一夜之间便消失得无影无踪了。</P>
<P ALIGN="JUSTIFY">尽管我们细致的对书中的每一行程序进行了反复的调试，但是仍有可能在最后的一刻还包含着被未被虑及的问题。此外，在将</FONT><FONT SIZE=3>Developer Studio</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>中的过程粘贴到</FONT><FONT SIZE=3>Word</FONT><FONT FACE="宋体" LANG="ZH-CN" SIZE=3>文档的过程中，也有可能出现不该有的笔误（确切的说是敲错了键）和疏漏。我们努力避免发生这种情况，但是，即使它的概率为零仍有可能发生，这就需要读者来批评指正了。</P>
</FONT><FONT FACE="楷体_GB2312" LANG="ZH-CN" SIZE=3><P ALIGN="JUSTIFY"></P><DIR>
<DIR>
<DIR>
<DIR>
<DIR>
<DIR>
<DIR>
<DIR>
<DIR>
<DIR>
<DIR>
<DIR>
<DIR>
<DIR>
<DIR>

</FONT><FONT FACE="楷体_GB2312" LANG="ZH-CN"><P ALIGN="JUSTIFY">作</FONT>  <FONT FACE="楷体_GB2312" LANG="ZH-CN">者</P>
</FONT><FONT FACE="楷体_GB2312" LANG="ZH-CN" SIZE=3><P ALIGN="JUSTIFY">一九九八年七月</P></DIR>
</DIR>
</DIR>
</DIR>
</DIR>
</DIR>
</DIR>
</DIR>
</DIR>
</DIR>
</DIR>
</DIR>
</DIR>
</DIR>
</DIR>
</FONT></BODY>
</HTML>
