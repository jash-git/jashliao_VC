<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>




  
  
  
  
  <link rel="stylesheet" href="stdlayout.css" tppabs="http://caterpillar.onlyfun.net/Gossip/AlgorithmGossip/css/stdlayout.css" type="text/css">




  
  
  
  
  <link rel="stylesheet" href="print.css" tppabs="http://caterpillar.onlyfun.net/Gossip/AlgorithmGossip/css/print.css" type="text/css">




  
  
  
  
  <meta content="text/html; charset=Big5" http-equiv="content-type">




  
  
  
  
  <title>背包問題（Knapsack Problem）</title>
</head>


<body>




<h3><a href="javascript:if(confirm('http://caterpillar.onlyfun.net/Gossip/index.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://caterpillar.onlyfun.net/Gossip/index.html'" tppabs="http://caterpillar.onlyfun.net/Gossip/index.html">From
Gossip@caterpillar</a></h3>




<h1><a href="AlgorithmGossip.htm" tppabs="http://caterpillar.onlyfun.net/Gossip/AlgorithmGossip/AlgorithmGossip.htm">Algorithm Gossip: 背包問題（Knapsack Problem）</a></h1>

<table style="text-align: left; width: 946px; height: 32px;" border="0" cellpadding="0" cellspacing="0">

  <tbody>

    <tr>

      <td style="width: 676px; vertical-align: top;"> 



      <h2> 說明</h2>
      <small>

假設有一個背包的負重最多可達8公斤，而希望在背包中裝入負重範圍內可得之總價物品，假設是水果好了，水果的編號、單價與重量如下所示： </small><br>


      <table border="1" width="50%">


  <tbody>


    <tr>


      <td align="left" valign="top"><small>0 </small></td>


      <td align="left" valign="top"><small>李子 </small></td>


      <td align="left" valign="top"><small>4KG </small></td>


      <td align="left" valign="top"><small>NT$4500 </small></td>


    </tr>


    <tr>


      <td align="left" valign="top"><small>1 </small></td>


      <td align="left" valign="top"><small>蘋果 </small></td>


      <td align="left" valign="top"><small>5KG </small></td>


      <td align="left" valign="top"><small>NT$5700 </small></td>


    </tr>


    <tr>


      <td align="left" valign="top"><small>2 </small></td>


      <td align="left" valign="top"><small>橘子 </small></td>


      <td align="left" valign="top"><small>2KG </small></td>


      <td align="left" valign="top"><small>NT$2250 </small></td>


    </tr>


    <tr>


      <td align="left" valign="top"><small>3 </small></td>


      <td align="left" valign="top"><small>草莓 </small></td>


      <td align="left" valign="top"><small>1KG </small></td>


      <td align="left" valign="top"><small>NT$1100 </small></td>


    </tr>


    <tr>


      <td align="left" valign="top"><small>4 </small></td>


      <td align="left" valign="top"><small>甜瓜 </small></td>


      <td align="left" valign="top"><small>6KG </small></td>


      <td align="left" valign="top"><small>NT$6700 </small></td>


    </tr>


  
  
        </tbody>
      </table>


      <p></p>


      <h2> 解法</h2>
      <small>

背包問題是關於最佳化的問題，要解最佳化問題可以使用「動態規劃」（Dynamic
programming），從空集合開始，每增加一個元素就先求出該階段的最佳解，直到所有的元素加入至集合中，最後得到的就是最佳解。 <br>
      <br>

以背包問題為例，我們使用兩個陣列value與item，value表示目前的最佳解所得之總價，item表示最後一個放至背包的水果，假設有負重量
1∼8的背包8個，並對每個背包求其最佳解。 <br>
      <br>

逐步將水果放入背包中，並求該階段的最佳解：<br>
      </small>





      <ul>
        <li><small> 放入李子</small>
  </li>
      </ul>


      <table border="1" width="50%">


  <tbody>


    <tr>


      <td align="left" valign="top"><small>背包負重 </small></td>


      <td align="left" valign="top"><small>1 </small></td>


      <td align="left" valign="top"><small>2 </small></td>


      <td align="left" valign="top"><small>3 </small></td>


      <td align="left" valign="top"><small>4 </small></td>


      <td align="left" valign="top"><small>5 </small></td>


      <td align="left" valign="top"><small>6 </small></td>


      <td align="left" valign="top"><small>7 </small></td>


      <td align="left" valign="top"><small>8 </small></td>


    </tr>


    <tr>


      <td align="left" valign="top"><small>value </small></td>


      <td align="left" valign="top"><small>０ </small></td>


      <td align="left" valign="top"><small>０ </small></td>


      <td align="left" valign="top"><small>０ </small></td>


      <td align="left" valign="top"><small>4500 </small></td>


      <td align="left" valign="top"><small>4500 </small></td>


      <td align="left" valign="top"><small>4500 </small></td>


      <td align="left" valign="top"><small>4500 </small></td>


      <td align="left" valign="top"><small>9000 </small></td>


    </tr>


    <tr>


      <td align="left" valign="top"><small>item </small></td>


      <td align="left" valign="top"><small>－ </small></td>


      <td align="left" valign="top"><small>－ </small></td>


      <td align="left" valign="top"><small>－ </small></td>


      <td align="left" valign="top"><small>０ </small></td>


      <td align="left" valign="top"><small>０ </small></td>


      <td align="left" valign="top"><small>０ </small></td>


      <td align="left" valign="top"><small>０ </small></td>


      <td align="left" valign="top"><small>０ </small></td>


    </tr>


  
  
        </tbody>
      </table>


      <br>


      <ul>
        <li><small> 放入蘋果</small>
  </li>
      </ul>


      <table border="1" width="50%">


  <tbody>


    <tr>


      <td align="left" valign="top"><small>背包負重 </small></td>


      <td align="left" valign="top"><small>1 </small></td>


      <td align="left" valign="top"><small>2 </small></td>


      <td align="left" valign="top"><small>3 </small></td>


      <td align="left" valign="top"><small>4 </small></td>


      <td align="left" valign="top"><small>5 </small></td>


      <td align="left" valign="top"><small>6 </small></td>


      <td align="left" valign="top"><small>7 </small></td>


      <td align="left" valign="top"><small>8 </small></td>


    </tr>


    <tr>


      <td align="left" valign="top"><small>value </small></td>


      <td align="left" valign="top"><small>０ </small></td>


      <td align="left" valign="top"><small>０ </small></td>


      <td align="left" valign="top"><small>０ </small></td>


      <td align="left" valign="top"><small>4500 </small></td>


      <td align="left" valign="top"><small>5700 </small></td>


      <td align="left" valign="top"><small>5700 </small></td>


      <td align="left" valign="top"><small>5700 </small></td>


      <td align="left" valign="top"><small>9000 </small></td>


    </tr>


    <tr>


      <td align="left" valign="top"><small>item </small></td>


      <td align="left" valign="top"><small>－ </small></td>


      <td align="left" valign="top"><small>－ </small></td>


      <td align="left" valign="top"><small>－ </small></td>


      <td align="left" valign="top"><small>０ </small></td>


      <td align="left" valign="top"><small>1 </small></td>


      <td align="left" valign="top"><small>1 </small></td>


      <td align="left" valign="top"><small>1 </small></td>


      <td align="left" valign="top"><small>０ </small></td>


    </tr>


  
  
        </tbody>
      </table>



      <ul>
        <li><small> 放入橘子</small>
  </li>
      </ul>


      <table border="1" width="50%">


  <tbody>


    <tr>


      <td align="left" valign="top"><small>背包負重 </small></td>


      <td align="left" valign="top"><small>1 </small></td>


      <td align="left" valign="top"><small>2 </small></td>


      <td align="left" valign="top"><small>3 </small></td>


      <td align="left" valign="top"><small>4 </small></td>


      <td align="left" valign="top"><small>5 </small></td>


      <td align="left" valign="top"><small>6 </small></td>


      <td align="left" valign="top"><small>7 </small></td>


      <td align="left" valign="top"><small>8 </small></td>


    </tr>


    <tr>


      <td align="left" valign="top"><small>value </small></td>


      <td align="left" valign="top"><small>０ </small></td>


      <td align="left" valign="top"><small>2250 </small></td>


      <td align="left" valign="top"><small>2250 </small></td>


      <td align="left" valign="top"><small>4500 </small></td>


      <td align="left" valign="top"><small>5700 </small></td>


      <td align="left" valign="top"><small>6750 </small></td>


      <td align="left" valign="top"><small>7950 </small></td>


      <td align="left" valign="top"><small>9000 </small></td>


    </tr>


    <tr>


      <td align="left" valign="top"><small>item </small></td>


      <td align="left" valign="top"><small>－ </small></td>


      <td align="left" valign="top"><small>2 </small></td>


      <td align="left" valign="top"><small>2 </small></td>


      <td align="left" valign="top"><small>０ </small></td>


      <td align="left" valign="top"><small>1 </small></td>


      <td align="left" valign="top"><small>2 </small></td>


      <td align="left" valign="top"><small>2 </small></td>


      <td align="left" valign="top"><small>０ </small></td>


    </tr>


  
  
        </tbody>
      </table>


      <br>


      <ul>
        <li><small> 放入草莓</small>
  </li>
      </ul>


      <table border="1" width="50%">


  <tbody>


    <tr>


      <td align="left" valign="top"><small>背包負重 </small></td>


      <td align="left" valign="top"><small>1 </small></td>


      <td align="left" valign="top"><small>2 </small></td>


      <td align="left" valign="top"><small>3 </small></td>


      <td align="left" valign="top"><small>4 </small></td>


      <td align="left" valign="top"><small>5 </small></td>


      <td align="left" valign="top"><small>6 </small></td>


      <td align="left" valign="top"><small>7 </small></td>


      <td align="left" valign="top"><small>8 </small></td>


    </tr>


    <tr>


      <td align="left" valign="top"><small>value </small></td>


      <td align="left" valign="top"><small>1100 </small></td>


      <td align="left" valign="top"><small>2250 </small></td>


      <td align="left" valign="top"><small>3350 </small></td>


      <td align="left" valign="top"><small>4500 </small></td>


      <td align="left" valign="top"><small>5700 </small></td>


      <td align="left" valign="top"><small>6800 </small></td>


      <td align="left" valign="top"><small>7950 </small></td>


      <td align="left" valign="top"><small>9050 </small></td>


    </tr>


    <tr>


      <td align="left" valign="top"><small>item </small></td>


      <td align="left" valign="top"><small>3 </small></td>


      <td align="left" valign="top"><small>2 </small></td>


      <td align="left" valign="top"><small>3 </small></td>


      <td align="left" valign="top"><small>０ </small></td>


      <td align="left" valign="top"><small>1 </small></td>


      <td align="left" valign="top"><small>3 </small></td>


      <td align="left" valign="top"><small>2 </small></td>


      <td align="left" valign="top"><small>3 </small></td>


    </tr>


  
  
        </tbody>
      </table>


      <br>


      <ul>
        <li><small> 放入甜瓜</small>
  </li>
      </ul>


      <table border="1" width="50%">


  <tbody>


    <tr>


      <td align="left" valign="top"><small>背包負重 </small></td>


      <td align="left" valign="top"><small>1 </small></td>


      <td align="left" valign="top"><small>2 </small></td>


      <td align="left" valign="top"><small>3 </small></td>


      <td align="left" valign="top"><small>4 </small></td>


      <td align="left" valign="top"><small>5 </small></td>


      <td align="left" valign="top"><small>6 </small></td>


      <td align="left" valign="top"><small>7 </small></td>


      <td align="left" valign="top"><small>8 </small></td>


    </tr>


    <tr>


      <td align="left" valign="top"><small>value </small></td>


      <td align="left" valign="top"><small>1100 </small></td>


      <td align="left" valign="top"><small>2250 </small></td>


      <td align="left" valign="top"><small>3350 </small></td>


      <td align="left" valign="top"><small>4500 </small></td>


      <td align="left" valign="top"><small>5700 </small></td>


      <td align="left" valign="top"><small>6800 </small></td>


      <td align="left" valign="top"><small>7950 </small></td>


      <td align="left" valign="top"><small>9050 </small></td>


    </tr>


    <tr>


      <td align="left" valign="top"><small>item </small></td>


      <td align="left" valign="top"><small>3 </small></td>


      <td align="left" valign="top"><small>2 </small></td>


      <td align="left" valign="top"><small>3 </small></td>


      <td align="left" valign="top"><small>０ </small></td>


      <td align="left" valign="top"><small>1 </small></td>


      <td align="left" valign="top"><small>3 </small></td>


      <td align="left" valign="top"><small>2 </small></td>


      <td align="left" valign="top"><small>3 </small></td>


    </tr>


  
  
        </tbody>
      </table>


      <br>
      <small>
由最後一個表格，可以得知在背包負重8公斤時，最多可以裝入9050元的水果，而最後一個裝入的
水果是3號，也就是草莓，裝入了草莓，背包只能再放入7公斤（8-1）的水果，所以必須看背包負重7公斤時的最佳解，最後一個放入的是2號，也就
是橘子，現在背包剩下負重量5公斤（7-2），所以看負重5公斤的最佳解，最後放入的是1號，也就是蘋果，此時背包負重量剩下0公斤（5-5），無法
再放入水果，所以求出最佳解為放入草莓、橘子與蘋果，而總價為9050元。</small><br>

      <br>

      <h2> 實作</h2>


      <ul>
        <li> C
  </li>
      </ul>


      <pre>#include &lt;stdio.h&gt; <br>#include &lt;stdlib.h&gt; <br><br>#define LIMIT 8   // 重量限制 <br>#define N 5       // 物品種類 <br>#define MIN 1     // 最小重量 <br><br>struct body { <br>    char name[20]; <br>    int size; <br>    int price; <br>}; <br><br>typedef struct body object; <br><br>int main(void) { <br>    int item[LIMIT+1] = {0}; <br>    int value[LIMIT+1] = {0}; <br>    int newvalue, i, s, p; <br><br>    object a[] = {{"李子", 4, 4500}, <br>                  {"蘋果", 5, 5700}, <br>                  {"橘子", 2, 2250}, <br>                  {"草莓", 1, 1100}, <br>                  {"甜瓜", 6, 6700}}; <br><br>    for(i = 0; i &lt; N; i++) { <br>        for(s = a[i].size; s &lt;= LIMIT; s++) { <br>            p = s - a[i].size; <br>            newvalue = value[p] + a[i].price; <br>            if(newvalue &gt; value[s]) {// 找到階段最佳解 <br>                value[s] = newvalue; <br>                item[s] = i; <br>            } <br>        } <br>    } <br><br>    printf("物品\t價格\n"); <br>    for(i = LIMIT; i &gt;= MIN; i = i - a[item[i]].size) { <br>        printf("%s\t%d\n", <br>                  a[item[i]].name, a[item[i]].price); <br>    } <br><br>    printf("合計\t%d\n", value[LIMIT]); <br><br>    return 0; <br>}  <br></pre>


      <br>


      <ul>
        <li> Java
  </li>
      </ul>


      <pre>class Fruit {<br>    private String name;<br>    private int size;<br>    private int price;<br>    <br>    public Fruit(String name, int size, int price) {<br>        this.name = name;<br>        this.size = size;<br>        this.price = price;<br>    }<br>    <br>    public String getName() {<br>        return name;<br>    }<br><br>    public int getPrice() {<br>        return price;<br>    }<br><br>    public int getSize() {<br>        return size;<br>    }<br>}<br><br>public class Knapsack {<br>    public static void main(String[] args) {<br>        final int MAX = 8;<br>        final int MIN = 1;<br>        int[] item = new int[MAX+1]; <br>        int[] value = new int[MAX+1];  <br><br>        Fruit fruits[] = {<br>                new Fruit("李子", 4, 4500), <br>                new Fruit("蘋果", 5, 5700), <br>                new Fruit("橘子", 2, 2250), <br>                new Fruit("草莓", 1, 1100), <br>                new Fruit("甜瓜", 6, 6700)}; <br><br>        for(int i = 0; i &lt; fruits.length; i++) { <br>            for(int s = fruits[i].getSize(); s &lt;= MAX; s++) { <br>                int p = s - fruits[i].getSize(); <br>                int newvalue = value[p] + <br>                                   fruits[i].getPrice(); <br>                if(newvalue &gt; value[s]) {// 找到階段最佳解 <br>                    value[s] = newvalue; <br>                    item[s] = i; <br>                } <br>            } <br>        } <br><br>        System.out.println("物品\t價格"); <br>        for(int i = MAX; <br>            i &gt;= MIN; <br>            i = i - fruits[item[i]].getSize()) { <br>            System.out.println(fruits[item[i]].getName()+ <br>                    "\t" + fruits[item[i]].getPrice()); <br>        } <br><br>        System.out.println("合計\t" + value[MAX]);  <br>    }<br>}</pre>

      <br>
 </td>

      <td style="width: 250px; text-align: center; vertical-align: top;">
      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js">
      </script><br>

      <br>

      <script type="text/javascript"><!--
google_ad_client = "pub-9750319131714390";
google_ad_width = 160;
google_ad_height = 600;
google_ad_format = "160x600_as";
google_ad_type = "text_image";
google_ad_channel = "";
//-->
      </script>
      <script type="text/javascript" src="show_ads.js" tppabs="http://pagead2.googlesyndication.com/pagead/show_ads.js">
      </script></td>

    </tr>

  </tbody>
</table>
<br>

<br>




</body>
</html>
