<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0048)http://www.vckbase.com/document/viewdoc/?id=1062 -->
<HTML><HEAD><TITLE>VC知识库文章 - 利用PDFLib生成PDF文档</TITLE>
<META http-equiv=Content-Type content="text/html; charset=gb2312">
<META content=pdflib name=keywords>
<META content=pdflib name=description><LINK href="PDFLib1.files/style.css" 
rel=stylesheet>
<META content="MSHTML 6.00.2900.2180" name=GENERATOR></HEAD>
<BODY bgColor=#ffffff leftMargin=0 topMargin=0>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR bgColor=#a0d39b>
    <TD height=30>&nbsp;<IMG height=13 src="PDFLib1.files/vckcom.gif" 
      width=109></TD>
    <TD vAlign=bottom align=right height=30><IMG height=27 
      src="PDFLib1.files/earch.gif" width=89></TD></TR>
  <TR bgColor=#eeeeee>
    <TD width="76%"><FONT class=small color=#333333>::</FONT><A 
      href="http://www.vckbase.com/"><FONT color=black><SPAN 
      class=small>首页</SPAN></FONT></A> &gt;&gt; <A 
      href="http://www.vckbase.com/document"><FONT color=black><SPAN 
      class=small>文档中心</SPAN></FONT></A> &gt;&gt; <A 
      href="http://www.vckbase.com/document/journal"><SPAN class=small><FONT 
      color=black>在线杂志</FONT></SPAN></A> &gt;&gt; <A 
      href="http://www.vckbase.com/document/listdoc.asp?sclsid=111"><SPAN 
      class=small><FONT color=black>Samples</FONT></SPAN></A></TD>
    <TD class=small align=right width="24%">[ <A 
      href="http://www.vckbase.com/document/journal/redir.asp?journal=30"><SPAN 
      class=small><FONT color=black>在线杂志 第30期</FONT></SPAN></A> ] 
</TD></TR></TBODY></TABLE>
<DIV align=center><BR>
<TABLE height=108 cellSpacing=1 cellPadding=0 width="90%" bgColor=#999999 
border=0>
  <TBODY>
  <TR>
    <TD>
      <TABLE height=100 cellSpacing=0 cellPadding=5 width="100%" border=0>
        <TBODY>
        <TR>
          <TD class=small width=705 bgColor=#f9f9f9 height=106><FONT 
            color=#0000ff>本站特别推荐：</FONT><BR><A href="http://www.uipower.com/" 
            target=_blank>Skin++ 通用的界面换肤控件（Skin++ 
            2.0于2005年11月1日发布，网站全面更新！）产品</A><BR><BR>特性：<BR>支持多种开发语言（VC++ 
            ，VB，C#，PowerBuilder，C++Builder，Delphi，E语言等）<BR>界面和业务逻辑彻底分离，节约开发和维护时间，支持各Windows平台，包括Windows98/NT4/2000/XP/2003<BR>彻底换肤,包括标准控件，通用对话框等，支持对第三方控件的换肤，提供方便的设计工具，可自行设计皮肤。[<A 
            href="http://www.uipower.com/" target=_blank>详情请点这里</A>]</TD>
          <TD align=middle width=183 bgColor=#99cccc><A 
            href="http://www.uipower.com/zp.asp" 
            target=_blank><U>公司诚聘VC界面软件工程师</U></A></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV><BR>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD background=PDFLib1.files/dotline2.gif height=1></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD width=40 height=74></TD>
    <TD vAlign=top width=* height=74>
      <FORM name=form2 action=/SYS/script/find.asp method=post>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD><SPAN id=docinfo>[ <FONT color=#009900>原创文档</FONT> 本文适合初级读者 
            已阅读9585次 ]</SPAN></TD>
          <TD align=right><INPUT class=rect maxLength=20 size=10 name=keyword> 
            <SELECT class=rect name=gclsid> <OPTION value=100 
              selected>文档</OPTION> <OPTION value=200>代码</OPTION> <OPTION 
              value=400>工具</OPTION></SELECT> <INPUT type=image height=15 width=21 
            src="PDFLib1.files/go.gif" align=absMiddle border=0 name=imageField> 
          </TD></TR></TBODY></TABLE></FORM>
      <TABLE width="100%" border=0>
        <TBODY>
        <TR>
          <TD>
            <P align=center><STRONG>利用PDFLib生成PDF文档</STRONG><BR><BR>作者：浙江省温岭电信局 
            王骏</P>
            <P><A 
            href="http://www.vckbase.com/code/downcode.asp?id=2297">下载本文示例工程</A><BR><A 
            href="http://www.vckbase.com/tools/downtools.asp?id=110">下载PDFLib</A><BR><BR><IMG 
            height=472 src="PDFLib1.files/pdflibtest.gif" 
            width=587><BR>本文代码生成的PDF文档效果图<BR><BR><BR><STRONG>一、PDF介绍</STRONG><BR>PDF是Portable 
            Document 
            Format的缩写,PDF文件格式是国际通用的电子文档交换事实标准，被许多国家采用作为电子文档交换。PDF文件可以在各种平台下阅读、编辑、发布。该文件格式支持字体、图像、甚至任何附件的嵌入。您可以通过免费的Adobe 
            Acrobat 
            Reader来阅读、编辑PDF文档。<BR><BR><STRONG>二、PDFLib介绍</STRONG><BR>PDFLib是用于创建PDF文档的开发库，提供了简单易用的API，隐藏了创建PDF的复杂细节且不需要第3方软件的支持。PDFLib库对于个人是免费的，对于商业产品需要购买许可, 
            您可以到VC知识库的工具与资源栏目下载:<A href="http://www.vckbase.com/tools/" 
            target=_blank>http://www.vckbase.com/tools/</A>。<BR><BR><STRONG>三、在VC++中使用PDFLib</STRONG><BR>本文例子中使用的PDFLib是4.0.2版本，与5.0版本差不多。5.0免费版本中有一个WWW.PDFLIB.COM的水印，4.0中没有。<BR><BR><STRONG>3.1 
            前期准备</STRONG><BR>建立工程后，将except.cpp,except.h,pdflib.cpp,pdflib.h,pdflib.dll,pdflib.lib拷贝到工程目录。<BR><BR><STRONG>3.2 
            编码</STRONG><BR><STRONG>3.2.1 添加对头文件和库的引用</STRONG> </P><PRE>#include "PDFLib.hpp"

#pragma comment(lib, "PDFLib.lib")</PRE><STRONG>3.2.2生成PDF文档的过程</STRONG><BR>生成PDF文档的过程非常简单，请看如下编码：<PRE>int main(void)
{
	try
	{
		PDFlib pdf;

		// 设置兼容参数
		pdf.set_parameter("compatibility", "1.4");	// 兼容Acrobat 5


		// 打开文档
		if(pdf.open("vckbase.pdf") == -1)
			throw("打开文件出错!");

		// 设置文档信息
		pdf.set_info("Creator", "PDF Creator");
		pdf.set_info("Author", "WangJun");
		pdf.set_info("Title", "Convert to PDF");
		pdf.set_info("Subject", "PDF Creator");
		pdf.set_info("Keywords", "vckbase.com");

		// 开始A4页面
		pdf.begin_page(a4_width, a4_height);

		// 设置字体为12号宋体
		int font_song = pdf.findfont("STSong-Light", "GB-EUC-H", 0);
		pdf.setfont(font_song, 12);

		// 设置起始点
		pdf.set_text_pos(50, a4_height - 50);

		// 设置颜色为蓝色
		pdf.setcolor("fill", "rgb", 0, 0, 1, 0);

		// 输出文字
		pdf.show("VCKBASE.COM欢迎您!");

		pdf.setcolor("fill", "rgb", 0, 0, 0, 0);
		pdf.setfont(font_song, 24);
		pdf.continue_text("在线杂志");

		// 画两根绿线
		pdf.setcolor("stroke", "rgb", 0.24f, 0.51f, 0.047f, 0);
		pdf.moveto(50, a4_height - 80);
		pdf.lineto(a4_width - 50, a4_height - 80);
		pdf.moveto(50, a4_height - 78);
		pdf.lineto(a4_width - 50, a4_height - 78);
		pdf.stroke();

		// 填充一个蓝色方框
		pdf.setcolor("fill", "rgb", 0.04f, 0.24f, 0.62f, 0);
		pdf.rect(50, 50, a4_width - 100, 70);
		pdf.fill();

		// 在指定位置输出文字
		pdf.setcolor("fill", "rgb", 0, 1, 1, 0);
		pdf.setfont(font_song, 16);
		pdf.show_xy("版权所有 VCKBASE", a4_width - 280, 60);

		// 打开并显示一个图像
		int img = pdf.open_image_file("jpeg", "vckbase.jpg", "", 0);
		pdf.place_image(img, 200, 400, 1);
		pdf.close_image(img);

		// 添加附件
		pdf.attach_file(a4_width - 50, 0, 0, a4_height - 150,
				"vckbase.zip", "VCKBASE", "wj", "zip", "paperclip");

		// 结束本页
		pdf.end_page();

		// 关闭PDF文件
		pdf.close();

	}
	catch(PDFlib::Exception &amp;ex)
	{
		cerr &lt;&lt; "错误信息：" &lt;&lt; ex.get_message() &lt;&lt; endl;
		return -1;
	}
	catch(char *pStrErr)
	{
		cerr &lt;&lt; pStrErr &lt;&lt; endl;
		return -1;
	}
	catch(...)
	{
		cerr &lt;&lt; "发生未知异常!" &lt;&lt; endl;
		return -1;
	}

	return 0;
}</PRE>PDFLIB还有许多功能，比如书签、PDF导入等功能，具体可以参考PDFLIB函数手册（可以到VC知识库中下载pdflib5.0，里面包含了该手册）。</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR>
<DIV align=center>
<SCRIPT type=text/javascript><!--
google_ad_client = "pub-4159669282587342";
google_alternate_color = "FFFFFF";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "text_image";
google_ad_channel ="";
google_color_border = "B4D0DC";
google_color_bg = "ECF8FF";
google_color_link = "0000CC";
google_color_url = "008000";
google_color_text = "6F6F6F";
//--></SCRIPT>

<SCRIPT src="PDFLib1.files/show_ads.js" type=text/javascript>
</SCRIPT>
<BR><BR>
<TABLE class=small height=18 cellSpacing=0 cellPadding=0 width="98%" border=0>
  <TBODY>
  <TR vAlign=center>
    <TD width="47%" bgColor=#a0d39b><IMG height=10 
      src="PDFLib1.files/toplogo.gif" width=10>最新评论 <A 
      href="http://www.vckbase.com/SYS/script/viewcomment.asp?gclsid=100&amp;itemid=1062" 
      target=_blank><SPAN class=small>[发表评论]</SPAN></A> <A 
      href="http://www.vckbase.com/support/contribute.html" target=_blank><SPAN 
      class=small>[文章投稿]</SPAN></A></TD>
    <TD align=right width="53%" bgColor=#a0d39b><IMG height=9 src="" width=9> 
      <A 
      href="http://www.vckbase.com/SYS/script/viewcomment.asp?gclsid=100&amp;itemid=1062" 
      target=_blank><SPAN class=small>查看所有评论</SPAN></A> <IMG height=9 src="" 
      width=9> <A 
      href="http://www.vckbase.com/SYS/script/writemail.asp?gclsid=100&amp;itemid=1062&amp;title=%c0%fb%d3%c3PDFLib%c9%fa%b3%c9PDF%ce%c4%b5%b5" 
      target=_blank><SPAN class=small>推荐给好友</SPAN></A> <IMG height=9 src="" 
      width=9> <A href="javascript:window.print();"><SPAN 
      class=small>打印</SPAN></A></TD></TR></TBODY></TABLE>
<TABLE class=small cellSpacing=1 cellPadding=0 width="98%" bgColor=#ffffff 
border=0>
  <TBODY>
  <TR>
    <TD bgColor=#ffffff><BR><IMG height=11 src="PDFLib1.files/doc2.gif" 
      width=11 align=absMiddle> 妙 ( muzimeiwen 发表于 2006-1-18 
      14:00:00)<BR>&nbsp;<BR><IMG height=11 src="PDFLib1.files/doc2.gif" 
      width=11 align=absMiddle> 其它中文字体怎么显示,我试很多,都不行,只能用STSong-Light ( lcftc2 发表于 
      2004-8-22 21:16:00)<BR>&nbsp;<BR><IMG height=11 
      src="PDFLib1.files/doc2.gif" width=11 align=absMiddle> 请问如何进行“粘贴”操作？多谢！ ( 
      shutle 发表于 2004-7-27 13:01:00)<BR>&nbsp;<BR><IMG height=11 
      src="PDFLib1.files/doc2.gif" width=11 align=absMiddle> 
      如何去掉PDF中的水印，并且书签上如何显示汉字？ ( sunrain232 发表于 2004-7-21 
      16:04:00)<BR>&nbsp;<BR><IMG height=11 src="PDFLib1.files/doc2.gif" 
      width=11 align=absMiddle> 谁写了注册机啊，谢谢啦。 ( littlestar 发表于 2004-7-16 
      21:40:00)<BR>&nbsp;<BR><IMG height=11 src="PDFLib1.files/doc2.gif" 
      width=11 align=absMiddle> 
      PDFLib&nbsp;for&nbsp;COM-NET&nbsp;V5.0.1&nbsp;<BR>X530602-4321CD-2678EF-B1D77F 
      ( softy 发表于 2004-6-26 16:37:00)<BR>&nbsp;<BR><IMG height=11 
      src="PDFLib1.files/doc2.gif" width=11 align=absMiddle> 
      免费版里有没有将多也tif文件或多个jpg文件转换成多页pdf的api? ( camel20 发表于 2004-5-19 
      9:02:00)<BR>&nbsp;<BR><IMG height=11 src="PDFLib1.files/doc2.gif" width=11 
      align=absMiddle> 可以同时产生多份PDF文档 ( whh1017 发表于 2004-5-12 
      15:56:00)<BR>&nbsp;<BR><IMG height=11 src="PDFLib1.files/doc2.gif" 
      width=11 align=absMiddle> 
      jurist:免费版有些函数不能使用，原因就是因为他是免费版。TXT,HTML文档转换PDF，没有直接的函数，你必须去读取TXT,HTML文档，后者你还要解析里面的内容。 
      ( wangjun 发表于 2004-4-25 19:56:00)<BR>&nbsp;<BR><IMG height=11 
      src="PDFLib1.files/doc2.gif" width=11 align=absMiddle> 
      to:&nbsp;wangjun<BR>4.0免费版的有些函数不能正常使用,譬如PDF_OPEN_FILE,这是什么原因呢?你的这段代码是把图片文件转换成PDF文档,如果我想把TXT或者HTML文档转换成PDF文档,应该调用什么函数呢?<BR>另外,我在www.pdflib.com上见到了很多pdflib,也是有些不能使用,请王老师帮忙解决. 
      ( jurist 发表于 2004-4-15 
      10:27:00)<BR>&nbsp;<BR>.......................................................<BR><A 
      href="http://www.vckbase.com/SYS/script/viewcomment.asp?gclsid=100&amp;itemid=1062" 
      target=_blank><SPAN class=small>More...</SPAN></A> 
</TD></TR></TBODY></TABLE></DIV><BR>
<DIV align=right><BR><SPAN class=small>版权所有 &copy; 2006 VC知识库&nbsp; 
<BR><BR></SPAN></DIV></BODY></HTML>
