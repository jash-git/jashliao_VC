<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0048)http://www.vckbase.com/document/viewdoc/?id=1533 -->
<HTML><HEAD><TITLE>VC知识库文章 - 浅谈PDFlib中文输出（三）PDFlib 的几种文本输出函数</TITLE>
<META http-equiv=Content-Type content="text/html; charset=gb2312">
<META content=pdflib,中文输出 name=keywords>
<META content=pdflib,中文输出 name=description><LINK href="PDFLib4.files/style.css" 
rel=stylesheet>
<META content="MSHTML 6.00.2900.2180" name=GENERATOR></HEAD>
<BODY bgColor=#ffffff leftMargin=0 topMargin=0>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR bgColor=#a0d39b>
    <TD height=30>&nbsp;<IMG height=13 src="PDFLib4.files/vckcom.gif" 
      width=109></TD>
    <TD vAlign=bottom align=right height=30><IMG height=27 
      src="PDFLib4.files/earch.gif" width=89></TD></TR>
  <TR bgColor=#eeeeee>
    <TD width="76%"><FONT class=small color=#333333>::</FONT><A 
      href="http://www.vckbase.com/"><FONT color=black><SPAN 
      class=small>首页</SPAN></FONT></A> &gt;&gt; <A 
      href="http://www.vckbase.com/document"><FONT color=black><SPAN 
      class=small>文档中心</SPAN></FONT></A> &gt;&gt; <A 
      href="http://www.vckbase.com/document/journal"><SPAN class=small><FONT 
      color=black>在线杂志</FONT></SPAN></A> &gt;&gt; <A 
      href="http://www.vckbase.com/document/listdoc.asp?sclsid=111"><SPAN 
      class=small><FONT color=black>Samples</FONT></SPAN></A></TD>
    <TD class=small align=right width="24%">[ <A 
      href="http://www.vckbase.com/document/journal/redir.asp?journal=44"><SPAN 
      class=small><FONT color=black>在线杂志 第44期</FONT></SPAN></A> ] 
</TD></TR></TBODY></TABLE>
<DIV align=center><BR>
<TABLE height=108 cellSpacing=1 cellPadding=0 width="90%" bgColor=#999999 
border=0>
  <TBODY>
  <TR>
    <TD>
      <TABLE height=100 cellSpacing=0 cellPadding=5 width="100%" border=0>
        <TBODY>
        <TR>
          <TD class=small width=705 bgColor=#f9f9f9 height=106><FONT 
            color=#0000ff>本站特别推荐：</FONT><BR><A href="http://www.uipower.com/" 
            target=_blank>Skin++ 通用的界面换肤控件（Skin++ 
            2.0于2005年11月1日发布，网站全面更新！）产品</A><BR><BR>特性：<BR>支持多种开发语言（VC++ 
            ，VB，C#，PowerBuilder，C++Builder，Delphi，E语言等）<BR>界面和业务逻辑彻底分离，节约开发和维护时间，支持各Windows平台，包括Windows98/NT4/2000/XP/2003<BR>彻底换肤,包括标准控件，通用对话框等，支持对第三方控件的换肤，提供方便的设计工具，可自行设计皮肤。[<A 
            href="http://www.uipower.com/" target=_blank>详情请点这里</A>]</TD>
          <TD align=middle width=183 bgColor=#99cccc><A 
            href="http://www.uipower.com/zp.asp" 
            target=_blank><U>公司诚聘VC界面软件工程师</U></A></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV><BR>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD background=PDFLib4.files/dotline2.gif height=1></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD width=40 height=74></TD>
    <TD vAlign=top width=* height=74>
      <FORM name=form2 action=/SYS/script/find.asp method=post>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD><SPAN id=docinfo>[ <FONT color=#009900>原创文档</FONT> 本文适合初级读者 
            已阅读1273次 ]</SPAN></TD>
          <TD align=right><INPUT class=rect maxLength=20 size=10 name=keyword> 
            <SELECT class=rect name=gclsid> <OPTION value=100 
              selected>文档</OPTION> <OPTION value=200>代码</OPTION> <OPTION 
              value=400>工具</OPTION></SELECT> <INPUT type=image height=15 width=21 
            src="PDFLib4.files/go.gif" align=absMiddle border=0 name=imageField> 
          </TD></TR></TBODY></TABLE></FORM>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD>
            <P align=center><STRONG>浅谈PDFlib中文输出（三）</STRONG><BR>-- PDFlib 
            的几种文本输出函数<BR><BR>作者:Michelle Yi</P>
            <P><A 
            href="http://www.vckbase.com/code/downcode.asp?id=2764">下载源代码</A><BR><BR><STRONG>1．PDF_show</STRONG><BR>void 
            PDF_show(PDF *p, const char *text)<BR>void PDF_show2(PDF *p, const 
            char *text, int 
            len)<BR>在当前坐标用当前字体及字体大小输出文本。<BR>PDF_show将认为字符串是以空字符结尾（NULL）；若字符串有可能含有空字符（如多字节字符串），用PDF_show2。</P>
            <P><STRONG>2．PDF_show_xy</STRONG><BR>void PDF_show_xy(PDF *p, const 
            char *text, double x, double y)<BR>void PDF_show_xy2(PDF *p, const 
            char *text, int len, double x, double 
            y)<BR>在给出的坐标用当前字体及字体大小输出文本。<BR>PDF_show_xy将认为字符串是以空字符结尾（NULL）；若字符串有可能含有空字符（如多字节字符串），用PDF_show_xy2。</P>
            <P><STRONG>3．PDF_continue_text</STRONG><BR>void 
            PDF_continue_text(PDF *p, const char *text)<BR>void 
            PDF_continue_text2(PDF *p, const char *text, int 
            len)<BR>在下一行用当前字体及字体大小输出文本。<BR>PDF_continue_xy将认为字符串是以空字符结尾（NULL）；若字符串有可能含有空字符（如多字节字符串），用PDF_continue_xy2。</P>
            <P><STRONG>4．PDF_fit_textline</STRONG><BR>void 
            PDF_fit_textline(PDF*p, const char *text, int len, double x, double 
            y, const char 
            *optlist)<BR>在给出的坐标根据选择项输出一行文本。<BR>若字符串是以空字符结尾（NULL），len为0；否则，给出具体字节数。</P>
            <P><STRONG>5．PDF_fit_textflow</STRONG><BR>int 
            PDF_create_textflow(PDF *p, const char *text, int len, const char 
            *optlist)<BR>建立文本流对象,并预处理文本为下面的文本格式化做准备。<BR>若字符串是以空字符结尾（NULL），len为0；否则，给出具体字节数。<BR>const 
            char *PDF_fit_textflow(PDF *p, int textflow, double llx, double lly, 
            double urx, double ury, const char 
            *optlist)<BR>将文本输出到相应的矩形块中。<BR>lly, llx, ury, urx, 
            分别是矩形块左下角及右上角的纵横坐标。<BR>void PDF_delete_textflow(PDF *p, int 
            textflow)<BR>删除文本流对象及相关数据结构。<BR><BR><STRONG>小结</STRONG></P>
            <P>1，2， 3 
            组函数简洁，直观，易用。4，5组函数可通过对选择项的控制而输出更灵活的文本格式。尤其是第5组函数，是专门为多行文本设计的，可通过选项控制对齐，字间距，边框显示，旋转等。但4，5组函数有个局限，在字符串是多字节时，它们只能处理Unicode类编码。换而言之，他们不支持cp936编码。</P>
            <P>下面是一个相关的例子--C 源程序(下载源代码中包含了生成的pdf文件 CPDFlib_cs3.pdf)。<BR></P><PRE>/*******************************************************************/
/* This example demostrates different ways to output Chinese Simplified text
/* under Chinese Simplifed Windows.
/*******************************************************************/

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include "pdflib.h"

int main(void)
{
    PDF         *p = NULL;
    int         i = 0, j = 0, Left = 50, Top = 800, Right = 545;
    int         Font_E = 0, Font_CS = 0, Font_CS2 = 0, TextFlow = 0;
    char        TextUnicode[] = "\x80\x7B\x53\x4F\x2D\x4E\x87\x65";
    char        TextCp936[] = "\xBC\xF2\xCC\xE5\xD6\xD0\xCE\xC4";

    /* create a new PDFlib object */
    if ((p = PDF_new()) == (PDF *) 0)
    {
        printf("Couldn''t create PDFlib object (out of memory)!\n");
        return(2);
    }

    PDF_TRY(p) {
	if (PDF_begin_document(p, "pdflib_cs3.pdf", 0, "") == -1) 
            {
	    printf("Error: %s\n", PDF_get_errmsg(p));
	    return(2);
	}

       PDF_set_info(p, "Creator", "pdflib_cs3.c");
       PDF_set_info(p, "Author", "myi@pdflib.com");
       PDF_set_info(p, "Title", "Different Ways To Output Chinese Simplify");

        /* Start a new page. */
        PDF_begin_page_ext(p, a4_width, a4_height, "");
        Font_E = PDF_load_font(p, "Helvetica-Bold", 0, "winansi", "");
        Font_CS = PDF_load_font(p, "STSong-Light", 0, "UniGB-UCS2-H", "");
        Font_CS2 = PDF_load_font(p, "STSong-Light", 0, "GB-EUC-H", "");

        /* Using PDF_set_text_pos and PDF_show functions. */
        PDF_setfont(p, Font_E, 20);
        PDF_set_text_pos(p, Left, Top);
        PDF_show(p, "Using PDF_set_text_pos and PDF_show to output text:");
        Top-=30;
        PDF_set_text_pos(p, Left+20, Top);
        PDF_show(p, "UniGB-UCS2-H encoding:");
        PDF_setfont(p, Font_CS, 24);
        Top-=30;
        PDF_set_text_pos(p, Left+20, Top);
        PDF_show2(p, TextUnicode, 8);
        Top-=30;
        PDF_setfont(p, Font_E, 20);
        PDF_set_text_pos(p, Left+20, Top);
        PDF_show(p, "GB-EUC-H encoding:");
        PDF_setfont(p, Font_CS2, 24);
        Top-=30;
        PDF_set_text_pos(p, Left+20, Top);
        PDF_show2(p, TextCp936, 8);

        /* Using PDF_show_xy function. */
        Top-=50;
        PDF_setfont(p, Font_E, 20);
        PDF_show_xy(p, "Using PDF_show_xy to output text:" , Left,  Top);
        Top-=30;
        PDF_show_xy(p, "UniGB-UCS2-H encoding:" , Left+20,  Top);
        PDF_setfont(p, Font_CS, 24);
        Top-=30;
        PDF_show_xy2(p, TextUnicode, 8, Left+20,  Top);
        Top-=30;
        PDF_setfont(p, Font_E, 20);
        PDF_show_xy(p, "GB-EUC-H encoding:", Left+20,  Top);
        Top-=30;
        PDF_setfont(p, Font_CS2, 24);
        PDF_show_xy2(p, TextCp936, 8, Left+20,  Top);

        /* Using PDF_continue_text function. */
        Top-=30;
        PDF_setfont(p, Font_E, 20);
        PDF_set_text_pos(p, Left, Top);
        PDF_continue_text(p, "Using PDF_continue_text to output text:");
        Top-=30;
        PDF_set_text_pos(p, Left+20, Top);
        PDF_continue_text(p, "UniGB-UCS2-H encoding:");
        PDF_setfont(p, Font_CS, 24);
        PDF_continue_text2(p, TextUnicode, 8);
        PDF_setfont(p, Font_E, 20);
        PDF_continue_text(p, "GB-EUC-H encoding:");
        PDF_setfont(p, Font_CS2, 24);
        PDF_continue_text2(p, TextCp936, 8);

        /* Using PDF_fit_textline function. */
        Top-=140;
        PDF_setfont(p, Font_E, 20);
        PDF_fit_textline(p, "Using PDF_fit_textline to output text:", 0, Left, Top, "");
        Top-=30;
        PDF_fit_textline(p, "UniGB-UCS2-H encoding:", 0, Left+20, Top, "");
        PDF_setfont(p, Font_CS, 24);
        Top-=30;
        PDF_fit_textline(p, TextUnicode, 8, Left+20, Top, "");

        /* Using PDF_create_textflow, PDF_fit_textflow and PDF_delete_textflow function. */
        Top-=30;
        PDF_setfont(p, Font_E, 20);
        TextFlow = PDF_create_textflow(p, 
            "Using PDF_create_textflow, PDF_fit_textflow and PDF_delete_textflow to output text:", 
            0, "fontname=Helvetica-Bold fontsize=20 encoding=winansi");
        PDF_fit_textflow(p, TextFlow, Left, Top, Right, Top-60, "");
        Top-=60;
        TextFlow = PDF_create_textflow(p, "UniGB-UCS2-H encoding:", 0,  
            "fontname=Helvetica-Bold fontsize=20 encoding=winansi");
        PDF_fit_textflow(p, TextFlow, Left+20, Top, Right, Top-30, "");
        Top-=30;
        TextFlow = PDF_create_textflow(p, TextUnicode, 8, "fontname=STSong-Light 
            fontsize=24 encoding=UniGB-UCS2-H textlen=8");
        PDF_fit_textflow(p, TextFlow, Left+20, Top, Right, Top-30, "");
        PDF_delete_textflow(p, TextFlow);

        /* End of page. */
	PDF_end_page_ext(p, "");
        PDF_end_document(p, "");
    }

    PDF_CATCH(p) {
        printf("PDFlib exception occurred in pdflib_cs3 sample:\n");
        printf("[%d] %s: %s\n",
	    PDF_get_errnum(p), PDF_get_apiname(p), PDF_get_errmsg(p));
        PDF_delete(p);
        return(2);
    }

    PDF_delete(p);
    return 0;
}
</PRE><STRONG>相关链接:</STRONG><BR><BR>PDFLIB官方网站: <A 
            href="http://www.pdflib.com/" 
            target=_blank>http://www.pdflib.com/</A><BR>PDFLIB官方下载专页:<A 
            href="http://www.pdflib.com/products/pdflib/download/index.html" 
            target=_blank>http://www.pdflib.com/products/pdflib/download/index.html</A><BR>VC知识库PDFLIB下载:<A 
            href="http://www.vckbase.com/tools" 
            target=_blank>http://www.vckbase.com/tools</A><BR><BR>
            <P></P>(本篇完) </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR>
<DIV align=center>
<SCRIPT type=text/javascript><!--
google_ad_client = "pub-4159669282587342";
google_alternate_color = "FFFFFF";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "text_image";
google_ad_channel ="";
google_color_border = "B4D0DC";
google_color_bg = "ECF8FF";
google_color_link = "0000CC";
google_color_url = "008000";
google_color_text = "6F6F6F";
//--></SCRIPT>

<SCRIPT src="PDFLib4.files/show_ads.js" type=text/javascript>
</SCRIPT>
<BR><BR>
<TABLE class=small height=18 cellSpacing=0 cellPadding=0 width="98%" border=0>
  <TBODY>
  <TR vAlign=center>
    <TD width="47%" bgColor=#a0d39b><IMG height=10 
      src="PDFLib4.files/toplogo.gif" width=10>最新评论 <A 
      href="http://www.vckbase.com/SYS/script/viewcomment.asp?gclsid=100&amp;itemid=1533" 
      target=_blank><SPAN class=small>[发表评论]</SPAN></A> <A 
      href="http://www.vckbase.com/support/contribute.html" target=_blank><SPAN 
      class=small>[文章投稿]</SPAN></A></TD>
    <TD align=right width="53%" bgColor=#a0d39b><IMG height=9 src="" width=9> 
      <A 
      href="http://www.vckbase.com/SYS/script/viewcomment.asp?gclsid=100&amp;itemid=1533" 
      target=_blank><SPAN class=small>查看所有评论</SPAN></A> <IMG height=9 src="" 
      width=9> <A 
      href="http://www.vckbase.com/SYS/script/writemail.asp?gclsid=100&amp;itemid=1533&amp;title=%c7%b3%cc%b8PDFlib%d6%d0%ce%c4%ca%e4%b3%f6%a3%a8%c8%fd%a3%a9PDFlib+%b5%c4%bc%b8%d6%d6%ce%c4%b1%be%ca%e4%b3%f6%ba%af%ca%fd" 
      target=_blank><SPAN class=small>推荐给好友</SPAN></A> <IMG height=9 src="" 
      width=9> <A href="javascript:window.print();"><SPAN 
      class=small>打印</SPAN></A></TD></TR></TBODY></TABLE></DIV><BR>
<DIV align=right><BR><SPAN class=small>版权所有 &copy; 2006 VC知识库&nbsp; 
<BR><BR></SPAN></DIV></BODY></HTML>
