<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0169)http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputfunctions/keybd_event.asp?frame=true -->
<!--TOOLBAR_EXEMPT--><HTML xmlns:tool = 
"http://www.microsoft.com/tooltip"><HEAD><TITLE>keybd_event Function</TITLE>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<META 
content="The keybd_event function synthesizes a keystroke. The system can use such a synthesized keystroke to generate a WM_KEYUP or WM_KEYDOWN message. The keyboard driver's interrupt handler calls the keybd_event function." 
name=Description>
<META content="" name=Robots>
<META content="" name=Keywords>
<META content=en-us name=MS.LOCALE><LINK href="keybd_event.files/ie4.css" 
type=text/css rel=stylesheet><LINK href="keybd_event.files/ie5.css" 
type=text/css rel=stylesheet>
<STYLE>BODY {
	MARGIN: 0px; FONT-FAMILY: verdana,arial,helvetica
}
</STYLE>

<SCRIPT language=javascript src="keybd_event.files/toolbar.js"></SCRIPT>

<SCRIPT language=javascript src="keybd_event.files/Broker.js"></SCRIPT>
<LINK href="keybd_event.files/default.css" type=text/css rel=stylesheet>
<SCRIPT language=JavaScript><!--
   function BrowserData()
{
		this.userAgent = "Mozilla/4.0 (compatible; MSIE 6.0; Windows 98)";

		this.bot = false;

		this.browser = "MSIE";

		this.majorVer = 6;

		this.minorVer = "0";

		this.betaVer = "0";

		this.platform = "98";

		this.platVer = "0";

		this.getsNavBar = true;

		this.doesActiveX = true;

		this.doesPersistence = true;

		this.fullVer = 6;

   }

   var oBD = new BrowserData();

   //--></SCRIPT>

<SCRIPT>
	if( self == top )
{
	location = "/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputfunctions/keybd_event.asp";
}

</SCRIPT>
<xml id=xmlPageContext><eyebrow findmenu="false">
	<item label="MSDN Home" url="/default.asp"/>
	<item label="MSDN Library" url="/library/default.asp"/>
	<item label="Win32 and COM Development" url="/library/en-us/dnanchor/html/anch_win32com.asp" id="msdnlib1365" xmlsrc="/library/en-us/toc/msdnlib/msdnlib1365_.xml"/><item label="User Interface" url="/library/en-us/dnanchor/html/anch_UIDesignDev.asp" id="msdnlib1841" xmlsrc="/library/en-us/toc/msdnlib/msdnlib1841_.xml"/><item label="Windows User Experience" id="msdnlib1863"/><item label="Windows Management" id="msdnlib1873"/><item label="Windows User Interface" url="/library/en-us/winui/winui/windowsuserinterface/windowui.asp" id="winui2" xmlsrc="/library/en-us/toc/winui/winui2_.xml"/><item label="User Input" url="/library/en-us/winui/winui/windowsuserinterface/userinput.asp" id="winui440" xmlsrc="/library/en-us/toc/winui/winui440_.xml"/><item label="Keyboard Input" url="/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput.asp" id="winui556"/><item label="Keyboard Input Reference" id="winui560" xmlsrc="/library/en-us/toc/winui/winui560_.xml"/><item label="Functions" id="winui561"/><item label="keybd_event" url="/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputfunctions/keybd_event.asp" id="winui577"/></eyebrow></xml><LINK 
href="keybd_event.files/css.aspx" type=text/css rel=stylesheet>
<SCRIPT language=javascript>
var doImage=doImage;var TType=TType;
function mhHover(tbl,idx,cls){var t,d;if(document.getElementById)t=document.getElementById(tbl);else t=document.all(tbl);if(t==null)return;if(t.getElementsByTagName)d=t.getElementsByTagName("TD");else d=t.all.tags("TD");if(d==null)return;if(d.length<=idx)return;d[idx].className=cls;}
function footerjs(doc){if(doImage==null){var tt=TType==null?"PV":TType;doc.write('<layer visibility="hide"><div style="display:none"><img src="http://c.microsoft.com/trans_pixel.asp?source=msdn&TYPE=' + tt + '&p=library_en-us_winui_winui_windowsuserinterface_userinput_keyboardinput_keyboardinputreference_keyboardinputfunctions_keybd&URI=%2flibrary%2ftoolbar%2f3.0%2fasp.aspx%3fmode%3dhead%26c%3d%2fnonlibraryshell.config%26h%3dmsdn%252Emicrosoft%252Ecom%26u%3d%252Flibrary%252Fen%252Dus%252Fwinui%252Fwinui%252Fwindowsuserinterface%252Fuserinput%252Fkeyboardinput%252Fkeyboardinputreference%252Fkeyboardinputfunctions%252Fkeybd%255Fevent%252Easp%26r%3d&GUID=1F4FC18C-F71E-47FB-8FC9-612F8EE59C61" width=0 height=0 hspace=0 vspace=0 border=0 /></div></layer>');}}
</SCRIPT>

<META content="MSHTML 6.00.2800.1491" name=GENERATOR></HEAD>
<BODY text=#000000 bgColor=#ffffff leftMargin=0 topMargin=0 MARGINWIDTH="0" 
MARGINHEIGHT="0">
<TABLE height=24 cellSpacing=0 cellPadding=4 width="100%" bgColor=#ffffff 
border=0>
  <TBODY>
  <TR>
    <TD class=eyebrow vAlign=center align=left width="100%">&nbsp;&nbsp; <A 
      class=small href="http://msdn.microsoft.com/default.asp" target=_top>MSDN 
      Home</A>&nbsp;&gt;&nbsp; <A class=small 
      href="http://msdn.microsoft.com/library/default.asp" target=_top>MSDN 
      Library</A>&nbsp;&gt;&nbsp; <A class=small 
      href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnanchor/html/anch_win32com.asp" 
      target=_top>Win32 and COM Development</A>&nbsp;&gt;&nbsp; <A class=small 
      href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnanchor/html/anch_UIDesignDev.asp" 
      target=_top>User Interface</A>&nbsp;&gt;&nbsp; <A class=small 
      href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/windowui.asp" 
      target=_top>Windows User Interface</A>&nbsp;&gt;&nbsp; <A class=small 
      href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/userinput.asp" 
      target=_top>User Input</A>&nbsp;&gt;&nbsp; <A class=small 
      href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput.asp" 
      target=_top>Keyboard Input</A>&nbsp;&gt;&nbsp;<A 
      href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputfunctions/"></A> 
    </TD></TR></TBODY></TABLE>
<TABLE class=clsContainer style="TABLE-LAYOUT: fixed" cellSpacing=0 
cellPadding=15 width="100%" border=0 float="left">
  <TBODY>
  <TR>
    <TD vAlign=top><!--TOOLBAR_START--><!--TOOLBAR_EXEMPT--><!--TOOLBAR_END--><!-- Begin Content -->
      <DIV class=clsDocBody>
      <H1>keybd_event Function</H1>
      <HR SIZE=1>
      </HR>
      <P>The <B>keybd_event</B> function synthesizes a keystroke. The system can 
      use such a synthesized keystroke to generate a <A 
      href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputmessages/wm_keyup.asp">WM_KEYUP</A> 
      or <A 
      href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputmessages/wm_keydown.asp">WM_KEYDOWN</A> 
      message. The keyboard driver's interrupt handler calls the 
      <B>keybd_event</B> function.
      <P><B>Windows NT/2000/XP:</B>This function has been superseded. Use <A 
      href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputfunctions/sendinput.asp">SendInput</A> 
      instead.</P>
      <P></P>
      <P class=clsRef>Syntax</P>
      <BLOCKQUOTE xmlns:xsl="http://www.w3.org/TR/WD-xsl"><PRE class=clsSyntax>VOID&nbsp;keybd_event(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;BYTE&nbsp;<I>bVk</I>,
&nbsp;&nbsp;&nbsp;&nbsp;BYTE&nbsp;<I>bScan</I>,
&nbsp;&nbsp;&nbsp;&nbsp;DWORD&nbsp;<I>dwFlags</I>,
&nbsp;&nbsp;&nbsp;&nbsp;PTR&nbsp;<I>dwExtraInfo</I>
);</PRE></BLOCKQUOTE>
      <P class=clsRef>Parameters</P>
      <BLOCKQUOTE>
        <DL>
          <DT><I>bVk</I>
          <DD>[in]&nbsp;Specifies a virtual-key code. The code must be a value 
          in the range 1 to 254. For a complete list, see <A 
          href="http://msdn.microsoft.com/library/en-us/winui/winui/WindowsUserInterface/UserInput/VirtualKeyCodes.asp">Virtual-Key 
          Codes</A>. 
          <DT><I>bScan</I>
          <DD>This parameter is not used. 
          <DT><I>dwFlags</I>
          <DD>[in]&nbsp;Specifies various aspects of function operation. This 
          parameter can be one or more of the following values. 
          <DL>
            <DT><SPAN class=clsLiteral>KEYEVENTF_EXTENDEDKEY</SPAN>
            <DD>If specified, the scan code was preceded by a prefix byte having 
            the value 0xE0 (224).
            <DT><SPAN class=clsLiteral>KEYEVENTF_KEYUP</SPAN>
            <DD>If specified, the key is being released. If not specified, the 
            key is being depressed.</DD></DL>
          <DT><I>dwExtraInfo</I>
          <DD>[in]&nbsp;Specifies an additional value associated with the key 
          stroke. </DD></DL></BLOCKQUOTE>
      <P class=clsRef>Return Value</P>
      <BLOCKQUOTE>
        <P>This function has no return value. </P><BR><BR></BLOCKQUOTE>
      <P class=clsRef>Remarks</P>
      <BLOCKQUOTE>
        <P>An application can simulate a press of the PRINTSCRN key in order to 
        obtain a screen snapshot and save it to the clipboard. To do this, call 
        <B>keybd_event</B> with the <I>bVk</I> parameter set to VK_SNAPSHOT. 
</P>
        <P><B>Windows NT/2000/XP:</B> The <B>keybd_event</B> function can toggle 
        the NUM LOCK, CAPS LOCK, and SCROLL LOCK keys. </P>
        <P><B>Windows 95/98/Me:</B> The <B>keybd_event</B> function can toggle 
        only the CAPS LOCK and SCROLL LOCK keys. It cannot toggle the NUM LOCK 
        key.</P>
        <P>The following sample program toggles the NUM LOCK light by using 
        keybd_event() with a virtual key of VK_NUMLOCK. It takes a Boolean value 
        that indicates whether the light should be turned off (FALSE) or on 
        (TRUE). The same technique can be used for the CAPS LOCK key 
        (VK_CAPITAL) and the SCROLL LOCK key (VK_SCROLL).</P>
        <P><PRE class=clsCode AUTOHILITE="1">   #include &lt;windows.h&gt;

   void SetNumLock( BOOL bState )
   {
      BYTE keyState[256];

      GetKeyboardState((LPBYTE)&amp;keyState);
      if( (bState &amp;&amp; !(keyState[VK_NUMLOCK] &amp; 1)) ||
          (!bState &amp;&amp; (keyState[VK_NUMLOCK] &amp; 1)) )
      {
      // Simulate a key press
         keybd_event( VK_NUMLOCK,
                      0x45,
                      KEYEVENTF_EXTENDEDKEY | 0,
                      0 );

      // Simulate a key release
         keybd_event( VK_NUMLOCK,
                      0x45,
                      KEYEVENTF_EXTENDEDKEY | KEYEVENTF_KEYUP,
                      0);
      }
   }

   void main()
   {
      SetNumLock( TRUE );
   }
</PRE>
        <P></P></BLOCKQUOTE>
      <P class=clsRef>Function&nbsp;Information</P>
      <BLOCKQUOTE>
        <TABLE class=clsStd>
          <TBODY>
          <TR>
            <TH>Minimum DLL Version</TH>
            <TD><SPAN class=clsFmtDLL>user32.dll</SPAN></TD></TR>
          <TR>
            <TH>Header</TH>
            <TD>Declared in <SPAN class=clsFmtInc>Winuser.h</SPAN>, include 
              <SPAN class=clsFmtInc>Windows.h</SPAN></TD></TR>
          <TR>
            <TH>Import library</TH>
            <TD><SPAN class=clsFmtLib>User32.lib</SPAN></TD></TR>
          <TR>
            <TH>Minimum operating systems</TH>
            <TD>Windows&nbsp;95, Windows 
      NT&nbsp;3.1</TD></TR></TBODY></TABLE></BLOCKQUOTE>
      <P class=clsRef>See Also</P>
      <BLOCKQUOTE><A 
        href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput.asp">Keyboard 
        Input</A>, <A 
        href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputfunctions/getasynckeystate.asp">GetAsyncKeyState</A>, 
        <A 
        href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputfunctions/getkeystate.asp">GetKeyState</A>, 
        <B>keybd_event</B>, <A 
        href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputfunctions/mapvirtualkey.asp">MapVirtualKey</A>, 
        <A 
        href="http://msdn.microsoft.com/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputfunctions/setkeyboardstate.asp">SetKeyboardState</A></BLOCKQUOTE></DIV>
      <DIV class=clsFooter>
      <HR SIZE=1>
      <BR></DIV><!-- End Content --></TD></TR></TBODY></TABLE><BR 
style="OVERFLOW: hidden; LINE-HEIGHT: 1px" clear=all>
<TABLE id=msviFooter cellSpacing=0 cellPadding=0 width="100%">
  <TBODY>
  <TR vAlign=bottom>
    <TD id=msviFooter2 
    style="FILTER: progid:DXImageTransform.Microsoft.Gradient(startColorStr='#FFFFFF', endColorStr='#669AFF', gradientType='1')">
      <DIV id=msviLocalFooter><NOBR><A 
      href="http://go.microsoft.com/?linkid=317027">Manage Your Profile</A> 
      |</NOBR><WBR><NOBR><A 
      href="http://msdn.microsoft.com/isapi/gomscom.asp?target=/legal/" 
      target=_parent>Legal</A> |</NOBR><WBR><NOBR><A 
      href="http://go.microsoft.com/?linkid=2028439" target=_parent>Contact 
      Us</A> |</NOBR><WBR><NOBR><A href="http://msdn.microsoft.com/flash/" 
      target=_parent>MSDN Flash Newsletter</A></NOBR></DIV>
      <DIV id=msviGlobalFooter><SPAN dir=ltr>© 2005 Microsoft Corporation. All 
      rights reserved.&nbsp;</SPAN><NOBR><A 
      href="http://www.microsoft.com/info/cpyright.mspx">Terms of Use</A> 
      |</NOBR><WBR><NOBR><A 
      href="http://msdn.microsoft.com/library/toolbar/3.0/trademarks/en-us.mspx">Trademarks</A> 
      |</NOBR><WBR><NOBR><A 
      href="http://www.microsoft.com/info/privacy.mspx">Privacy 
      Statement</A></NOBR></DIV></TD>
    <TD width=105 bgColor=#669aff><IMG title="" height=29 alt=Microsoft 
      src="keybd_event.files/text.jpg" width=105 border=0></TD></TR></TBODY></TABLE>
<SCRIPT language=javascript>var msviFooter2;if (document.getElementById){msviFooter2 = document.getElementById("msviFooter2");msviFooter2.style.filter = "";}</SCRIPT>

<TABLE height=58 cellSpacing=0 cellPadding=0 width="100%">
  <TBODY>
  <TR vAlign=top>
    <TD>
      <DIV style="WIDTH: 200px"></DIV></TD>
    <TD 
    style="FILTER: progid:DXImageTransform.Microsoft.Gradient(startColorStr='#FFFFFF', endColorStr='#669AFF', gradientType='1')" 
    width="100%"></TD></TR></TBODY></TABLE>
<SCRIPT language=javascript>footerjs(document);</SCRIPT>
</BODY></HTML>
