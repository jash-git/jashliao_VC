<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0047)http://www.vckbase.com/document/viewdoc/?id=419 -->
<HTML><HEAD><TITLE>VC知识库文章 - 如何有效地使用对话框</TITLE>
<META http-equiv=Content-Type content="text/html; charset=gb2312">
<META content=RepositionBars,SetWindowRgn,SetPaneInfo,dialog,对话框 name=keywords>
<META content=RepositionBars,SetWindowRgn,SetPaneInfo,dialog,对话框 
name=description><LINK href="如何有效的使用υ方K_1.files/style.css" rel=stylesheet>
<META content="MSHTML 6.00.2900.5512" name=GENERATOR></HEAD>
<BODY bgColor=#ffffff leftMargin=0 topMargin=0>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR bgColor=#a0d39b>
    <TD width="14%" height=78>&nbsp;<IMG height=13 
      src="如何有效的使用υ方K_1.files/vckcom.gif" width=109></TD>
    <TD align=left width="76%">
      <SCRIPT type=text/javascript><!--
google_ad_client = "pub-4159669282587342";
/* 728x90, 创建于 09-4-19 */
google_ad_slot = "4947706540";
google_ad_width = 728;
google_ad_height = 90;
//-->
</SCRIPT>

      <SCRIPT src="如何有效的使用υ方K_1.files/show_ads.js" type=text/javascript>
</SCRIPT>
    </TD>
    <TD vAlign=bottom align=right height=78><IMG height=27 
      src="如何有效的使用υ方K_1.files/earch.gif" width=89></TD></TR>
  <TR bgColor=#eeeeee>
    <TD colSpan=2><FONT class=small color=#333333>::</FONT><A 
      href="http://www.vckbase.com/"><FONT color=black><SPAN 
      class=small>首页</SPAN></FONT></A> &gt;&gt; <A 
      href="http://www.vckbase.com/document"><FONT color=black><SPAN 
      class=small>文档中心</SPAN></FONT></A> &gt;&gt; <A 
      href="http://www.vckbase.com/document/journal"><SPAN class=small><FONT 
      color=black>在线杂志</FONT></SPAN></A> &gt;&gt; <A 
      href="http://www.vckbase.com/document/listdoc.asp?sclsid=501"><SPAN 
      class=small><FONT color=black>对话框</FONT></SPAN></A></TD>
    <TD class=small align=right width="10%">[ <A 
      href="http://www.vckbase.com/document/journal/redir.asp?journal=14"><SPAN 
      class=small><FONT color=black>在线杂志 第14期</FONT></SPAN></A> ] 
</TD></TR></TBODY></TABLE>
<DIV align=center><BR><A href="http://www.uipower.com/" target=_blank><IMG 
height=125 src="如何有效的使用υ方K_1.files/skin2.jpg" width=830 border=0></A> 
</DIV><BR>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD background=如何有效的使用υ方K_1.files/dotline2.gif 
height=1></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD width=40 height=74></TD>
    <TD vAlign=top width=* height=74>
      <FORM name=form2 action=/SYS/script/find.asp method=post>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD><SPAN id=docinfo>[ <FONT color=#009900>翻译文档</FONT> 本文适合初级读者 
            已阅读32456次 ]</SPAN></TD>
          <TD align=right><INPUT class=rect maxLength=20 size=10 name=keyword> 
            <SELECT class=rect name=gclsid> <OPTION value=100 
              selected>文档</OPTION> <OPTION value=200>代码</OPTION> <OPTION 
              value=400>工具</OPTION></SELECT> <INPUT type=image height=15 width=21 
            src="如何有效的使用υ方K_1.files/go.gif" align=absMiddle border=0 
            name=imageField> </TD></TR></TBODY></TABLE></FORM>
      <DIV align=center>
      <SCRIPT type=text/javascript><!--
google_ad_client = "pub-4159669282587342";
/* 728x15, 创建于 09-4-19 */
google_ad_slot = "9155085061";
google_ad_width = 728;
google_ad_height = 15;
//-->
</SCRIPT>

      <SCRIPT src="如何有效的使用υ方K_1.files/show_ads.js" type=text/javascript>
</SCRIPT>
      </DIV><BR>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD>
            <P align=center><STRONG>如何有效地使用对话框</STRONG><BR><A 
            href="mailto:jingzhou_xu@163.net">译者：徐景周</A>(原作：<A 
            href="http://www.codeproject.com/script/articles/mailauthor.asp?guid=Dialog%5Ftips%2Fdialog6%2F29%2F2002" 
            target=_blank>VGirish</A>) </P>
            <P><STRONG><IMG height=16 src="如何有效的使用υ方K_1.files/paragraph.gif" 
            width=14> Q:如何在对话框中加入工具条</STRONG></P>在 OnInitDialog 中加入下面代码： <PRE>BOOL CYourDlg::OnInitDialog()
{
       CDialog::OnInitDialog();	

       // Create the toolbar. To understand the meaning of the styles used, you 
       // can take a look at the MSDN for the Create function of the CToolBar class.
	   
       ToolBar.Create(this, WS_CHILD | WS_VISIBLE | CBRS_TOP | CBRS_TOOLTIPS |CBRS_FLYBY | CBRS_BORDER_BOTTOM);

      // I have assumed that you have named your toolbar''s resource as IDR_TOOLBAR1.
      // If you have given it a different name, change the line below to accomodate 
      // that by changing the parameter for the LoadToolBar function.
	  
      ToolBar.LoadToolBar(IDR_TOOLBAR1);
  
      CRect rcClientStart;
      CRect rcClientNow;
      GetClientRect(rcClientStart);


      // To reposition and resize the control bar

     RepositionBars(AFX_IDW_CONTROLBAR_FIRST, AFX_IDW_CONTROLBAR_LAST,0, reposQuery, rcClientNow);
     CPoint ptOffset(rcClientNow.left - rcClientStart.left,rcClientNow.top-rcClientStart.top);

     CRect rcChild;
     CWnd* pwndChild = GetWindow(GW_CHILD);

     while (pwndChild)
     {
       pwndChild-&gt;GetWindowRect(rcChild);
       ScreenToClient(rcChild);
       rcChild.OffsetRect(ptOffset);
       pwndChild-&gt;MoveWindow(rcChild, FALSE);
       pwndChild = pwndChild-&gt;GetNextWindow();
     } 
	  CRect rcWindow;
     GetWindowRect(rcWindow);
     rcWindow.right += rcClientStart.Width() - rcClientNow.Width();
     rcWindow.bottom += rcClientStart.Height() - rcClientNow.Height();
     MoveWindow(rcWindow, FALSE);	

     // And position the control bars
     RepositionBars(AFX_IDW_CONTROLBAR_FIRST, AFX_IDW_CONTROLBAR_LAST, 0);
  
     return TRUE;  // return TRUE  unless you set the focus to a control
  }

</PRE><STRONG><IMG height=16 src="如何有效的使用υ方K_1.files/paragraph.gif" 
            width=14> Q:如何改变对话框的形状？</STRONG><BR><BR>可用下面一些函数： 
            <BR>CreatePolygonRgn<BR>CreateRectRgn<BR>CreateRoundRectRgn 等. <PRE>  CRgn m_rgn;  // Put this in your dialog''s header file. i.e. a member variable

  // This Gets the size of the Dialog: This piece of code is to be placed in the
  // OnInitDialog Function of your dialog.

  CRect rcDialog
  GetClientRect(rcDialog);

  // The following code Creates the area and assigns it to your Dialog
  m_rgn.CreateEllipticRgn(0, 0, rcDialog.Width(), rcDialogHeight());
  SetWindowRgn(GetSafeHwnd(), (HRGN) m_rgn, TRUE);
</PRE><STRONG><IMG height=16 src="如何有效的使用υ方K_1.files/paragraph.gif" 
            width=14> Q：如何实现非客户区移动？</STRONG><BR><BR>可用下面二种方法<PRE>// Handler for WM_LBUTTONDOWN message

  void CYourDialog::OnLButtonDown(UINT nFlags, CPoint point)
  {
     CDialog::OnLButtonDown(nFlags, point);
     PostMessage( WM_NCLBUTTONDOWN, HTCAPTION, MAKELPARAM( point.x, point.y));
  }

  // Handler for WM_NCHITTEST message

  LONG CYourDialog::OnNcHitTest( UINT uParam, LONG lParam )
  {  
     int xPos = LOWORD(lParam);
     int yPos = HIWORD(lParam);
     UINT nHitTest = CDialog::OnNcHitTest(CSize(xPos, yPos));
     return (nHitTest == HTCLIENT) ? HTCAPTION : nHitTest;
  }
</PRE><BR><STRONG><IMG height=16 
            src="如何有效的使用υ方K_1.files/paragraph.gif" width=14> 
            Q:如何使对话框初始为最小化状态？</STRONG><BR><BR>在 OnInitDialog 中加入下面代码：<PRE>SendMessage(WM_SYSCOMMAND, SC_MAXIMIZE, NULL);</PRE><STRONG><IMG 
            height=16 src="如何有效的使用υ方K_1.files/paragraph.gif" width=14> 
            Q:如何限定对话框大小范围？</STRONG><BR><BR>在 WM_SIZING中加入下面代码：<PRE>void CYourDialog::OnSizing(UINT fwSide, LPRECT pRect) 
  {
     if(pRect-&gt;right - pRect-&gt;left &lt;=200)
     	pRect-&gt;right = pRect-&gt;left + 200;
	
     if(pRect-&gt;bottom - pRect-&gt;top &lt;=200)
     	pRect-&gt;bottom = pRect-&gt;top + 200;

     CDialog::OnSizing(fwSide, pRect);
  }
</PRE><STRONG><IMG height=16 src="如何有效的使用υ方K_1.files/paragraph.gif" 
            width=14> Q:如何在对话框中加入状态条？</STRONG><BR><BR>定义 CStatusBar 变量：<PRE>CStatusBar m_StatusBar;</PRE>定义状态条指定状态：<PRE>static UINT BASED_CODE indicators[] =
  {
     ID_INDICATOR_CAPS,
     ID_INDICATOR_NUM
  };
</PRE>在 OnInitDialog 中加入下面代码： <PRE>  m_StatusBar.CreateEx(this,SBT_TOOLTIPS,WS_CHILD|WS_VISIBLE|CBRS_BOTTOM,AFX_IDW_STATUS_BAR);
 
  // Set the indicators namely caps and nums lock status
  m_StatusBar.SetIndicators(indicators,sizeof(indicators)/sizeof(UINT));

  CRect rect;
  GetClientRect(&amp;rect);
		
  m_StatusBar.SetPaneInfo(0,ID_INDICATOR_CAPS,SBPS_NORMAL,rect.Width()/2);
  m_StatusBar.SetPaneInfo(1,ID_INDICATOR_NUM,SBPS_STRETCH ,rect.Width()/2);

  RepositionBars(AFX_IDW_CONTROLBAR_FIRST,AFX_IDW_CONTROLBAR_LAST,ID_INDICATOR_NUM);

  m_StatusBar.GetStatusBarCtrl().SetBkColor(RGB(180,180,180));
</PRE><BR></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR>
<DIV align=center>
<SCRIPT type=text/javascript><!--
google_ad_client = "pub-4159669282587342";
/* 728x90, 创建于 09-4-19 */
google_ad_slot = "9400561186";
google_ad_width = 728;
google_ad_height = 90;
//-->
</SCRIPT>

<SCRIPT src="如何有效的使用υ方K_1.files/show_ads.js" type=text/javascript>
</SCRIPT>
</DIV><BR><BR>
<TABLE class=small height=18 cellSpacing=0 cellPadding=0 width="98%" border=0>
  <TBODY>
  <TR vAlign=center>
    <TD width="47%" bgColor=#a0d39b><IMG height=10 
      src="如何有效的使用υ方K_1.files/toplogo.gif" width=10>最新评论 <A 
      href="http://www.vckbase.com/SYS/script/viewcomment.asp?gclsid=100&amp;itemid=419" 
      target=_blank><SPAN class=small>[发表评论]</SPAN></A> <A 
      href="http://www.vckbase.com/support/contribute.html" target=_blank><SPAN 
      class=small>[文章投稿]</SPAN></A></TD>
    <TD align=right width="53%" bgColor=#a0d39b><IMG height=9 
      src="如何有效的使用υ方K_1.files/rec1.gif" width=9> <A 
      href="http://www.vckbase.com/SYS/script/viewcomment.asp?gclsid=100&amp;itemid=419" 
      target=_blank><SPAN class=small>查看所有评论</SPAN></A> <IMG height=9 
      src="如何有效的使用υ方K_1.files/rec1.gif" width=9> <A 
      href="http://www.vckbase.com/SYS/script/writemail.asp?gclsid=100&amp;itemid=419&amp;title=%c8%e7%ba%ce%d3%d0%d0%a7%b5%d8%ca%b9%d3%c3%b6%d4%bb%b0%bf%f2" 
      target=_blank><SPAN class=small>推荐给好友</SPAN></A> <IMG height=9 
      src="如何有效的使用υ方K_1.files/rec1.gif" width=9> <A 
      href="javascript:window.print();"><SPAN 
  class=small>打印</SPAN></A></TD></TR></TBODY></TABLE>
<TABLE class=small cellSpacing=1 cellPadding=0 width="98%" bgColor=#ffffff 
border=0>
  <TBODY>
  <TR>
    <TD bgColor=#ffffff><BR><IMG height=11 src="如何有效的使用υ方K_1.files/doc2.gif" 
      width=11 align=absMiddle> 
      你好周老师帮忙看看<BR>vc++&nbsp;第一个组合框的内容(根据数据库所得)是第二个组合框的内容的条件 ( wangsir888 发表于 
      2008-4-25 15:11:00)<BR>&nbsp;<BR><IMG height=11 
      src="如何有效的使用υ方K_1.files/doc2.gif" width=11 align=absMiddle> 
      对话框初始为最小化状态也可以用showwindow ( lmai111 发表于 2005-9-28 
      0:10:00)<BR>&nbsp;<BR><IMG height=11 src="如何有效的使用υ方K_1.files/doc2.gif" 
      width=11 align=absMiddle> good! ( ataihero 发表于 2003-9-19 
      16:24:00)<BR>&nbsp;<BR><IMG height=11 src="如何有效的使用υ方K_1.files/doc2.gif" 
      width=11 align=absMiddle> 很有用 ( renqiang1028 发表于 2003-5-13 
      22:52:00)<BR>&nbsp;<BR><IMG height=11 src="如何有效的使用υ方K_1.files/doc2.gif" 
      width=11 align=absMiddle> 
      不错啊，书本再好，也不像这样有总结性，<BR>我已经将全文抄在了我自己的笔记本上，以便日后查取<BR>谢谢景周大哥！<BR>对于别人闲言闲语，大可不必理会，因为你做的事情是有积极意义的，特别是对于我们才入门的人来说。<BR>希望以后能看到你的更好的作品。 
      ( pjs_th 发表于 2003-3-24 14:52:00)<BR>&nbsp;<BR><IMG height=11 
      src="如何有效的使用υ方K_1.files/doc2.gif" width=11 align=absMiddle> 
      景周大哥：我想在对话框中引用一个在视图类中的定义的变量，即全局变量，方法如下：<BR>这个问题是大家很关心的问题.<BR>下面做如下解释:<BR>1)首先在一个.cpp中定义一个你要使的变量,如:<BR>&nbsp;&nbsp;&nbsp;int&nbsp;m_Extern;<BR>2)在别的.cpp中(你要用到m_Extern的地方)加入:<BR>&nbsp;&nbsp;&nbsp;extern&nbsp;int&nbsp;m_Extern;<BR>即可.(对所有类型都适合)<BR><BR>可是我按上述方法做不好使，为什末？<BR>大哥：不好使呀，错误如下：<BR>Linking...<BR>PicView.obj&nbsp;:&nbsp;error&nbsp;LNK2001:&nbsp;unresolved&nbsp;external&nbsp;symbol&nbsp;"class&nbsp;CString&nbsp;&nbsp;vID"&nbsp;(?vID@@3VCString@@A)<BR>Debug/抚顺市开发区.exe&nbsp;:&nbsp;fatal&nbsp;error&nbsp;LNK1120:&nbsp;1&nbsp;unresolved&nbsp;externals<BR>Error&nbsp;executing&nbsp;link.exe.<BR>请速指教！！！谢谢!!!!<BR>( 
      songgh 发表于 2002-12-7 14:42:00)<BR>&nbsp;<BR><IMG height=11 
      src="如何有效的使用υ方K_1.files/doc2.gif" width=11 align=absMiddle> 
      希望多为我们这些菜鸟提供一些这样的文章，非常感谢！ ( lyljp 发表于 2002-10-16 
      19:35:00)<BR>&nbsp;<BR><IMG height=11 src="如何有效的使用υ方K_1.files/doc2.gif" 
      width=11 align=absMiddle> 谢谢，像我这样菜鸟级的太希望多一点这样的文章了，再接再厉，不要让我们失望哦！：） ( hawk 
      发表于 2002-9-27 9:33:00)<BR>&nbsp;<BR><IMG height=11 
      src="如何有效的使用υ方K_1.files/doc2.gif" width=11 align=absMiddle> good ( 学术志圣 
      发表于 2002-9-23 20:21:00)<BR>&nbsp;<BR><IMG height=11 
      src="如何有效的使用υ方K_1.files/doc2.gif" width=11 align=absMiddle> 
      人家说明了是给初级读者看的，你觉得很浅那你就别来看呀，那么多话，讨厌！ ( Thornbird 发表于 2002-9-20 
      13:14:00)<BR>&nbsp;<BR>.......................................................<BR><A 
      href="http://www.vckbase.com/SYS/script/viewcomment.asp?gclsid=100&amp;itemid=419" 
      target=_blank><SPAN class=small>More...</SPAN></A> 
</TD></TR></TBODY></TABLE><BR>
<DIV align=right><BR><SPAN class=small>版权所有 &copy; 1999 - 2009 VC知识库&nbsp;
<SCRIPT language=JavaScript src="如何有效的使用υ方K_1.files/stat.htm" 
charset=gb2312></SCRIPT>
 <BR><BR></SPAN></DIV></BODY></HTML>
