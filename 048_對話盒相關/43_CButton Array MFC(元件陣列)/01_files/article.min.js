function UpdateArticleEditStatus(f,b,c,e){var a=$("#"+c);var d=a.html();a.html('<img src="/Images/animated_loading_blue.gif" align="absmiddle" />');$.ajax({type:"POST",cache:false,url:b,data:"{articleId: "+f+"}",contentType:"application/json; charset=utf-8",dataType:"json",tryCount:0,retryLimit:3,timeout:5000,success:function(g){a.remove();$("#"+e).html(g.d)},error:function(g,j,h){a.html(d);$("#"+e).html("Error")}});return false}function WrapMe(e,g,d,h){var j;var c="";var b=0;var f=e.toLowerCase();var a=g.length;g=g.toLowerCase();while((j=f.indexOf(g,b))>=0){c+=e.substr(b,j-b);c+=d+e.substr(j,a)+h;b=j+a}c+=e.substr(b);return c}function markText(f,b){var d='<span class="search-highlight">';var g="</span>";var a=new RegExp("(<[^>][^<]*>)([^<]*)","g");var e;var c=new String("");while((e=a.exec(b.toString()))!=null){c+=e[1];c+=WrapMe(e[2],f,d,g)}return c}function unmarkText(b,a){elemObj=document.getElementById(b);if(elemObj){var c=new RegExp('<span class="?search-highlight"?>([^<]*)?</span>',"gi");elemObj.parentNode.innerHTML=elemObj.parentNode.innerHTML.replace(c,"$1")}if(a){elemObj=document.getElementById(a);if(elemObj){elemObj.className+=" hidden"}}}function markTextInElement(a,b){elemObj=document.getElementById(b);if(elemObj){elemObj.parentNode.innerHTML=markText(a,elemObj.parentNode.innerHTML)}}function social(){this.txtVersion="1.2";this.addtoInterval=null;this.popupWin="";this.addtoMethod=1;this.AddTitle=null;this.AddURL=null;this.Horizontal=false;this.Showname=false;this.ObjectTypeId=0;this.ObjectId=0;this.PlaceholderId="";this.sns=[{name:"Twitter",image:"AddTo_Twitter.gif",url:"http://twitter.com/home?",urlVar:"status",titleVar:"",noteVar:"",urlPre:"Currently reading ",returnVar:"",otherVars:""},{name:"Digg",image:"AddTo_Digg.png",url:"http://digg.com/submit?",urlVar:"url",titleVar:"",noteVar:"",urlPre:"",returnVar:"",otherVars:"&phase=2"},{name:"Facebook",image:"AddTo_Facebook.png",url:"http://www.facebook.com/sharer.php?",urlVar:"u",titleVar:"t",noteVar:"",urlPre:"",returnVar:"",otherVars:""},{name:"Del.icio.us",image:"AddTo_Delicious.png",url:"http://del.icio.us/post?",urlVar:"url",titleVar:"title",noteVar:"",urlPre:"",returnVar:"",otherVars:""},{name:"Reddit",image:"AddTo_Reddit.png",url:"http://reddit.com/submit?",urlVar:"url",titleVar:"title",noteVar:"",urlPre:"",returnVar:"",otherVars:""},{name:"Stumbleupon",image:"AddTo_stumbleupon.png",url:"http://www.stumbleupon.com/submit?",urlVar:"url",titleVar:"title",noteVar:"",urlPre:"",returnVar:"",otherVars:""},{name:"Newsvine",image:"AddTo_Newsvine.png",url:"http://www.newsvine.com/_wine/save?",urlVar:"u",titleVar:"",noteVar:"",urlPre:"",returnVar:"",otherVars:"&popoff=0"},{name:"Technorati",image:"AddTo_Technorati.png",url:"http://technorati.com/faves?",urlVar:"add",titleVar:"",noteVar:"",urlPre:"",returnVar:"",otherVars:""},{name:"Mr. Wong",image:"AddTo_MrWong.png",url:"http://www.mister-wong.com/index.php?",urlVar:"bm_url",titleVar:"bm_description",noteVar:"",urlPre:"",returnVar:"",otherVars:"&action=addurl"},{name:"Yahoo!",image:"AddTo_Yahoo.png",url:"http://myweb2.search.yahoo.com/myresults/bookmarklet?",urlVar:"u",titleVar:"t",noteVar:"",urlPre:"",returnVar:"",otherVars:"&d=&ei=UTF-8"},{name:"Google",image:"AddTo_Google.png",url:"http://www.google.com/bookmarks/mark?",urlVar:"bkmk",titleVar:"title",noteVar:"",urlPre:"",returnVar:"",otherVars:"&op=edit"},{name:"Windows Live",image:"AddTo_Live.png",url:"https://favorites.live.com/quickadd.aspx?",urlVar:"url",titleVar:"title",noteVar:"",urlPre:"",returnVar:"",otherVars:"&marklet=1&mkt=en-us&top=1"},{name:"Send as Email",image:"envelope.gif",url:"/script/common/TellFriend.aspx?obtid={0}&obid={1}&",urlVar:"",titleVar:"",noteVar:"",prefix:"",returnVar:"",otherVars:""}];this.DrawLink=function(a,c,d){var e=(c==(this.sns.length-1))?"":"Add this page to ";var b='<a class="'+d+'" title="'+e+this.sns[c].name+'" onclick="return '+a+".addto("+c.toString()+');" href="#"><img align="absmiddle" src="/images/'+this.sns[c].image+'" width="16px" height="16px" border="0" /> ';if(this.Showname){b+=this.sns[c].name}return b+"</a> "};this.setupLinks=function(e,a,d,f,j,g,b){var c,h="";this.AddTitle=d;this.AddURL=a;if(f>this.sns.length){if(this.Horizontal){h+='<span class="'+g+'">Add this article to: </span> '}for(c=0;c<this.sns.length;c++){if(!this.Horizontal){h+="<div>"}h+=this.DrawLink(e,c,b);h+=(this.Horizontal?" ":"</div>")}}else{h+='<table width="'+j.toString()+'" border="0" cellspacing="0" cellpadding="0"><tr><tr><td colspan="'+f.toString()+'" class="'+g+'" height="20">Add this article to:</td></tr>\n';for(c=0;c<this.sns.length;c++){h+='<td valign="middle">';h+=this.DrawLink(e,c,b);h+="</td>";if((((c+1)%f)==0)&&(c!=(this.sns.length-1))){h+="</tr><tr>"}}h+="</td></tr></table>"}if($("#ATD")[0]){$("#ATD")[0].innerHTML=h}};this.addtoWin=function(a){if(this.popupWin&&!this.popupWin.closed&&this.popupWin.location){this.popupWin.location.href=a}else{this.popupWin=window.open(a,"addtoPopUp","width=770px,height=500px,menubar=1,toolbar=1,status=1,location=1,resizable=1,scrollbars=1,left=0,top=100");if(!this.popupWin.opener){this.popupWin.opener=self}}if(window.focus){this.popupWin.focus()}return false};this.closeAddTo=function(){if(!this.popupWin.closed&&this.popupWin.location){if(this.popupWin.location.href==this.AddURL){this.popupWin.close()}}else{clearInterval(this.addtoInterval);return true}};this.addto=function(b){if(!this.AddURL){this.AddURL=document.location.href}if(!this.AddTitle){this.AddTitle=escape(document.title)}var a=this.sns[b].url.replace("{0}",this.ObjectTypeId.toString());a=a.replace("{1}",this.ObjectId.toString());var c=a;c+=this.sns[b].urlVar+"="+escape(this.sns[b].urlPre)+this.AddURL;if(this.sns[b].titleVar!=""){c+="&"+this.sns[b].titleVar+"="+this.AddTitle}c+=this.sns[b].otherVars;if(this.sns[b].noteVar!=""){c+="&"+this.sns[b].noteVar+"="+this.AddTitle}if(this.sns[b].returnVar!=""){c+="&"+this.sns[b].returnVar+"="+this.AddURL}switch(this.addtoMethod){case 0:self.location=c;break;case 1:this.addtoWin(c);break;default:}return false};this.setupMenu=function(){var a=false;$(document).ready(function(){var j=$("#SBI"),d=$("#ATD");if(!j.length||!d.length){return}var b=$(j).position();var k=$(j).outerWidth();var c=$(d).outerWidth();var g=$(j).outerHeight();var f=(b.left+(k-c)/2)+"px";var h=g+b.top+"px";$(d).css({left:f,top:h});$(j).hover(function(){$(d).stop(true,true).fadeIn("fast")},function(){setTimeout(function(){if(!a){$("#ATD").fadeOut("fast")}},200)});$(d).hover(function(){a=true},function(){a=false;$(d).fadeOut("fast")})})}}function InitWatermark(c,b){var a=$("#"+c);if(!a){return}a.blur(function(){UpdateWatermark(this,b)});a.focus(function(){UpdateWatermark(this,b)});var d=$.trim(a.val());if(d==""||d==b){a.val(b);a.addClass("subdue")}else{if(d!=""&&d!=b){a.removeClass("subdue")}}}function UpdateWatermark(a,b){if(!a){return}var c=$.trim($(a).val());if(c==b&&$(a).hasClass("subdue")){$(a).val("");$(a).removeClass("subdue")}else{if(c==""&&!$(a).hasClass("subdue")){$(a).val(b);$(a).addClass("subdue")}else{$(a).removeClass("subdue")}}}function NavBarMenu(varName){var self=this;var openTimeout=100;var closeTimeout=500;var openTimer=0;var closeTimer=0;var openMenuItem=0;var hoverMenuItem=0;var myName=varName;var CancelTimer=function(){if(openTimer){window.clearTimeout(openTimer);openTimer=null}};var OpenMenu=function(){CancelTimer();CloseMenu();if(hoverMenuItem){openMenuItem=$(hoverMenuItem).addClass("open")}};var CloseMenu=function(){if(openMenuItem){if(openMenuItem.attr("over")||openMenuItem.find("[over=true]").length>0){return}openMenuItem.removeClass("open");openMenuItem.parents("[over!=true].open").removeClass("open")}if(openMenuItem){var openParents=openMenuItem.parents("[over=true]");openMenuItem=(openParents.length>0)?$(openParents[0]):null}};var ScheduleOpen=function(){hoverMenuItem=this;openTimer=window.setTimeout(OpenMenu,openMenuItem?0:openTimeout)};var ScheduleClose=function(){hoverMenuItem=0;closeTimer=window.setTimeout(CloseMenu,closeTimeout)};if($.support.opacity){$(document).ready(function(){eval(myName+".InitMenu();")}).click(self.CloseMenu)}this.InitMenu=function(){$(".navmenu li.openable").removeClass("openable").hover(ScheduleOpen,ScheduleClose);$(".navmenu li").hover(function(e){$(this).attr("over","true")},function(e){$(this).removeAttr("over")})};this.ShowMap=function(prnt,elmId){var map=$("#"+elmId);if(!prnt.populated&&!prnt.populating){prnt.populating=true;map.css({height:"200px",width:"100px"});map.load("/script/content/Ajax/SiteMap.aspx",function(){prnt.populated=true});window.setTimeout(this.InitMenu,200);prnt.populated=true;prnt.populating=false}if(prnt.populated){this.InitMenu();map.css("margin","0");map.css("width","auto");map.css("height","auto")}}}var navBarMenu=new NavBarMenu("navBarMenu");function NotificationAlert(b,d,g){var c=this;var f=$("#"+b);var e=$("#"+d);var h=g;var a=function(){if(!f.populated&&!f.populating){f.populating=true;e.load(h,{cache:false},function(){f.populated=true});f.populated=true;f.populating=false}};this.MarkAsRead=function(o,l,m,k){var j=$("#"+m);var n=j.html();j.html('<img src="/Images/animated_loading_blue.gif" align="absmiddle" style="border:0" />');$.ajax({type:"POST",cache:false,url:l,data:"{notificationId: "+o+"}",contentType:"application/json; charset=utf-8",dataType:"json",tryCount:0,retryLimit:3,timeout:5000,success:function(){j.remove();$("#"+k).children().first().removeClass("bold")},error:function(){j.html(n)}});return false};this.initialise=function(){$(f).bind("mouseover",a)}}function rateItem(j,h,b,g,c,f,e){if(j>0&&h>0){var a=$("div[name=RateItem_"+j+"]").find("input[type=radio]:checked").val();var d=$("[name=RateItem_"+j+"] .RateComment")[0];if(d){d=d.value.replace(/^\s+|\s+$/g,"")}else{d=""}if(a<=0){ShowErrorMessage("You must select a value to vote",j)}else{if(a<=f&&d==""&&g&&c){ShowErrorMessage("You must provide a comment",j)}else{if(c||a>f){PrepElements(j);$.get("/Script/Ratings/Ajax/RateItem.aspx?obid="+j+"&obtid="+h+"&obstid="+b+"&rvv="+a+"&rvc="+escape(d)+(e?"&rdm="+e:""),function(k){ratingAjaxCallback(k,j)})}}}}return false}function ratingAjaxCallback(b,a){if(b.length>0){var c=$("div[name=RateItem_"+a+"] .voteRes")[0];if(c){c.innerHTML=b;c.style.display=""}c=$("[name=CurRat_"+a+"]")[0];if(c){c.style.display="none"}}var d=$("div[name=RateItem_"+a+"] .loaderImg")[0];$("div[name=RateItem_"+a+"] .ajaxHist").remove();if(d&&d.style){d.style.display="none"}}function PrepElements(b){var a=$("div[name=RateItem_"+b+"] .loaderImg")[0];if(a&&a.style.display=="none"){a.style.display=""}a=$("div[name=RateItem_"+b+"] .voteTbl")[0];if(a){a.style.display="none"}a=$("div[name=RateItem_"+b+"] .voteRes")[0];if(a){a.style.display="none"}a=$("div[name=RateItem_"+b+"] .rating-comment")[0];if(a){a.style.display="none"}}function ShowErrorMessage(b,a){var c=$("div[name=RateItem_"+a+"] .loaderImg")[0];if(c){c.style.display="none"}}function starRating(c,d){var a=function(e,f){$(e).each(function(){$(this).find("input:submit").hide();if($(".content",this).length>0){$(this).find(".voting").hide();$(this).hover(function(){$(".content",this).hide();$(".voting",this).show()},function(){$(".content",this).show();$(".voting",this).hide()})}var g=$('<div class="rating-star-block"></div>');$(this).find("input:radio").each(function(h){var k="vote "+this.value;var j=$('<a href="#"></a>').attr("title",k).attr("rating",this.value).text(k).addClass("star outline");b(j);g.append(j);if($(this).is(":checked")){j.prevAll().andSelf().removeClass("outline").addClass("filled")}});$(this).find(".voting").append(g).find("input:radio").hide()})};var b=function(e){$(e).click(function(j){var g=$(this);var h=$(this).parent();var f=g.attr("rating");h.parent().find("input:radio[value="+f+"]").attr("checked",true);j.preventDefault();if(d){d(f)}else{$(this).closest("form").submit()}}).hover(function(){$(this).prevAll().andSelf().removeClass("outline").addClass("filled");$(this).nextAll().addClass("outline")},function(){$(this).siblings().andSelf().removeClass("filled").addClass("outline")})};a(c,d)}function ReportMe(l,k,h,e,j,c){var d=true;if(j){d=confirm("Are you sure your want to report this item")}if(d){var f="rpt_";var g=GetReportLink(f,l.toString(),k.toString(),h.toString());var b=GetReportStatusMsgElm(f,l.toString(),k.toString(),h.toString(),j);var a=$("#"+c).val();if(ShowReportingMessage(g,b)){$(b).load(e+"&comments="+escape(a))}}return false}function GetReportLink(b,c,a,d){return $("a[name="+b+c+"_"+a+"_"+d+"]")}function GetReportStatusMsgElm(f,b,c,d,e){var a=document.getElementsByName(f+b+"_"+c+"_"+d)[0];return e?a.parentNode:a.parentNode.parentNode.parentNode}function ShowReportingMessage(a,b){if(!a||!b){return false}$(a).css("display","none");$(b).html('<img src="/images/animated_loading_blue.gif" width="16px" height="16px" border="0">');$(b).css("display","");return true}function CheckForUndo(b,a){if($(b).prop("checkForUndo")){return}var c=$(b).find(".Undo");$(b).prop("checkForUndo",true)}function bookmarkMe(j,h,c,f,b,g){var e="bm_";var a=b||GetBmkLink(e,j.toString(),h.toString());var d=g||GetBmkStatusMsg(e,j.toString(),h.toString());if(LoadWaitMessage(a,d,f)){$(d).load(c)}return false}function watchMe(j,h,c,f,b,g){var e="bmw_";var a=b||GetBmkLink(e,j.toString(),h.toString());var d=g||GetBmkStatusMsg(e,j.toString(),h.toString());if(LoadWaitMessage(a,d,f)){$(d).load(c)}return false}function GetBmkLink(b,c,a){return $("a[name="+b+c+"_"+a+"]")}function GetBmkStatusMsg(b,c,a){return document.getElementsByName(b+c+"_"+a)[0]}function LoadWaitMessage(a,b,c){if(!a||!b){return false}$(a).css("display","none");if(c){$(b).html('<img src="/images/loading.gif" width="24px" height="24px" border="0" class="align-top">')}else{$(b).html('<img src="/images/animated_loading_blue.gif" width="16px" height="16px" border="0">')}$(b).css("display","");return true}(function(b){function a(){var e,c,d;e="";for(d=0;d<32;d++){if(d==8||d==12||d==16||d==20){e=e+"-"}c=Math.floor(Math.random()*16).toString(16).toUpperCase();e=e+c}return e}jQuery.fn.AdSigniaAd=function(d){var c=a();this.each(function(j){var f=this;var k={};k.channel=b(this).attr("lqm_channel");k.publisher=b(this).attr("lqm_publisher");k.zone=b(this).attr("lqm_zone");k.format=b(this).attr("lqm_format");var h=b(this).attr("lqm_country");if(h!=undefined){k.country=h}var e=b(this).attr("lqm_tags");if(e!=undefined){k.tags=e}k.ypos=b(this).offset().top;k.pageid=c;k.ct=j+1;k.renderhtml=true;k.target="_blank";var g=d+"?&"+b.param(k);b(this).attr("src",g)})}})(jQuery);function scrollToAnchor(d,a){a=jQuery.extend({speed:1100},a);var b;var c=d.indexOf("#");if(c>0){b=d.substring(c)}else{b=d}var f=$(b);if(f.length>0){var e=f.offset().top;$("html:not(:animated),body:not(:animated)").animate({scrollTop:e},a.speed,function(){window.location.hash=d})}return false}function anchorAnimate(a){$("a.anchorLink").each(function(){var b=this;$(b).click(function(e){e.preventDefault();var f=window.location.href;var d=$(b).attr("href");var c;var g=d.indexOf("#");if(g>0){c=d.substring(g)}else{c=d}return scrollToAnchor(c,a)})})}(function(a){a.fn.hoverIntent=function(n,o){var m={sensitivity:7,interval:100,timeout:0};m=a.extend(m,o?{over:n,out:o}:n);var k,l,h,j;var b=function(f){k=f.pageX;l=f.pageY};var e=function(f,g){g.hoverIntent_t=clearTimeout(g.hoverIntent_t);if((Math.abs(h-k)+Math.abs(j-l))<m.sensitivity){a(g).unbind("mousemove",b);g.hoverIntent_s=1;return m.over.apply(g,[f])}else{h=k;j=l;g.hoverIntent_t=setTimeout(function(){e(f,g)},m.interval)}};var c=function(f,g){g.hoverIntent_t=clearTimeout(g.hoverIntent_t);g.hoverIntent_s=0;return m.out.apply(g,[f])};var d=function(p){var g=jQuery.extend({},p);var f=this;if(f.hoverIntent_t){f.hoverIntent_t=clearTimeout(f.hoverIntent_t)}if(p.type=="mouseenter"){h=g.pageX;j=g.pageY;a(f).bind("mousemove",b);if(f.hoverIntent_s!=1){f.hoverIntent_t=setTimeout(function(){e(g,f)},m.interval)}}else{a(f).unbind("mousemove",b);if(f.hoverIntent_s==1){f.hoverIntent_t=setTimeout(function(){c(g,f)},m.timeout)}}};return this.bind("mouseenter",d).bind("mouseleave",d)}})(jQuery);(function(){function B(a){console.log("$f.fireEvent",[].slice.call(a))}function r(a){if(!a||typeof a!="object"){return a}var b=new a.constructor();for(var c in a){if(a.hasOwnProperty(c)){b[c]=r(a[c])}}return b}function t(f,c){if(!f){return}var a,b=0,d=f.length;if(d===undefined){for(a in f){if(c.call(f[a],a,f[a])===false){break}}}else{for(var e=f[0];b<d&&c.call(e,b,e)!==false;e=f[++b]){}}return f}function x(a){return document.getElementById(a)}function p(a,c,b){if(typeof c!="object"){return a}if(a&&c){t(c,function(d,e){if(!b||typeof e!="function"){a[d]=e}})}return a}function u(c){var a=c.indexOf(".");if(a!=-1){var e=c.slice(0,a)||"*";var d=c.slice(a+1,c.length);var b=[];t(document.getElementsByTagName(e),function(){if(this.className&&this.className.indexOf(d)!=-1){b.push(this)}});return b}}function A(a){a=a||window.event;if(a.preventDefault){a.stopPropagation();a.preventDefault()}else{a.returnValue=false;a.cancelBubble=true}return false}function q(a,b,c){a[b]=a[b]||[];a[b].push(c)}function z(){return"_"+(""+Math.random()).slice(2,10)}var o=function(f,d,e){var c=this,b={},g={};c.index=d;if(typeof f=="string"){f={url:f}}p(this,f,true);t(("Begin*,Start,Pause*,Resume*,Seek*,Stop*,Finish*,LastSecond,Update,BufferFull,BufferEmpty,BufferStop").split(","),function(){var h="on"+this;if(h.indexOf("*")!=-1){h=h.slice(0,h.length-1);var j="onBefore"+h.slice(2);c[j]=function(k){q(g,j,k);return c}}c[h]=function(k){q(g,h,k);return c};if(d==-1){if(c[j]){e[j]=c[j]}if(c[h]){e[h]=c[h]}}});p(this,{onCuepoint:function(j,k){if(arguments.length==1){b.embedded=[null,j];return c}if(typeof j=="number"){j=[j]}var h=z();b[h]=[j,k];if(e.isLoaded()){e._api().fp_addCuepoints(j,d,h)}return c},update:function(k){p(c,k);if(e.isLoaded()){e._api().fp_updateClip(k,d)}var j=e.getConfig();var h=(d==-1)?j.clip:j.playlist[d];p(h,k,true)},_fireEvent:function(m,j,n,l){if(m=="onLoad"){t(b,function(E,D){if(D[0]){e._api().fp_addCuepoints(D[0],d,E)}});return false}l=l||c;if(m=="onCuepoint"){var k=b[j];if(k){return k[1].call(e,l,n)}}if(j&&"onBeforeBegin,onMetaData,onStart,onUpdate,onResume".indexOf(m)!=-1){p(l,j);if(j.metaData){if(!l.duration){l.duration=j.metaData.duration}else{l.fullDuration=j.metaData.duration}}}var h=true;t(g[m],function(){h=this.call(e,l,j,n)});return h}});if(f.onCuepoint){var a=f.onCuepoint;c.onCuepoint.apply(c,typeof a=="function"?[a]:a);delete f.onCuepoint}t(f,function(h,j){if(typeof j=="function"){q(g,h,j);delete f[h]}});if(d==-1){e.onCuepoint=this.onCuepoint}};var s=function(b,d,c,f){var a=this,e={},g=false;if(f){p(e,f)}t(d,function(h,j){if(typeof j=="function"){e[h]=j;delete d[h]}});p(this,{animate:function(m,h,l){if(!m){return a}if(typeof h=="function"){l=h;h=500}if(typeof m=="string"){var k=m;m={};m[k]=h;h=500}if(l){var j=z();e[j]=l}if(h===undefined){h=500}d=c._api().fp_animate(b,m,h,j);return a},css:function(k,j){if(j!==undefined){var h={};h[k]=j;k=h}d=c._api().fp_css(b,k);p(a,d);return a},show:function(){this.display="block";c._api().fp_showPlugin(b);return a},hide:function(){this.display="none";c._api().fp_hidePlugin(b);return a},toggle:function(){this.display=c._api().fp_togglePlugin(b);return a},fadeTo:function(l,k,j){if(typeof k=="function"){j=k;k=500}if(j){var h=z();e[h]=j}this.display=c._api().fp_fadeTo(b,l,k,h);this.opacity=l;return a},fadeIn:function(j,h){return a.fadeTo(1,j,h)},fadeOut:function(j,h){return a.fadeTo(0,j,h)},getName:function(){return b},getPlayer:function(){return c},_fireEvent:function(n,m,h){if(n=="onUpdate"){var k=c._api().fp_getPlugin(b);if(!k){return}p(a,k);delete a.methods;if(!g){t(k.methods,function(){var C=""+this;a[C]=function(){var E=[].slice.call(arguments);var F=c._api().fp_invoke(b,C,E);return F==="undefined"||F===undefined?a:F}});g=true}}var l=e[n];if(l){var j=l.apply(a,m);if(n.slice(0,1)=="_"){delete e[n]}return j}return a}})};function w(f,a,j){var m=this,l=null,K=false,k,h,M=[],c={},b={},L,g,e,J,n,H;p(m,{id:function(){return L},isLoaded:function(){return(l!==null&&l.fp_play!==undefined&&!K)},getParent:function(){return f},hide:function(C){if(C){f.style.height="0px"}if(m.isLoaded()){l.style.height="0px"}return m},show:function(){f.style.height=H+"px";if(m.isLoaded()){l.style.height=n+"px"}return m},isHidden:function(){return m.isLoaded()&&parseInt(l.style.height,10)===0},load:function(E){if(!m.isLoaded()&&m._fireEvent("onBeforeLoad")!==false){var C=function(){if(k&&!flashembed.isSupported(a.version)){f.innerHTML=""}if(E){E.cached=true;q(b,"onLoad",E)}flashembed(f,a,{config:j})};var D=0;t(v,function(){this.unload(function(F){if(++D==v.length){C()}})})}return m},unload:function(E){if(k.replace(/\s/g,"")!==""){if(m._fireEvent("onBeforeUnload")===false){if(E){E(false)}return m}K=true;try{if(l){l.fp_close();m._fireEvent("onUnload")}}catch(C){}var D=function(){l=null;f.innerHTML=k;K=false;if(E){E(true)}};if(/WebKit/i.test(navigator.userAgent)&&!/Chrome/i.test(navigator.userAgent)){setTimeout(D,0)}else{D()}}else{if(E){E(false)}}return m},getClip:function(C){if(C===undefined){C=J}return M[C]},getCommonClip:function(){return h},getPlaylist:function(){return M},getPlugin:function(C){var E=c[C];if(!E&&m.isLoaded()){var D=m._api().fp_getPlugin(C);if(D){E=new s(C,D,m);c[C]=E}}return E},getScreen:function(){return m.getPlugin("screen")},getControls:function(){return m.getPlugin("controls")._fireEvent("onUpdate")},getLogo:function(){try{return m.getPlugin("logo")._fireEvent("onUpdate")}catch(C){}},getPlay:function(){return m.getPlugin("play")._fireEvent("onUpdate")},getConfig:function(C){return C?r(j):j},getFlashParams:function(){return a},loadPlugin:function(F,E,O,G){if(typeof O=="function"){G=O;O={}}var D=G?z():"_";m._api().fp_loadPlugin(F,E,O,D);var C={};C[D]=G;var P=new s(F,null,m,C);c[F]=P;return P},getState:function(){return m.isLoaded()?l.fp_getState():-1},play:function(D,C){var E=function(){if(D!==undefined){m._api().fp_play(D,C)}else{m._api().fp_play()}};if(m.isLoaded()){E()}else{if(K){setTimeout(function(){m.play(D,C)},50)}else{m.load(function(){E()})}}return m},getVersion:function(){var D="flowplayer.js 3.2.8";if(m.isLoaded()){var C=l.fp_getVersion();C.push(D);return C}return D},_api:function(){if(!m.isLoaded()){throw"Flowplayer "+m.id()+" not loaded when calling an API method"}return l},setClip:function(C){t(C,function(E,D){if(typeof D=="function"){q(b,E,D);delete C[E]}else{if(E=="onCuepoint"){$f(f).getCommonClip().onCuepoint(C[E][0],C[E][1])}}});m.setPlaylist([C]);return m},getIndex:function(){return e},bufferAnimate:function(C){l.fp_bufferAnimate(C===undefined||C);return m},_swfHeight:function(){return l.clientHeight}});t(("Click*,Load*,Unload*,Keypress*,Volume*,Mute*,Unmute*,PlaylistReplace,ClipAdd,Fullscreen*,FullscreenExit,Error,MouseOver,MouseOut").split(","),function(){var C="on"+this;if(C.indexOf("*")!=-1){C=C.slice(0,C.length-1);var D="onBefore"+C.slice(2);m[D]=function(E){q(b,D,E);return m}}m[C]=function(E){q(b,C,E);return m}});t(("pause,resume,mute,unmute,stop,toggle,seek,getStatus,getVolume,setVolume,getTime,isPaused,isPlaying,startBuffering,stopBuffering,isFullscreen,toggleFullscreen,reset,close,setPlaylist,addClip,playFeed,setKeyboardShortcutsEnabled,isKeyboardShortcutsEnabled").split(","),function(){var C=this;m[C]=function(E,D){if(!m.isLoaded()){return m}var F=null;if(E!==undefined&&D!==undefined){F=l["fp_"+C](E,D)}else{F=(E===undefined)?l["fp_"+C]():l["fp_"+C](E)}return F==="undefined"||F===undefined?m:F}});m._fireEvent=function(W){if(typeof W=="string"){W=[W]}var X=W[0],U=W[1],S=W[2],G=W[3],F=0;if(j.debug){B(W)}if(!m.isLoaded()&&X=="onLoad"&&U=="player"){l=l||x(g);n=m._swfHeight();t(M,function(){this._fireEvent("onLoad")});t(c,function(O,N){N._fireEvent("onUpdate")});h._fireEvent("onLoad")}if(X=="onLoad"&&U!="player"){return}if(X=="onError"){if(typeof U=="string"||(typeof U=="number"&&typeof S=="number")){U=S;S=G}}if(X=="onContextMenu"){t(j.contextMenu[U],function(O,N){N.call(m)});return}if(X=="onPluginEvent"||X=="onBeforePluginEvent"){var C=U.name||U;var D=c[C];if(D){D._fireEvent("onUpdate",U);return D._fireEvent(S,W.slice(3))}return}if(X=="onPlaylistReplace"){M=[];var T=0;t(U,function(){M.push(new o(this,T++,m))})}if(X=="onClipAdd"){if(U.isInStream){return}U=new o(U,S,m);M.splice(S,0,U);for(F=S+1;F<M.length;F++){M[F].index++}}var V=true;if(typeof U=="number"&&U<M.length){J=U;var E=M[U];if(E){V=E._fireEvent(X,S,G)}if(!E||V!==false){V=h._fireEvent(X,S,G,E)}}t(b[X],function(){V=this.call(m,U,S);if(this.cached){b[X].splice(F,1)}if(V===false){return false}F++});return V};function I(){if($f(f)){$f(f).getParent().innerHTML="";e=$f(f).getIndex();v[e]=m}else{v.push(m);e=v.length-1}H=parseInt(f.style.height,10)||f.clientHeight;L=f.id||"fp"+z();g=a.id||L+"_api";a.id=g;k=f.innerHTML;if(typeof j=="string"){j={clip:{url:j}}}j.playerId=L;j.clip=j.clip||{};if(f.getAttribute("href",2)&&!j.clip.url){j.clip.url=f.getAttribute("href",2)}h=new o(j.clip,-1,m);j.playlist=j.playlist||[j.clip];var D=0;t(j.playlist,function(){var G=this;if(typeof G=="object"&&G.length){G={url:""+G}}t(j.clip,function(O,P){if(P!==undefined&&G[O]===undefined&&typeof P!="function"){G[O]=P}});j.playlist[D]=G;G=new o(G,D,m);M.push(G);D++});t(j,function(N,G){if(typeof G=="function"){if(h[N]){h[N](G)}else{q(b,N,G)}delete j[N]}});t(j.plugins,function(N,G){if(G){c[N]=new s(N,G,m)}});if(!j.plugins||j.plugins.controls===undefined){c.controls=new s("controls",null,m)}c.canvas=new s("canvas",null,m);k=f.innerHTML;function F(G){if(/iPad|iPhone|iPod/i.test(navigator.userAgent)&&!/.flv$/i.test(M[0].url)&&!E()){return true}if(!m.isLoaded()&&m._fireEvent("onBeforeClick")!==false){m.load()}return A(G)}function E(){return m.hasiPadSupport&&m.hasiPadSupport()}function C(){if(k.replace(/\s/g,"")!==""){if(f.addEventListener){f.addEventListener("click",F,false)}else{if(f.attachEvent){f.attachEvent("onclick",F)}}}else{if(f.addEventListener&&!E()){f.addEventListener("click",A,false)}m.load()}}setTimeout(C,0)}if(typeof f=="string"){var d=x(f);if(!d){throw"Flowplayer cannot access element: "+f}f=d;I()}else{I()}}var v=[];function y(a){this.length=a.length;this.each=function(c){t(a,c)};this.size=function(){return a.length};var b=this;for(name in w.prototype){b[name]=function(){var c=arguments;b.each(function(){this[name].apply(this,c)})}}}window.flowplayer=window.$f=function(){var b=null;var a=arguments[0];if(!arguments.length){t(v,function(){if(this.isLoaded()){b=this;return false}});return b||v[0]}if(arguments.length==1){if(typeof a=="number"){return v[a]}else{if(a=="*"){return new y(v)}t(v,function(){if(this.id()==a.id||this.id()==a||this.getParent()==a){b=this;return false}});return b}}if(arguments.length>1){var f=arguments[1],c=(arguments.length==3)?arguments[2]:{};if(typeof f=="string"){f={src:f}}f=p({bgcolor:"#000000",version:[9,0],expressInstall:"http://static.flowplayer.org/swf/expressinstall.swf",cachebusting:false},f);if(typeof a=="string"){if(a.indexOf(".")!=-1){var e=[];t(u(a),function(){e.push(new w(this,r(f),r(c)))});return new y(e)}else{var d=x(a);return new w(d!==null?d:r(a),r(f),r(c))}}else{if(a){return new w(a,r(f),r(c))}}}return null};p(window.$f,{fireEvent:function(){var a=[].slice.call(arguments);var b=$f(a[0]);return b?b._fireEvent(a.slice(1)):null},addPlugin:function(a,b){w.prototype[a]=b;return $f},each:t,extend:p});if(typeof jQuery=="function"){jQuery.fn.flowplayer=function(a,c){if(!arguments.length||typeof arguments[0]=="number"){var b=[];this.each(function(){var d=$f(this);if(d){b.push(d)}});return arguments.length?b[arguments[0]]:new y(b)}return this.each(function(){$f(this,r(a),c?r(c):{})})}}})();(function(){var f=document.all,m="http://www.adobe.com/go/getflashplayer",q=typeof jQuery=="function",s=/(\d+)[^\d]+(\d+)[^\d]*(\d*)/,p={width:"100%",height:"100%",id:"_"+(""+Math.random()).slice(9),allowfullscreen:true,allowscriptaccess:"always",quality:"high",version:[3,0],onFail:null,expressInstall:null,w3c:false,cachebusting:false};if(window.attachEvent){window.attachEvent("onbeforeunload",function(){__flash_unloadHandler=function(){};__flash_savedUnloadHandler=function(){}})}function l(c,b){if(b){for(var a in b){if(b.hasOwnProperty(a)){c[a]=b[a]}}}return c}function o(a,d){var c=[];for(var b in a){if(a.hasOwnProperty(b)){c[b]=d(a[b])}}return c}window.flashembed=function(a,c,b){if(typeof a=="string"){a=document.getElementById(a.replace("#",""))}if(!a){return}if(typeof c=="string"){c={src:c}}return new r(a,l(l({},p),c),b)};var t=l(window.flashembed,{conf:p,getVersion:function(){var d,a;try{a=navigator.plugins["Shockwave Flash"].description.slice(16)}catch(b){try{d=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");a=d&&d.GetVariable("$version")}catch(e){try{d=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");a=d&&d.GetVariable("$version")}catch(c){}}}a=s.exec(a);return a?[a[1],a[3]]:[0,0]},asString:function(b){if(b===null||b===undefined){return null}var a=typeof b;if(a=="object"&&b.push){a="array"}switch(a){case"string":b=b.replace(new RegExp('(["\\\\])',"g"),"\\$1");b=b.replace(/^\s?(\d+\.?\d*)%/,"$1pct");b=b.replace(/(%)/g,"%25").replace(/'/g,"\\u0027").replace(/"/g,"\\u0022").replace(/&/g,"%26");return'"'+b+'"';case"array":return"["+o(b,function(e){return t.asString(e)}).join(",")+"]";case"function":return'"function()"';case"object":var c=[];for(var d in b){if(b.hasOwnProperty(d)){c.push('"'+d+'":'+t.asString(b[d]))}}return"{"+c.join(",")+"}"}return String(b).replace(/\s/g," ").replace(/\'/g,'"')},getHTML:function(d,a){d=l({},d);var c='<object width="'+d.width+'" height="'+d.height+'" id="'+d.id+'" name="'+d.id+'"';if(d.cachebusting){d.src+=((d.src.indexOf("?")!=-1?"&":"?")+Math.random())}if(d.w3c||!f){c+=' data="'+d.src+'" type="application/x-shockwave-flash"'}else{c+=' classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'}c+=">";if(d.w3c||f){c+='<param name="movie" value="'+d.src+'" />'}d.width=d.height=d.id=d.w3c=d.src=null;d.onFail=d.version=d.expressInstall=null;for(var b in d){if(d[b]){c+='<param name="'+b+'" value="'+d[b]+'" />'}}var e="";if(a){for(var h in a){if(a[h]){var g=a[h];e+=h+"="+(/function|object/.test(typeof g)?t.asString(g):g)+"&"}}e=e.slice(0,-1);c+='<param name="flashvars" value=\''+e+"' />"}c+="</object>";return c},isSupported:function(a){return n[0]>a[0]||n[0]==a[0]&&n[1]>=a[1]}});var n=t.getVersion();function r(a,d,c){if(t.isSupported(d.version)){a.innerHTML=t.getHTML(d,c)}else{if(d.expressInstall&&t.isSupported([6,65])){a.innerHTML=t.getHTML(l(d,{src:d.expressInstall}),{MMredirectURL:encodeURIComponent(location.href),MMplayerType:"PlugIn",MMdoctitle:document.title})}else{if(!a.innerHTML.replace(/\s/g,"")){a.innerHTML="<h2>Flash version "+d.version+" or greater is required</h2><h3>"+(n[0]>0?"Your version is "+n:"You have no flash plugin installed")+"</h3>"+(a.tagName=="A"?"<p>Click here to download latest version</p>":"<p>Download latest version from <a href='"+m+"'>here</a></p>");if(a.tagName=="A"){a.onclick=function(){location.href=m}}}if(d.onFail){var b=d.onFail.call(this);if(typeof b=="string"){a.innerHTML=b}}}}if(f){window[d.id]=document.getElementById(d.id)}l(this,{getRoot:function(){return a},getOptions:function(){return d},getConf:function(){return c},getApi:function(){return a.firstChild}})}if(q){jQuery.tools=jQuery.tools||{version:"3.2.8"};jQuery.tools.flashembed={conf:p};jQuery.fn.flashembed=function(a,b){return this.each(function(){$(this).data("flashembed",flashembed(this,a,b))})}}})();$(document).ready(function(){$("div.code-samples").each(function(d){var e=$(this);var g=e.children("pre");if(g.length>1){var c="divTab"+d.toString();var b="codesampletab"+d.toString();var f=$("<div id='"+b+"' class='clearfix'></div>").insertAfter(e);$("<ul id='codetab"+d+"'></ul>").appendTo(f);var a="";g.each(function(){var j=$(this);var h=c+j.attr("lang").replace(".","");$("<li><a href='#"+h+"'><span>"+ConvertCodeLanguage(j.attr("lang"))+"</span></a></li>").appendTo("#codetab"+d);a+="<div id='"+h+"'><a name='"+h+"'></a><pre>"+j.html()+"</pre></div>"});$(a).insertAfter("#codetab"+d);e.hide();f.tabs()}});InitToggleCollapseExpandPre()});var pOpen=new Image();var pClose=new Image();var PreCopy=new Image();pOpen.src="/images/plus.gif";pClose.src="/images/minus.gif";PreCopy.src="/images/copy_16.png";function togglePre(){var a=this.getAttribute("preid");var d=$("#pre"+a)[0];var b=$("#preimg"+a)[0];var c=$("#precollapse"+a)[0];if(d.style.display!="none"){if(document.all){c.innerText=" Expand"}else{c.firstChild.nodeValue=" Expand"}d.style.display="none";b.setAttribute("src",pOpen.src)}else{if(document.all){c.innerText=" Collapse"}else{c.firstChild.nodeValue=" Collapse"}d.style.display="block";b.setAttribute("src",pClose.src)}}function CopyCode(e){var b=this.getAttribute("preid");if(b<0){return false}var d=$("#pre"+b.toString())[0];if(!d){return false}var a=d.innerHTML;if(!a){return false}a=prepareCopyText(a);if(!a){return false}var c=window.open("","_blank","width=500,height=300,scrollbars=yes");c.document.writeln("<html><body><pre>"+a+"</pre></body></html>");return false}function InitToggleCollapseExpandPre(){var a=$("#contentdiv")[0];if(!a){return}var h=a.getElementsByTagName("pre");for(var b=0;b<h.length;b++){if(h[b].decoration&&h[b].decoration.toLowerCase()=="none"){continue}var e=h[b].parentNode;var g=h[b].innerHTML.length;var f=g-h[b].innerHTML.replace(/\n/ig,"").length+(g-h[b].innerHTML.replace(/\<br/ig,"").length)/3;var c=document.createElement("div");c.className="pre-action-link";c.setAttribute("id","premain"+b.toString());c.setAttribute("width","100%");c.setAttribute("style","display:block");var d=document.createElement("img");d.setAttribute("id","preimg"+b.toString());d.setAttribute("src",pClose.src);d.style.cursor="pointer";d.setAttribute("height",9);d.setAttribute("width",9);d.setAttribute("preid",b);d.onclick=togglePre;c.appendChild(d);d=document.createElement("span");d.setAttribute("id","precollapse"+b.toString());d.style.cursor="pointer";d.style.marginBottom=0;d.onclick=togglePre;d.setAttribute("preid",b);setText(d," Collapse");c.appendChild(d);d=document.createElement("span");setText(d," | ");c.appendChild(d);d=document.createElement("a");setText(d,"Copy Code");d.href="#";d.setAttribute("preid",b);d.onclick=CopyCode;c.appendChild(d);h[b].setAttribute("id","pre"+b.toString());h[b].style.marginTop=0;e=h[b].parentNode;e.insertBefore(c,h[b])}}function prepareCopyText(a){if(!a){return null}if(!$.support.opacity){return a}var b=$("<div/>").html(a).text().trim();b=b.replace(/\</gi,"&lt;");b=b.replace(/\r\n\r\n\r\n\r\n/,"\r\n\r\n");return b}function setText(a,b){if(typeof a.innerText!="undefined"){a.innerText=b}else{a.textContent=b}}function ConvertCodeLanguage(a){switch(a.toLowerCase()){case"text":return"Plain Text";break;case"aspnet":return"ASP.NET";break;case"cs":return"C#";break;case"c++":return"C++";break;case"vb.net":return"VB.NET";break;case"mc++":return"C++ / CLI";break;case"css":return"CSS";break;case"delphi":return"Delphi";break;case"F#":return"F#";break;case"html":return"HTML";break;case"java":return"Java";break;case"jscript":return"Javascript";break;case"asm":return"MASM / ASM";break;case"msil":return"MSIL";break;case"midl":return"MIDL";break;case"php":return"PHP";break;case"sql":return"SQL";break;case"vbscript":return"VBScript";break;case"xml":return"XML";break}return a}var switchCallback=null;var minMessageScore=1;var maxMessageScore=5;var forumDir="/script/Forums/";var staticServer="http://s.codeproject.com";var allowReporting=true;var allowRating=true;var abuseScore=-2;var spamScore=-1;var keyMapping=[];keyMapping["13"]="ENTER";keyMapping["37"]="LEFT";keyMapping["38"]="UP";keyMapping["39"]="RIGHT";keyMapping["40"]="DOWN";keyMapping["16"]="SHIFT";keyMapping["17"]="CTRL";keyMapping["33"]="PGUP";keyMapping["34"]="PGDOWN";var commandMapping={Combinations:{"CTRL+ENTER":function(){Submit()},"CTRL+LEFT":function(){MoveToPost(false,false)},"CTRL+RIGHT":function(){MoveToPost(true,false)},"CTRL+UP":function(){MoveToPost(false,true)},"CTRL+DOWN":function(){MoveToPost(true,true)},"CTRL+PGUP":function(){MoveToPage(true)},"CTRL+PGDOWN":function(){MoveToPage(false)},"CTRL+SHIFT+LEFT":function(){MoveToPage(true)},"CTRL+SHIFT+RIGHT":function(){MoveToPage(false)}}};document.onkeydown=function(a){return shortcutEventHandler(a,commandMapping,keyMapping)};function getControlKeys(a){var b="";if(a.ctrlKey){b+="CTRL+"}if(a.shiftKey){b+="SHIFT+"}if(a.altKey){b+="ALT+"}return b}function shortcutEventHandler(e,f,c){if(!e){e=event}var d=(e.keyCode)?e.keyCode:e.charCode;var b="";if(c[d]){b=c[d]}var a=getControlKeys(e);b=a+b;if(f.Combinations[b]){f.Combinations[b]();if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}if(e.stopPropagation){e.stopPropagation()}else{e.cancelBubble=true}return false}return true}function Submit(){var a=document.forms.aspnetForm;if(!a){a=document.aspnetForm}if(a){a.submit()}}function MoveToPage(b){var a=document.getElementById(b?"_mbpUrl":"_mbnUrl");if(a){location.href=a.value}}function MoveToPost(e,l){if(Selected==""||isNaN(Selected)){return}var c=document.getElementById("ForumTable");if(!c){return}var j=getElementsByClass("header",c,"tr");if(!j){return}var a=null;var h=parseInt(Selected);var b,g=-1;var d=0;for(b=0;b<j.length;++b){var f=j[b].id.substring(1,j[b].id.length-3);f=parseInt(f);if(IsThreadHead(j[b])){d=b}if(f==h){g=b;break}}var k=null;for(b=g+(e?1:-1);b<j.length&&b>=0;e?++b:--b){if((l&&IsThreadHead(j[b]))||!l){k=j[b].id.substring(1,j[b].id.length-3);k=parseInt(k);break}}if(k&&k!=parseInt(Selected)){SwitchMessage(null,k)}}function IsThreadHead(a){return a.className.indexOf("root")>=0}function getElementsByClass(a,f,b){var g=new Array();if(f==null){f=document}if(b==null){b="*"}var k=f.getElementsByTagName(b);var h=k.length;var c=new RegExp("(^|\\s)"+a+"(\\s|$)");for(var d=0,e=0;d<h;d++){if(c.test(k[d].className)){g[e]=k[d];e++}}return g}function getVoteFormHtml(f,e,h,d,c,g){var a="";if(allowRating){if(!h){a+="Rate this message: "}a+='<a href="#xx'+e.toString()+'xx" onclick="RateMsg('+f.toString()+", "+e.toString()+","+(h?"5":"1")+',0);">';if(h){a+='<img height="20px" width="20px" src="'+forumDir+'Images/good.png" alt="good" border="0" align="absmiddle" /> '+d+" "+g+"</a> "}else{a+='<img height="14px" width="14px" src="'+staticServer+forumDir+'Images/thumbs_down.gif" alt="vote 1" border="0" align="middle" /></a> '}if(h){a+=" &nbsp;"}else{for(var b=1;b<=5;b++){a+='<a class="toolbar nav-link" href="#xx"'+e.toString()+'xx" title="vote this message a '+b.toString()+'" onclick="RateMsg('+f.toString()+","+e.toString()+","+b.toString()+',0);"><b>'+b.toString()+"</b></a> "}}a+='<a href="#xx'+e.toString()+'xx" onclick="RateMsg('+f.toString()+","+e.toString()+","+(h?"1":"5")+',0);">';if(h){a+='<img height="20px" width="20px" src="'+forumDir+'Images/bad.png" alt="bad" border="0" align="absmiddle" /> '+c+" "+g+"</a>"}else{a+='<img height="14px" width="14px" src="'+staticServer+forumDir+'Images/thumbs_up.gif" border="0" alt="vote 5" align="middle" /></a> '}}if(allowReporting){if(allowRating){a+=(h?" &nbsp;&nbsp; ":"<br />")}a+='<span class="tooltip float-right" style="padding-right:55px"><img height="16px" width="16px" src="'+staticServer+'/images/flag16.png" border="0" alt="report" style="vertical-align:text-top" /> Report<div class="tooltip-flyout" style="width:80px !important;line-height:17px"><div class="list-item"><a href="#xx'+e.toString()+'xx" title="Report as Abuse" onclick="return ReportMsg('+f.toString()+","+e.toString()+","+abuseScore.toString()+');">Abusive</a></div><div class="list-item"><a href="#xx'+e.toString()+'xx" title="Report as Spam" onclick="return ReportMsg('+f.toString()+","+e.toString()+","+spamScore.toString()+');">Spam</a></div></div></span>'}return a}function SetupVoteForm(){if(!allowRating&&!allowReporting){return}var d=document.getElementById("ForumTable");var f=getElementsByClass("voteform",d,"span");if(!f){return}for(i=0;i<f.length;++i){if(f[i].getAttribute("done")){continue}var a=f[i].getAttribute("ownerid");var h=f[i].getAttribute("msgid");var e=f[i].getAttribute("goodbad")=="true";var c=f[i].getAttribute("gpre");var b=f[i].getAttribute("bpre");var g=f[i].getAttribute("msgtype");f[i].innerHTML=getVoteFormHtml(a,h,e,c,b,g);f[i].setAttribute("done","true")}}function ReportMsg(a,c,b){if(confirm("Are you sure you want this message removed?")){return RateMsg(a,c,b,0)}return false}function RateMsg(e,c,b,a){var d=window.XMLHttpRequest?new XMLHttpRequest():new ActiveXObject("MSXML2.XMLHTTP");if(!d){return}d.onreadystatechange=function(){if(d.readyState==4){if(d.status==200){var h=d.responseText;var j=new RegExp("<div>(.*)</div>","g");var k=j.exec(h);f.innerHTML="<b>"+((k&&k.length>1&&k[1])?k[1]:"An error occurred</b>")}else{f.innerHTML='<b style="color:red">Failed!'+d.statusText+"</b>"}}};var f=document.getElementById("MVF"+c);if(!f){return}f.innerHTML='<b style="color:green">Voting...</b>';var g=forumDir+"Vote.aspx?js=1&fmid="+e.toString()+"&select="+c.toString()+"&score="+b.toString()+"&qid="+a.toString();d.open("GET",g,true);d.send(null);return false}function Pin(c){CloseMsg(Selected);Selected="";var a=c.parentNode;if(a){a=a.firstChild}while(a&&a.className!="message-link"){a=a.nextSibling}var b=c?c.firstChild:null;if(a&&!a.pinned){OpenMsg(a.name,true);a.pinned=true;switchImage(b,staticServer+forumDir+"images/pinned.png","Pinned. Click to unpin")}else{a.pinned=false;CloseMsg(a.name);switchImage(b,staticServer+forumDir+"images/pin.png","Click to pin message")}return false}function switchImage(b,a,c){b.src=a;b.title=c}function CloseMsg(a){if(!a||a==""||a<0){return}var b=document.getElementsByName(a);if(b&&b.length>0&&b[0].pinned){return}var d=document.getElementById("F"+a.toString()+"_h0");if(d){d.className=d.className.replace("selected","")}var c=document.getElementById("F"+a.toString()+"_h1");if(c){c.style.display="none"}}function OpenMsg(f,d){if(!f||f==""||f<0){return}var a=document.getElementById("F"+f.toString()+"_h1");if(a){var b=document.getElementsByName(f);if(b&&b.length>0&&b[0].pinned){d=true}if(d&&a.style.display!="none"){return}if(a.style.display=="none"){a.style.display=""}else{a.style.display="none"}}var e=document.getElementById("F"+f.toString()+"_h0");if(e){e.className+=" selected"}if(a&&e&&a.style.display!="none"){var c=document.documentElement.scrollTop<document.body.scrollTop;if(!c){document.body.scrollTop=getRealPos(e,"Top")-document.body.clientHeight/10}EnsureMessageVisible(f,true)}}function EnsureMessageVisible(h,e){var c=document.documentElement.scrollTop<document.body.scrollTop;var a=document.getElementById("F"+h+"_h0");var b=document.getElementById("F"+h+"_h1");if(!b||!a){return}var d=document.documentElement;var g=getRealPos(a,"Top");var j=getRealPos(b,"Top")+b.offsetHeight;var f=c?f=document.body.scrollTop:document.documentElement.scrollTop;if(f>g&&!e){f=g-d.clientHeight/10}if(f+d.clientHeight<j){f=j-d.clientHeight}if(f>g&&e){f=g-d.clientHeight/10}if(smoothScroll){if(c){$(document.body).stop().animate({scrollTop:f},"fast")}else{$(d).stop().animate({scrollTop:f},"fast")}}else{if(c){document.body.scrollTop=f}else{d.scrollTop=f}}}function getRealPos(b,a){iPos=0;while(b!=null){iPos+=b["offset"+a];b=b.offsetParent}return iPos}function SwitchMessage(c,a){if(a){a=a.toString()}else{if(!c){c=window.event}var b=c.target?c.target:c.srcElement;if(b&&b.className=="subject hover-container"){if(b.childNodes&&b.childNodes.length>2){b=b.childNodes[2]}}else{while(b&&b.className!="message-link"){b=b.parentNode}}if(!b||b.className!="message-link"){return}if(b.pinned){return false}a=b.name}CloseMsg(Selected);if(Selected==a){Selected=""}else{OpenMsg(a,false);Selected=a}if(c){if(c.preventDefault){c.preventDefault}else{c.returnValue=false}}if(switchCallback){switchCallback(null,a)}return false}function CheckAdminClick(a){return window.confirm("Are you sure you want to "+a+"?")}function SelfCheck(){return window.confirm("You are about to reply to your own message. Is this really what you want?")}function FireNew(a){window.location=$(a).find("a")[0].href}$(document).ready(function(){SetupVoteForm()});var forumNav=function(){var m={x:16,y:16};var f={x:4,y:2};var k=null;var c=null;var r=0;var n=1;var p=5;var b=50;var l="200,200,200";var j=0.2;var w=false;var a=false;var e=false;var d=(navigator.userAgent.indexOf("Chrome/")>=0);function g(){if(!w){$(document.body).append('<canvas id="cv1" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><canvas id="cv2" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas>')}w=true;if(!this.canvasVert){this.canvasVert=$("#cv1")[0]}if(!this.canvasHorz){this.canvasHorz=$("#cv2")[0]}return this.canvasVert&&this.canvasHorz}function h(){if(g()){if(!this.contextVert){this.contextVert=this.canvasVert.getContext("2d")}if(!this.contextHorz){this.contextHorz=this.canvasHorz.getContext("2d")}}return this.contextVert&&this.contextHorz}function o(){if(!this.forum){this.forum=$("#ForumTable .fixed-layout")[0]}return this.forum}function s(){if(!h()){return}contextVert.clearRect(0,0,canvasVert.width,canvasVert.height);contextHorz.clearRect(0,0,canvasHorz.width,canvasHorz.height)}function q(x){a=true;u(x,this.name)}function v(x){a=false;if(n>=p){t(null,null)}}function u(B,D){if(!h()||!o()){return}s();if(D){var A=$('a[name="'+D+'"]')[0];if(k&&k==A){return}k=A}else{if(k&&k==this){return}k=this}c=null;var z=k.attributes.parent.value;if(!z||z=="0"){return}c=$('a[name="'+z+'"]')[0];e=!c;if(e){c=$('a[thread="'+k.attributes.thread.value+'"]:first')[0]}var x=$(k).offset();var C=c?$(c).offset():{left:x.left-f.x-m.x,top:$(forum).offset().top-f.y-m.y};if(!x||!C){return}if(e){C.left=x.left-m.x-2*f.x;C.top-=(m.y+f.y)}var y=$(self.canvasVert).offset();canvasVert.width=Math.min(m.x,x.left-C.left);canvasVert.height=x.top-C.top-m.y/2;canvasVert.style.top=(C.top+m.y+f.y)+"px";canvasVert.style.left=(C.left-m.x-f.x)+"px";canvasHorz.width=Math.max(x.left-C.left-m.x/2-f.x,1);canvasHorz.height=m.y;canvasHorz.style.top=(x.top+f.y)+"px";canvasHorz.style.left=(C.left-m.x-f.x+canvasVert.width/2)+"px";if($.browser.mozilla){canvasVert.style.top=(C.top+m.y+3*f.y)+"px";canvasHorz.style.top=(x.top+3*f.y)+"px"}if(d){n=p;self._interval=null;t()}else{n=1;clearInterval(self._interval);self._interval=setInterval("forumNav.drawConnector()",b)}}function t(){s();if(!k){return}var x=j+((1-j)*n/p);self.contextVert.lineWidth=self.contextHorz.lineWidth=1;self.contextVert.strokeStyle=self.contextHorz.strokeStyle="rgba("+l+","+x+")";self.contextVert.beginPath();self.contextVert.moveTo(canvasVert.width/2,0);self.contextVert.lineTo(canvasVert.width/2,canvasVert.height);self.contextVert.stroke();self.contextHorz.beginPath();self.contextHorz.moveTo(0,canvasHorz.height/2);self.contextHorz.lineTo(canvasHorz.width,canvasHorz.height/2);self.contextHorz.stroke();if(e){self.contextVert.beginPath();self.contextVert.moveTo(m.x/4,m.y/4);self.contextVert.lineTo(m.x/2,0);self.contextVert.lineTo(m.x*3/4,m.y/4);self.contextVert.stroke()}n++;if(n>p){if(!a){s()}if(self._interval){clearInterval(self._interval)}k=null}}return{drawConnector:function(){t()},supportsCanvas:function(){g();return canvasVert&&canvasVert.getContext},initialise:function(){var x=this;$(".message-link").bind("mouseover",q);$(".message-link").bind("mouseout",v);switchCallback=u},resize:function(){this.initialise()}}}();$(document).ready(function(){if(forumNav.supportsCanvas()){forumNav.initialise();$(window).bind("resize",function(){forumNav.resize()})}});function ForumMsgFlag(e){this.updateMessageUrl="";this.flagTypes=new Array();var a=this;var f="FrmMsgFlagMenu";var b=e;var g=function(j,h){return"<a href='javascript:void()' onclick='return "+b+".onClick("+j+","+h+");'>"+a.flagTypes[h].name+"</a>"};var d=function(k){var h=$(k).parent().parent().parent().parent().find(".message-link");if(h.length<1){return}var l=h[0].name;$("#"+f+" div").remove();var m="<div>";for(var j in a.flagTypes){m+='<div class="list-item">'+g(l,j)+"</div>"}m+="</div>";$("#"+f).append(m)};var c=function(){d(this);var l=false;var h=$(this),k=$("#"+f);if(!h||!k){return}var p=$(h).offset();var q=$(h).outerWidth();var j=$(k).outerWidth();var n=$(h).outerHeight();var m=p.left+"px";var o=p.top+"px";$(k).css({left:m,top:o});$(k).stop(true,true).show();$(h).hover(function(){setTimeout(function(){if(!l){$("#"+f).fadeOut("fast")}},200)});$(k).hover(function(){l=true},function(){l=false;$(k).fadeOut("fast")})};this.onClick=function(j,h){$.get(a.updateMessageUrl+"?msgflagId="+h+"&msg="+j,function(m){var k=$("#ForumTable").find('.message-link[name="'+j+'"]').parent().parent();for(var l in a.flagTypes){k.removeClass(a.flagTypes[l].cssClass)}if(a.flagTypes[h].cssClass){k.addClass(a.flagTypes[h].cssClass)}});$("#"+f).fadeOut("fast");return false};this.initialise=function(){$("body").append('<div id="'+f+'" class="invisible tooltip-flyout" style="position:absolute"><div>Hello</div></div>');$(".flag").bind("click",c)}};